<?xml version="1.0" encoding="utf-8"?>
<bpr:release xmlns:bpr="http://www.blueprism.co.uk/product/release">
    <bpr:name>1.2</bpr:name>
    <bpr:release-notes />
    <bpr:created>2023-07-01 12:35:06Z</bpr:created>
    <bpr:package-id>4015</bpr:package-id>
    <bpr:package-name>Ch5 - Example 3 Random Sampling with Shared Folders</bpr:package-name>
    <bpr:user-created-by>admin</bpr:user-created-by>
    <bpr:contents count="8">
        <process id="85805791-f97d-481c-b16b-d9f30123d3a9" name="Example 3 - Random Sampling with Shared Folders" published="true" xmlns="http://www.blueprism.co.uk/product/process"><process name="Example 3 - Random Sampling with Shared Folders" version="1.0" bpversion="7.1.2.3518" narrative="This process uses random sampling to choose which ML predictions to review. It also releases items that have been reviewed so that they can continue processing." byrefcollection="true"><view><camerax>65</camerax><cameray>167</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7" type="Normal" published="False"><name>Start Up</name><view><camerax>51</camerax><cameray>453</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="cf13a1fa-a9be-4527-973b-e2f66f99d14b" type="Normal" published="False"><name>Close Down</name><view><camerax>0</camerax><cameray>59</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="b749d60a-bded-4d36-b099-3627ed699606" type="Normal" published="False"><name>Populate Queue</name><view><camerax>-126</camerax><cameray>228</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="bf57723b-f31f-465f-a44d-6b23e78fd2de" type="Normal" published="False"><name>01 Work Step</name><view><camerax>97</camerax><cameray>25</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="4f5f8a61-abf2-40dd-8169-d8ab45ffd78c" type="Normal" published="False"><name>02 ML Prediction</name><view><camerax>-76</camerax><cameray>345</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="47e58161-0f42-47cc-aa94-af755a8de010" type="Normal" published="False"><name>03 Random Sampling</name><view><camerax>5</camerax><cameray>101</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="5ad2c3a7-152c-4eb5-ac1c-922e32db3271" type="Normal" published="False"><name>04 Work Step</name><view><camerax>97</camerax><cameray>25</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="d31d1c11-61ad-4c49-91a4-44bbf0bf0725" type="Normal" published="False"><name>Mark Item As Completed</name><view><camerax>0</camerax><cameray>2</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="aef794a5-348a-4de6-9810-f7f57b96166b" type="Normal" published="False"><name>Defer Item for Manual Review</name><view><camerax>10</camerax><cameray>346</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="d599353b-a78b-40f4-ab04-255791b86a1a" type="Normal" published="False"><name>Mark Item As Exception</name><view><camerax>-8</camerax><cameray>118</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="5fd952f0-1be2-40e8-8afa-485524c5a5cd" type="Normal" published="False"><name>Reset Global Data</name><view><camerax>0</camerax><cameray>42</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="0f6bea13-07af-439b-9498-383a5ad24099" type="Normal" published="False"><name>Check for Reviewed Predictions</name><view><camerax>-168</camerax><cameray>28</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="f4027e91-43b5-4c69-9723-14dea558d3f0" type="Normal" published="False"><name>Move Temporary Files</name><view><camerax>0</camerax><cameray>97</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="30a66a72-d51e-464f-89e3-f40b54998601" name="Start" type="Start"><display x="15" y="-150" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>832b89eb-e411-459f-ac7a-4584e360f5ef</onsuccess></stage><stage stageid="458762d9-7dd4-47c0-bbdc-55d193273d9c" name="End" type="End"><display x="390" y="-165" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="8b6eaa66-766c-4d2a-a0d1-cc6ab7e4f32d" name="Stage1" type="ProcessInfo"><display x="-180" y="-180" w="270" h="120" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="62aec640-1920-44e6-8b1e-be6a9725cec8" name="Mark Item As Completed" type="SubSheetInfo"><subsheetid>d31d1c11-61ad-4c49-91a4-44bbf0bf0725</subsheetid><narrative>Marks the current work queue item as complete</narrative><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="1446dc69-509c-446c-8f20-b7f580423da2" name="Mark Item As Exception" type="SubSheetInfo"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Marks the current work queue item as an exception</narrative><display x="-120" y="-195" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="bc2ffba4-5cb1-48b6-a390-3b1aadd5dab4" name="Start" type="Start"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="15" y="-120" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>808cbef2-cfe3-460f-ba72-91e0e6283988</onsuccess></stage><stage stageid="b49e249e-bbb1-427e-8bd1-902ce03e3a79" name="Recover" type="Recover"><display x="120" y="525" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>6fa1db8d-0510-4c35-8416-9a938e94c78d</onsuccess></stage><stage stageid="53762061-333e-4023-b99f-1de349dfc4a4" name="Resume" type="Resume"><display x="120" y="675" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>ffb4d158-5875-4239-bd22-b7ca87c93bbc</onsuccess></stage><stage stageid="b9fbad6e-b3b1-4e9b-bc71-1b96d40beeb2" name="Retry Exception?" type="Decision"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="15" y="30" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="Lower([Exception Type])=&quot;system exception&quot; OR Lower([Exception Type])=&quot;internal&quot;" /><ontrue>6b5864ff-c8f2-4c69-8e1b-d090c057cdc2</ontrue><onfalse>5ce83707-f042-4e73-929c-e7358ebdc456</onfalse></stage><stage stageid="a374264f-2dbf-4477-bad7-ee4ba812e5b1" name="Previous Exception?" type="Decision"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="15" y="225" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Previous Exception Detail]=[Exception Detail]" /><ontrue>3484ce27-f1ef-4f28-926b-efaa03fc5fed</ontrue><onfalse>7105b714-612a-4e50-84b3-f789f0634902</onfalse></stage><stage stageid="a08fa84e-da3f-447e-80f1-1db9c2935d76" name="Previous Exception Detail" type="Data"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="-225" y="165" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /></stage><stage stageid="3484ce27-f1ef-4f28-926b-efaa03fc5fed" name="Count" type="Calculation"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="15" y="300" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>02c69925-9f7c-41af-844f-259d82504b0a</onsuccess><calculation expression="1+ [Consecutive Exception Count]" stage="Consecutive Exception Count" /></stage><stage stageid="279f2417-29f4-4931-9039-5d9693cd6b93" name="Consecutive Exception Count" type="Data"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="-225" y="195" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue></stage><stage stageid="02c69925-9f7c-41af-844f-259d82504b0a" name="Limit?" type="Decision"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="15" y="375" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Consecutive Exception Count]&gt;=[Consecutive Exception Limit]" /><ontrue>4dda9efd-3cd9-4714-b293-fe6aa9cd269c</ontrue><onfalse>7360eced-01c7-4dc8-a7ef-817d130f1cc5</onfalse></stage><stage stageid="aefca01e-0501-4f8e-ba6c-a5aa4896e4ea" name="TERMINATE" type="Exception"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="15" y="570" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><exception type="" detail="[Consecutive Exception Limit] &amp; &quot; consecutive incidents of &quot; &amp; [Exception Type] &amp; &quot;: &quot; &amp; [Exception Detail]" /></stage><stage stageid="36455e9b-9b0b-4078-b5b2-338e1aab1f84" name="Consecutive Exception Limit" type="Data"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="-225" y="225" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>3</initialvalue><private /><alwaysinit /></stage><stage stageid="64a4e876-5092-4568-829b-73faed844a31" name="End2" type="End"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="285" y="375" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="9de6523c-e14d-4937-b854-1b0930857c02" name="Reset Consecutive Exception Indicators" type="MultipleCalculation"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="285" y="225" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>64a4e876-5092-4568-829b-73faed844a31</onsuccess><steps><calculation expression="[Exception Detail]" stage="Previous Exception Detail" /><calculation expression="0" stage="Consecutive Exception Count" /></steps></stage><stage stageid="4dda9efd-3cd9-4714-b293-fe6aa9cd269c" name="Stop the process because consecutive exceptions are occuring" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>The consecutive exception limit has been reached, so throw a new exception to terminate the process.</narrative><display x="15" y="480" w="120" h="90" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>aefca01e-0501-4f8e-ba6c-a5aa4896e4ea</onsuccess></stage><stage stageid="6047b42e-0003-4ddb-8ba3-d3607d6ce770" name="Start" type="Start"><subsheetid>d31d1c11-61ad-4c49-91a4-44bbf0bf0725</subsheetid><display x="15" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>126538a7-7404-4369-8cdd-056490ecc46c</onsuccess></stage><stage stageid="86bb4f43-18d4-43dd-9bf5-b8902e21521c" name="Mark Completed" type="Action"><subsheetid>d31d1c11-61ad-4c49-91a4-44bbf0bf0725</subsheetid><narrative>Marks the item as completed, by updating the Completed timestamp and setting Locked to null. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative><display x="15" y="0" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /></inputs><onsuccess>8f6d0bfa-2d98-469e-997c-88b0c126d4d7</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Completed" /></stage><stage stageid="126538a7-7404-4369-8cdd-056490ecc46c" name="Set Status" type="Action"><subsheetid>d31d1c11-61ad-4c49-91a4-44bbf0bf0725</subsheetid><narrative>Updates the status field for the item. The status field can be used to flag what has been done in a process so far. If a process encounters an exception, this information can be used to skip to the parts of the process not yet done for the item next time it is worked. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.

This action will also reset the Attempts column to zero, because if the status updated the process should have successfully done something.</narrative><display x="15" y="-45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Status" narrative="The new status - 255 characters maximum." expr="&quot;Completed&quot;" /></inputs><onsuccess>86bb4f43-18d4-43dd-9bf5-b8902e21521c</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Update Status" /></stage><stage stageid="09fc131c-2803-4daf-b8cf-351f28b78783" name="New Item ID" type="Data"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="-225" y="105" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="10cdebf6-ced7-425b-91dd-2b0b764b5ee0" name="Got Item?" type="Decision"><display x="120" y="60" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Item ID]&lt;&gt;&quot;&quot;" /><ontrue>b2882ef7-4b96-44fe-974c-0c0833e543bc</ontrue><onfalse>7cfa842f-7ad3-4458-943f-6d7007300925</onfalse></stage><stage stageid="6322bec5-84f1-4af9-9af5-5406339262c4" name="01 Work Step" type="SubSheetInfo"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><display x="-105" y="-90" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="f52977fa-5395-47ee-a08b-35f92f89554c" name="01 Work Step" type="SubSheet"><display x="120" y="195" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>ddcca36f-4cf9-489e-abf7-6135db964332</onsuccess><processid>bf57723b-f31f-465f-a44d-6b23e78fd2de</processid></stage><stage stageid="97b3d7cc-18e6-4683-a321-c7c736d2d8b0" name="Start Up" type="SubSheetInfo"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><narrative>Prepares any variables according to the Run Mode, starts the applications and fills the queue.</narrative><display x="-195" y="195" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="58267ed1-deb3-498d-bdf8-42959ffc8bac" name="Close Down" type="SubSheetInfo"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><narrative>Closes down the applications and maintains the work queue.</narrative><display x="-210" y="-240" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="ebd3e811-a42f-4f89-b4da-5a793c6cd798" name="Start" type="Start"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="15" y="-165" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8edd051f-93cd-4a50-b830-432cc195b19c</onsuccess></stage><stage stageid="832b89eb-e411-459f-ac7a-4584e360f5ef" name="Start Up" type="SubSheet"><display x="15" y="-90" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>1db94fff-eca8-49a2-9404-2b6ba6688410</onsuccess><processid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</processid></stage><stage stageid="22b42ab0-feae-42b2-a098-9871956bb826" name="Close Down" type="SubSheet"><display x="390" y="-90" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>458762d9-7dd4-47c0-bbdc-55d193273d9c</onsuccess><processid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</processid></stage><stage stageid="c820952e-9e6d-4733-8604-b1360d80ecde" name="Work" type="Block"><display x="60" y="105" w="120" h="450" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="1ef745eb-5713-4876-9937-47ac6d74b94b" name="anchor8" type="Anchor"><display x="390" y="390" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>1cfde7f1-28bb-4c91-973d-915317f4f54e</onsuccess></stage><stage stageid="ae4ae986-9e90-407c-bdc5-098a2eaf7d1c" name="02 ML Prediction" type="SubSheetInfo"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><narrative>This page is a mock of a Machine Learning prediction</narrative><display x="-195" y="-60" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="e1b17a89-74f4-4c4e-9fc1-dcd90c44c837" name="Start" type="Start"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="15" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>44df47e0-abaa-4bc7-8c74-dece46e8befc</onsuccess></stage><stage stageid="6dace494-d4a8-4d6a-8169-cfd699f9f583" name="03 Random Sampling" type="SubSheetInfo"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><narrative>This page generates the random number using PowerShell, compares it to the desired target percentage and sets a global flag indicating whether manual review is needed</narrative><display x="-225" y="-30" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="ddcca36f-4cf9-489e-abf7-6135db964332" name="02 ML Prediction" type="SubSheet"><display x="120" y="240" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>731b1d6d-580d-4e96-9d99-20280f13ae57</onsuccess><processid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</processid></stage><stage stageid="731b1d6d-580d-4e96-9d99-20280f13ae57" name="03 Random Sampling" type="SubSheet"><display x="120" y="285" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>eb15fe18-d64f-4ffc-a07b-90af38776ded</onsuccess><processid>47e58161-0f42-47cc-aa94-af755a8de010</processid></stage><stage stageid="4fc18802-6f3f-497d-84f9-d4647d4fe33a" name="Reset Global Data" type="SubSheetInfo"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><narrative>This page is only used to reset global data items</narrative><display x="-165" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="077ec244-9c84-4210-b6a5-e54b1b6000f0" name="Start" type="Start"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><display x="15" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0dee5c1d-8e68-49ec-a0ae-94125067ae6a</onsuccess></stage><stage stageid="0dee5c1d-8e68-49ec-a0ae-94125067ae6a" name="End" type="End"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><display x="15" y="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="bef8f1ff-727a-4e0a-b29e-ed73fb6f0147" name="Reset Global Data" type="SubSheet"><display x="390" y="210" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0341efdc-206a-43f9-8369-583aa2642c07</onsuccess><processid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</processid></stage><stage stageid="ffb4d158-5875-4239-bd22-b7ca87c93bbc" name="Mark Item As Exception" type="SubSheet"><display x="285" y="675" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8f17792f-057d-4155-804d-35098307f65b</onsuccess><processid>d599353b-a78b-40f4-ab04-255791b86a1a</processid></stage><stage stageid="e3035b4a-aba4-4fa5-932e-cbaab6a81b7b" name="Mark Item As Completed" type="SubSheet"><display x="285" y="390" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>1ef745eb-5713-4876-9937-47ac6d74b94b</onsuccess><processid>d31d1c11-61ad-4c49-91a4-44bbf0bf0725</processid></stage><stage stageid="8f6d0bfa-2d98-469e-997c-88b0c126d4d7" name="Reset Consecutive Exception Indicators" type="MultipleCalculation"><subsheetid>d31d1c11-61ad-4c49-91a4-44bbf0bf0725</subsheetid><display x="15" y="60" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>7f3bfe56-9180-4254-8d9c-ee9ab331b39a</onsuccess><steps><calculation expression="&quot;&quot;" stage="Previous Exception Detail" /><calculation expression="0" stage="Consecutive Exception Count" /></steps></stage><stage stageid="7f3bfe56-9180-4254-8d9c-ee9ab331b39a" name="End3" type="End"><subsheetid>d31d1c11-61ad-4c49-91a4-44bbf0bf0725</subsheetid><display x="15" y="120" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="46407e01-19d6-439f-b64b-e6a18e1ae3db" name="Stop?" type="Decision"><display x="390" y="60" w="90" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><decision expression="IsStopRequested() OR [Stop After Items]=0 OR LocalTime()&gt;[Stop After Time]" /><ontrue>22b42ab0-feae-42b2-a098-9871956bb826</ontrue><onfalse>b9deef81-8e13-43ef-b6e4-c7554776c97d</onfalse></stage><stage stageid="5ce83707-f042-4e73-929c-e7358ebdc456" name="Tag Item" type="Action"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Adds a tag to a work queue item</narrative><display x="105" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the queue item to add the tag to" expr="[Item ID]" /><input type="text" name="Tag" narrative="The tag to add to the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;Business Exception&quot;" /></inputs><onsuccess>daa36ca6-f942-4ebc-86fc-8ba76b19cb4d</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Tag Item" /></stage><stage stageid="0341efdc-206a-43f9-8369-583aa2642c07" name="Count Items" type="Calculation"><display x="390" y="135" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>46407e01-19d6-439f-b64b-e6a18e1ae3db</onsuccess><calculation expression="[Stop After Items]-1" stage="Stop After Items" /></stage><stage stageid="131b5818-75e5-49ed-9fd5-4d8a51ce52f1" name="Item ID" type="Data"><display x="-210" y="180" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="2d0552e3-8ed7-4090-b123-2fbe46f2918e" name="Item Data" type="Collection"><display x="-210" y="135" w="150" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><alwaysinit /></stage><stage stageid="ab543cd9-eb36-48bb-869d-f0e87751767b" name="Item Status" type="Data"><display x="-210" y="210" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="3615f299-65d4-4b0b-ba12-72bd84993bf8" name="Item Attempts" type="Data"><display x="-210" y="240" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><alwaysinit /></stage><stage stageid="85fbb578-f410-4f72-8ca9-58513939bc51" name="Get Next Item" type="Action"><narrative>This action gets the next item to be worked from the queue, returning its details and locking it so no other case can work it.

Items with higher priorities (lower numerical value) are processed first. Where the priority is the same, the next item is the one that has been in the queue the longest,  is not already locked, and is not already completed.

The Item ID returned is used to make further calls to update the work status for that item. It may be empty, in which case there are no items available. This can mean either a) the queue is empty, or b) the queue is not running. This mechanism can be used to cleanly stop all processes working a particular queue at the end of the next case. Items that have a 'deferred' time set will not be returned unless that time has been reached.</narrative><display x="15" y="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Queue Name" narrative="The name of the queue" expr="[Queue Name]" /><input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" /><input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" /></inputs><outputs><output type="text" name="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" /><output type="collection" name="Data" narrative="The data associated with the item - a single collection row." stage="Item Data" /><output type="text" name="Status" narrative="The status of the item." stage="Item Status" /><output type="number" name="Attempts" narrative="The number of attempts already made to work this item." stage="Item Attempts" /></outputs><onsuccess>10cdebf6-ced7-425b-91dd-2b0b764b5ee0</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" /></stage><stage stageid="e7450b45-6166-42c1-b727-c904883265b5" name="Reset Consecutive Exception Indicators" type="MultipleCalculation"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="450" y="30" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>f06041aa-ea81-4ef5-b916-b46c6a06f168</onsuccess><steps><calculation expression="&quot;&quot;" stage="Previous Exception Detail" /><calculation expression="0" stage="Consecutive Exception Count" /></steps></stage><stage stageid="d08c5e70-1fd1-416b-9fdc-df51ccc54906" name="Exception Type" type="Data"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><display x="-165" y="-15" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="7ec266b2-b0c3-4dca-9e5b-f4cc61966dfa" name="Exception Detail" type="Data"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><display x="-165" y="15" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="b9deef81-8e13-43ef-b6e4-c7554776c97d" name="Get Next Item" type="Action"><narrative>This action gets the next item to be worked from the queue, returning its details and locking it so no other case can work it.

Items with higher priorities (lower numerical value) are processed first. Where the priority is the same, the next item is the one that has been in the queue the longest,  is not already locked, and is not already completed.

The Item ID returned is used to make further calls to update the work status for that item. It may be empty, in which case there are no items available. This can mean either a) the queue is empty, or b) the queue is not running. This mechanism can be used to cleanly stop all processes working a particular queue at the end of the next case. Items that have a 'deferred' time set will not be returned unless that time has been reached.</narrative><display x="270" y="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Queue Name" narrative="The name of the queue" expr="[Queue Name]" /><input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" /><input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" /></inputs><outputs><output type="text" name="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" /><output type="collection" name="Data" narrative="The data associated with the item - a single collection row." stage="Item Data" /><output type="text" name="Status" narrative="The status of the item." stage="Item Status" /><output type="number" name="Attempts" narrative="The number of attempts already made to work this item." stage="Item Attempts" /></outputs><onsuccess>10cdebf6-ced7-425b-91dd-2b0b764b5ee0</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" /></stage><stage stageid="8f17792f-057d-4155-804d-35098307f65b" name="anchor14" type="Anchor"><display x="390" y="675" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>1ef745eb-5713-4876-9937-47ac6d74b94b</onsuccess></stage><stage stageid="7cfa842f-7ad3-4458-943f-6d7007300925" name="Note9" type="Note"><narrative>No more items available</narrative><display x="120" y="-90" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>22b42ab0-feae-42b2-a098-9871956bb826</onsuccess></stage><stage stageid="d64ced1f-6499-41a5-b006-5b03a3bd4ed0" name="Stop After Time" type="Data"><narrative>Used by the process to decide whether to keep working or close itself down. This value can be modified from Control Room to bring a session to an early finish.</narrative><display x="-210" y="15" w="150" h="30" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><datatype>time</datatype><initialvalue>23:59:59</initialvalue><exposure>Session</exposure><private /><alwaysinit /></stage><stage stageid="aff8912c-98ae-4bb9-84d5-a2eab0253c71" name="Stop After Items" type="Data"><narrative>Used by the process to decide whether to keep working or close itself down. This value can be modified from Control Room to bring a session to an early finish.</narrative><display x="-210" y="45" w="150" h="30" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><datatype>number</datatype><initialvalue>9999999999</initialvalue><exposure>Session</exposure><private /><alwaysinit /></stage><stage stageid="eb957176-69ca-436f-b5b8-a0af1c12f549" name="Stopping Control Settings" type="Block"><display x="-300" y="-30" w="180" h="105" /><font family="Tahoma" size="10" style="Regular" color="FF0000" /></stage><stage stageid="d303b2cb-0441-445a-8463-956e2863a1d4" name="Queue Name" type="Data"><display x="-210" y="-75" w="150" h="30" /><font family="Tahoma" size="10" style="Bold" color="0000FF" /><datatype>text</datatype><initialvalue xml:space="preserve">Chapter 5 Example 3 Queue</initialvalue><alwaysinit /></stage><stage stageid="f9d7ca2d-a983-471c-bc79-408b2230269a" name="Process Settings" type="Block"><display x="-300" y="-105" w="180" h="60" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="c46d4291-41ed-4f54-9fce-f5b76838fb18" name="Retry Limit" type="Data"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="-135" y="45" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>3</initialvalue><private /><alwaysinit /></stage><stage stageid="e7d7779b-4ada-4ae1-9722-512eb475bfcd" name="Retry Count" type="Data"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="-135" y="75" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="6fa1db8d-0510-4c35-8416-9a938e94c78d" name="Exception Data" type="MultipleCalculation"><display x="120" y="600" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>53762061-333e-4023-b99f-1de349dfc4a4</onsuccess><steps><calculation expression="ExceptionType()" stage="Exception Type" /><calculation expression="ExceptionDetail()" stage="Exception Detail" /></steps></stage><stage stageid="7105b714-612a-4e50-84b3-f789f0634902" name="Note5" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><loginhibit /><narrative>This exception is different from the previous one.</narrative><display x="150" y="225" w="120" h="90" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>9de6523c-e14d-4937-b854-1b0930857c02</onsuccess></stage><stage stageid="7360eced-01c7-4dc8-a7ef-817d130f1cc5" name="Note5" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><loginhibit /><narrative>This exception is the same as the previous one but the consecutive exception limit has not yet been reached.</narrative><display x="150" y="375" w="120" h="90" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>64a4e876-5092-4568-829b-73faed844a31</onsuccess></stage><stage stageid="daa36ca6-f942-4ebc-86fc-8ba76b19cb4d" name="Note5" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><loginhibit /><narrative>Don't retry this type of exception, just mark the queue item and carry on.</narrative><display x="225" y="30" w="120" h="90" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>a97071fe-23f0-44d4-a04a-1516826f8ace</onsuccess></stage><stage stageid="52e45164-64b2-41fd-b6da-09c88ec7cdf7" name="Mark Exception" type="Action"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative><display x="15" y="150" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Exception Reason" narrative="A description of the reason for the exception" expr="[Exception Detail]" /><input type="flag" name="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="True" /><input type="flag" name="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="False" /></inputs><outputs><output type="text" name="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="New Item ID" /></outputs><onsuccess>a374264f-2dbf-4477-bad7-ee4ba812e5b1</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" /></stage><stage stageid="a97071fe-23f0-44d4-a04a-1516826f8ace" name="Mark Exception" type="Action"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative><display x="345" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Exception Reason" narrative="A description of the reason for the exception" expr="[Exception Detail]" /><input type="flag" name="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="False" /><input type="flag" name="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="False" /></inputs><outputs><output type="text" name="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="New Item ID" /></outputs><onsuccess>e7450b45-6166-42c1-b727-c904883265b5</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" /></stage><stage stageid="f06041aa-ea81-4ef5-b916-b46c6a06f168" name="End1" type="End"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="555" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="6b5864ff-c8f2-4c69-8e1b-d090c057cdc2" name="Tag Item" type="Action"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Adds a tag to a work queue item</narrative><display x="15" y="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the queue item to add the tag to" expr="[Item ID]" /><input type="text" name="Tag" narrative="The tag to add to the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;System Exception&quot;" /></inputs><onsuccess>52e45164-64b2-41fd-b6da-09c88ec7cdf7</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Tag Item" /></stage><stage stageid="6d17105a-27e9-4ac6-8d57-801cf94fefe2" name="Retry Limit" type="Data"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit /><display x="-195" y="105" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>3</initialvalue><private /><alwaysinit /></stage><stage stageid="c16b3a3f-92d4-4cde-a139-24194f2d7952" name="Retry Count" type="Data"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit /><display x="-195" y="135" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="808cbef2-cfe3-460f-ba72-91e0e6283988" name="System Unavailable?" type="Decision"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="15" y="-45" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="Lower([Exception Type])=&quot;system unavailable exception&quot; OR Lower([Exception Type])=&quot;login system exception&quot;" /><ontrue>5669721f-c338-4600-9152-9d0d75cbce7e</ontrue><onfalse>b9fbad6e-b3b1-4e9b-bc71-1b96d40beeb2</onfalse></stage><stage stageid="5669721f-c338-4600-9152-9d0d75cbce7e" name="Release Item" type="Action"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Marks the item as deferred. It is unlocked, but it will not be made available for processing again until the specified time.

The attempts count for the item is reset to zero.</narrative><display x="-120" y="-45" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to defer" expr="[Item ID]" /><input type="datetime" name="Until" narrative="When to resume processing the case" expr="Now()" /></inputs><onsuccess>8500ffb8-f46a-46cf-9ec9-3637f23f10ff</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Defer" /></stage><stage stageid="8500ffb8-f46a-46cf-9ec9-3637f23f10ff" name="TERMINATE" type="Exception"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="-120" y="30" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><exception type="" detail="[Consecutive Exception Limit] &amp; &quot; consecutive incidents of &quot; &amp; [Exception Type] &amp; &quot;: &quot; &amp; [Exception Detail]" /></stage><stage stageid="de2c89a2-171e-4bd8-b1cf-34b1f4040f68" name="Start" type="Start"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit /><display x="-30" y="-30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>5380890d-c761-4a23-8b89-b86262e5acd1</onsuccess></stage><stage stageid="8ff3b78a-04ad-4b33-9fb0-691f386100eb" name="End" type="End"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit /><display x="15" y="465" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="ffdfc19f-b656-4eb8-870d-f179be1f3891" name="Retry Limit" type="Data"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit /><display x="-225" y="45" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>3</initialvalue><private /><alwaysinit /></stage><stage stageid="b7db49cd-d54b-483a-bf59-413986011ce4" name="Retry Count" type="Data"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit /><display x="-225" y="75" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="655536e7-b3fd-4080-9f98-2fe98e6dbbfb" name="Start" type="Start"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><display x="60" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0aebd4a9-50d3-4389-982d-14e4d0f344d1</onsuccess></stage><stage stageid="309d561b-7459-41fc-bdc8-048a46336106" name="Recover" type="Recover"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="255" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8943e5dc-119d-4aef-9e2d-61bc9b4ad225</onsuccess></stage><stage stageid="e43623c9-38bf-47db-b5f0-db158e681de8" name="Resume" type="Resume"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="255" y="45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8d4036c4-fb6d-4b8e-b512-9a713fbc0c0c</onsuccess></stage><stage stageid="2848a429-d5d1-4546-9a1b-16ef0f3c3a0c" name="Count" type="Calculation"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="345" y="45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>e43623c9-38bf-47db-b5f0-db158e681de8</onsuccess><calculation expression="[Retry Count]+1" stage="Retry Count" /></stage><stage stageid="8943e5dc-119d-4aef-9e2d-61bc9b4ad225" name="Retry?" type="Decision"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="345" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Retry Count]&lt;[Retry Limit] AND (Lower(ExceptionType())=&quot;system exception&quot; OR Lower(ExceptionType())=&quot;internal&quot;)" /><ontrue>2848a429-d5d1-4546-9a1b-16ef0f3c3a0c</ontrue><onfalse>f12f8dc4-9c47-4f0b-be74-736b78b0bc2d</onfalse></stage><stage stageid="f12f8dc4-9c47-4f0b-be74-736b78b0bc2d" name="Throw" type="Exception"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="435" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="97b3f0e6-9371-4bab-a12d-c39f8dbf2a41" name="Note3" type="Note"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><narrative>Step 1a</narrative><display x="60" y="45" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>91a71005-8abc-4f43-9615-fec34ccf57df</onsuccess></stage><stage stageid="ee64c95b-60b1-4479-ad29-9e474ce55feb" name="Step 1 Block" type="Block"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="-15" y="0" w="315" h="135" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="91a71005-8abc-4f43-9615-fec34ccf57df" name="Note3" type="Note"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><narrative>Step 1b</narrative><display x="60" y="90" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>dd1ff1be-5f88-4cf7-9047-232b3cde232a</onsuccess></stage><stage stageid="0aebd4a9-50d3-4389-982d-14e4d0f344d1" name="anchor5" type="Anchor"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><display x="60" y="-45" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>97b3f0e6-9371-4bab-a12d-c39f8dbf2a41</onsuccess></stage><stage stageid="dd1ff1be-5f88-4cf7-9047-232b3cde232a" name="End6" type="End"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><display x="60" y="165" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="8d4036c4-fb6d-4b8e-b512-9a713fbc0c0c" name="Note3" type="Note"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><narrative>Navigate back ready for step 1a - maybe restart application (Close and Start pages)</narrative><display x="255" y="-45" w="180" h="60" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>0aebd4a9-50d3-4389-982d-14e4d0f344d1</onsuccess></stage><stage stageid="ce1f11b6-9a7a-41aa-9e43-0a058afb3c8c" name="Note4" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>System not working or can not log in</narrative><display x="-105" y="-105" w="90" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /><onsuccess>808cbef2-cfe3-460f-ba72-91e0e6283988</onsuccess></stage><stage stageid="8ffb59ed-f576-43df-89b7-8e91fa563bd0" name="Note4" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Check for concurrent exceptions, a system change may have occured</narrative><display x="150" y="135" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /><onsuccess>a374264f-2dbf-4477-bad7-ee4ba812e5b1</onsuccess></stage><stage stageid="23e8a233-85ce-49a2-8a49-032f65ee413b" name="Note4" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Tag exception category for Blue Prism Performance reports</narrative><display x="150" y="-60" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /><onsuccess>5ce83707-f042-4e73-929c-e7358ebdc456</onsuccess></stage><stage stageid="0b73e13d-4605-495a-88f9-22456673ef57" name="Start" type="Start"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="15" y="195" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>2224f402-cc78-4d9f-ad30-36aaf7c782f2</onsuccess></stage><stage stageid="76aa907d-c3fe-489a-bd3c-6e44ead806ff" name="PS Script" type="Block"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="-270" y="270" w="150" h="60" /><font family="Tahoma" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="a9123fda-6d02-4484-aaf0-14b9b85d6b97" name="Populate Queue" type="SubSheetInfo"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="-180" y="-120" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="275b91ea-8c22-44f7-804b-201f234f19b9" name="Start" type="Start"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="30" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>a62fb73d-4ede-4f55-a9c2-91f7d8be5718</onsuccess></stage><stage stageid="dc7df0cb-5182-477f-8c1e-181fcc08d09b" name="End" type="End"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="210" y="150" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="1db94fff-eca8-49a2-9404-2b6ba6688410" name="Populate Queue" type="SubSheet"><display x="15" y="-45" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>c3c265ed-6f1a-4af2-ad52-e007cdcdda14</onsuccess><processid>b749d60a-bded-4d36-b099-3627ed699606</processid></stage><stage stageid="fee70eb7-dda6-4069-bfec-62e1ea4809d8" name="Lock Token" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="-180" y="0" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a62fb73d-4ede-4f55-a9c2-91f7d8be5718" name="Aquire Lock" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><narrative>Acquires the lock associated with the given name. If this session already holds the required lock, it will be re-acquired with a new token</narrative><display x="30" y="-60" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Name" narrative="The name of the required lock. Mandatory parameter." expr="[Lock Name]" /><input type="timespan" name="Timeout" narrative="The maximum amount of time to await the lock. Default is to wait forever" expr="MakeTimeSpan(0, 0, 0, 0)" /><input type="text" name="Preferred Token" narrative="The preferred token to use for the lock. Default behaviour is to generate a new unique token." expr="[Lock Token]" /><input type="text" name="Comment" narrative="The comments to set on the lock" expr="&quot;Acquire Lock&quot;" /></inputs><outputs><output type="text" name="Token" narrative="The token registered against the lock. This will be empty if the lock could not be acquired" stage="Lock Token" /></outputs><onsuccess>ea479a64-b2ee-4352-b497-669bf791346a</onsuccess><resource object="BluePrism.AutomateAppCore.clsEnvironmentLockingBusinessObject" action="Acquire Lock" /></stage><stage stageid="318bacb1-b302-4f7b-b4e2-8cb1dd422e25" name="Lock Name" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="-180" y="-30" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">Chapter 5 Example 3 Lock</initialvalue><private /><alwaysinit /></stage><stage stageid="1fe7d33e-bda4-42f2-8389-528c1ad42f60" name="Populate Queue Settings" type="Block"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="-255" y="-60" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="ea479a64-b2ee-4352-b497-669bf791346a" name="Got Lock?" type="Decision"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="30" y="-15" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Lock Token] &lt;&gt; &quot;&quot;" /><ontrue>b2b301fb-9a48-4052-8b93-4c9e44358621</ontrue><onfalse>30e6e9dd-dca0-47d6-b758-8260a5269a57</onfalse></stage><stage stageid="949d4522-7e6e-4e78-b4c0-6b5a82cc49ad" name="End5" type="End"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="240" y="-15" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="30e6e9dd-dca0-47d6-b758-8260a5269a57" name="Note6" type="Note"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><narrative>Another session is loading work</narrative><display x="135" y="-15" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>949d4522-7e6e-4e78-b4c0-6b5a82cc49ad</onsuccess></stage><stage stageid="0bfa9daa-527c-47fb-8383-6cf663d9ee6c" name="Load Work Block" type="Block"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="-75" y="30" w="210" h="555" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="bf23b5fb-a7eb-4f0b-a81c-45b0a4470209" name="Recover" type="Recover"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="180" y="330" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>2741e925-6743-4547-b72c-65c3a5ee6be4</onsuccess></stage><stage stageid="2741e925-6743-4547-b72c-65c3a5ee6be4" name="Release Lock" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><narrative>Releases the lock(s) associated with the given name and token</narrative><display x="270" y="330" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Name" narrative="The name of the specific lock to be released. Default behaviour is to release all locks with the given token." expr="[Lock Name]" /><input type="text" name="Token" narrative="The token associated with the lock(s) to be released. Mandatory parameter." expr="[Lock Token]" /><input type="text" name="Comment" narrative="The comments to set on the lock(s)" expr="&quot;Release Lock&quot;" /><input type="flag" name="All Sessions" narrative="True to release locks matching the specified constraints across all sessions; False to only release locks acquired in the current session. Default is False" expr="True" /></inputs><onsuccess>3088063b-55f9-4d06-944f-ea1edf0e1882</onsuccess><resource object="BluePrism.AutomateAppCore.clsEnvironmentLockingBusinessObject" action="Release Lock" /></stage><stage stageid="3088063b-55f9-4d06-944f-ea1edf0e1882" name="Throw" type="Exception"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="345" y="330" /><font family="Tahoma" size="10" style="Regular" color="000000" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="798a2609-c9b8-49fb-900d-19a17a2a1c74" name="Release Lock" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><narrative>Releases the lock(s) associated with the given name and token</narrative><display x="210" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Name" narrative="The name of the specific lock to be released. Default behaviour is to release all locks with the given token." expr="[Lock Name]" /><input type="text" name="Token" narrative="The token associated with the lock(s) to be released. Mandatory parameter." expr="[Lock Token]" /><input type="text" name="Comment" narrative="The comments to set on the lock(s)" expr="&quot;Release lock&quot;" /><input type="flag" name="All Sessions" narrative="True to release locks matching the specified constraints across all sessions; False to only release locks acquired in the current session. Default is False" expr="True" /></inputs><onsuccess>dc7df0cb-5182-477f-8c1e-181fcc08d09b</onsuccess><resource object="BluePrism.AutomateAppCore.clsEnvironmentLockingBusinessObject" action="Release Lock" /></stage><stage stageid="393e5c0f-7d23-4433-9ad0-a7efc47a783f" name="Note4" type="Note"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><narrative>You will need to clean up the application and navigate ready to perform the first action again</narrative><display x="300" y="-135" w="180" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /><onsuccess>8d4036c4-fb6d-4b8e-b512-9a713fbc0c0c</onsuccess></stage><stage stageid="60ff9c2a-74c0-43ce-8d08-313ffc4fa0e8" name="Note4" type="Note"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><narrative>You can take the opportunity when traversing this page to confirm that the target applications are on the correct screen ready for processing the next case.</narrative><display x="120" y="-45" w="150" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /></stage><stage stageid="ac95564f-20e4-4325-a844-ced15edc3dc2" name="Note4" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>The case will only retry if the WQ has been configured to enable retries.</narrative><display x="-90" y="120" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /></stage><stage stageid="1367cffe-d9cb-4483-b9a6-29f59634fb13" name="Success" type="Data"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="-195" y="435" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4be54441-152c-4aec-9d1a-102570288d23" name="Message" type="Data"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="-195" y="465" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="fc00ceef-3266-4c60-af2a-751dd4dcb5d2" name="PS Script Contents" type="Data"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="300" w="120" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">param ($age, $job_id, $salary_range_id, $days_last_purchase, $avg_purchase_size, $rewards_club_points, $gender)
$concat = Write-Output "$($age) $($job_id) $($salary_range_id) $($days_last_purchase) $($avg_purchase_size) $($rewards_club_points) $($gender)"
$hash=[System.Security.Cryptography.HashAlgorithm]::Create("sha256").ComputeHash([System.Text.Encoding]::UTF8.GetBytes($concat))
$hash_str = [System.BitConverter]::ToString($hash).Replace("-","").ToLower()
$nums = $hash_str -replace "[^0-9]", ''
Write-Output "0.$($nums)"</initialvalue><private /><alwaysinit /></stage><stage stageid="2224f402-cc78-4d9f-ad30-36aaf7c782f2" name="Utility - File Management::Write Text File" type="Action"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="285" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The full path to the file to write the text to" expr="[PS Script File Path]" /><input type="text" name="Text" friendlyname="Text" narrative="The text to write to the file" expr="[PS Script Contents]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>2044ecf4-bc37-4a36-8536-7e21f59936b3</onsuccess><resource object="Utility - File Management" action="Write Text File" /></stage><stage stageid="2044ecf4-bc37-4a36-8536-7e21f59936b3" name="File Write Success?" type="Decision"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="15" y="330" w="90" h="30" /><decision expression="[Success]" /><ontrue>24039d62-c2f9-4175-b140-16308c25f311</ontrue><onfalse>8b560626-81ac-4fd3-9ecf-513821b17c15</onfalse></stage><stage stageid="8b560626-81ac-4fd3-9ecf-513821b17c15" name="SE - File write unsuccessful" type="Exception"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="165" y="330" w="90" h="30" /><exception localized="yes" type="System Exception" detail="&quot;SE - File write unsuccessful: &quot; &amp; [Message]" /></stage><stage stageid="13aa1208-da07-44b1-809b-205821c6de1b" name="Note2" type="Note"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><narrative>For purposes of this example, we first write the PS script to disk</narrative><display x="180" y="225" w="90" h="60" /><onsuccess>2224f402-cc78-4d9f-ad30-36aaf7c782f2</onsuccess></stage><stage stageid="cad133c1-c4d2-406a-84af-7a8b40840139" name="Write the Script to Disk" type="Block"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="255" w="135" h="105" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="f37e491b-3315-4449-bcd8-e8c637f8c1bb" name="PS Script File Path" type="Data"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="375" w="120" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">C:\Users\Public\ch5_example3.ps1</initialvalue><alwaysinit /></stage><stage stageid="b3d6ada9-3d75-4f2d-8738-5c7621725b48" name="Change if necessary" type="Block"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="-270" y="345" w="150" h="60" /><font family="Segoe UI" size="10" style="Regular" color="33CCCC" /></stage><stage stageid="4d340ec5-7fd4-4b55-8171-ed587c84eaa4" name="End7" type="End"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="675" /></stage><stage stageid="14f3c27e-8315-4c5c-add2-384f509eb52a" name="Success" type="Data"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="-210" y="-120" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6fb6d556-997e-4cff-8a82-7d0c27cb3198" name="Message" type="Data"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="-210" y="-90" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4845aa0d-6dbe-47fc-ae46-6b35778c7317" name="Exists" type="Data"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="-210" y="-150" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f9758604-8646-4883-90b3-b7e59d317183" name="End" type="End"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="15" y="150" /></stage><stage stageid="73635005-3d4b-4688-a655-29a77eeacf4a" name="Utility - File Management::Delete File" type="Action"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-15" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The full path to the file to delete" expr="[PS Script File Path]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>27cc4c5c-1199-4af3-9f83-7cd6e4c922cd</onsuccess><resource object="Utility - File Management" action="Delete File" /></stage><stage stageid="8edd051f-93cd-4a50-b830-432cc195b19c" name="Utility - File Management::File Exists" type="Action"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-105" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The name of the file to check" expr="[PS Script File Path]" /></inputs><outputs><output type="flag" name="Exists" friendlyname="Exists" narrative="True if the file exists" stage="Exists" /></outputs><onsuccess>3532ab74-1605-46e8-bd40-f2ea17331a16</onsuccess><resource object="Utility - File Management" action="File Exists" /></stage><stage stageid="3532ab74-1605-46e8-bd40-f2ea17331a16" name="PS File Exists?" type="Decision"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="15" y="-60" w="90" h="30" /><decision expression="[Exists]" /><ontrue>73635005-3d4b-4688-a655-29a77eeacf4a</ontrue><onfalse>a384f6c3-c1f9-4cc2-a62f-e0b95e0001a7</onfalse></stage><stage stageid="27cc4c5c-1199-4af3-9f83-7cd6e4c922cd" name="File Delete Success?" type="Decision"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="15" y="30" w="90" h="30" /><decision expression="[Success]" /><ontrue>e530266a-f28c-4ca8-b845-5313fdb98d5e</ontrue><onfalse>6381877c-5fa2-46ab-bc55-ad45071059db</onfalse></stage><stage stageid="a384f6c3-c1f9-4cc2-a62f-e0b95e0001a7" name="Anchor1" type="Anchor"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="-60" y="-60" w="10" h="10" /><onsuccess>a81d082b-ba1d-4472-9c18-ccf83b6fac77</onsuccess></stage><stage stageid="b2cef6df-bccc-40ca-beda-1572e9a738e7" name="Delete Script" type="Block"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="-135" w="150" h="195" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="a81d082b-ba1d-4472-9c18-ccf83b6fac77" name="Anchor6" type="Anchor"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="-60" y="105" w="10" h="10" /><onsuccess>e530266a-f28c-4ca8-b845-5313fdb98d5e</onsuccess></stage><stage stageid="6381877c-5fa2-46ab-bc55-ad45071059db" name="Anchor2" type="Anchor"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="135" y="30" w="10" h="10" /><onsuccess>7a6c41dd-7548-434f-aa62-7cdc30a67c79</onsuccess></stage><stage stageid="7a6c41dd-7548-434f-aa62-7cdc30a67c79" name="Anchor3" type="Anchor"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="135" y="105" w="10" h="10" /><onsuccess>e530266a-f28c-4ca8-b845-5313fdb98d5e</onsuccess></stage><stage stageid="28a77b39-291a-488c-b002-900379be62fc" name="Global Item Data" type="Block"><loginhibit onsuccess="true" /><display x="-300" y="90" w="180" h="180" /><font family="Segoe UI" size="10" style="Regular" color="FF99CC" /></stage><stage stageid="83203064-35b8-4dac-93e3-6d5f9a2e6100" name="Work Queues::Add To Queue" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative><display x="210" y="60" w="120" h="30" /><inputs><input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to add items to" expr="[Queue Name]" /><input type="collection" name="Data" friendlyname="Data" narrative="A collection containing the data, one row for each item to be added" expr="[All Customer Data]" /><input type="datetime" name="Defer Until" friendlyname="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="" /><input type="number" name="Priority" friendlyname="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="" /><input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="" /><input type="text" name="Status" friendlyname="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="" /><input type="number" name="Batch Size" friendlyname="Batch Size" narrative="Optionally, the batch size to use when adding many items to the queue.  A Value of 0 will process all items in one batch.  An empty field will use the default batch size of 1000." expr=""><validator type="BluePrism.AutomateProcessCore.RangeParameterValidation" parameter="0:25000" /></input></inputs><outputs><output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="" /></outputs><onsuccess>798a2609-c9b8-49fb-900d-19a17a2a1c74</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" /></stage><stage stageid="ab59e6a7-01dd-463f-8da7-038aff9933d9" name="Standard Output" type="Data"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><display x="-225" y="135" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1fd430fc-b8f4-4f88-9f61-8e2e3f248926" name="Standard Error" type="Data"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><display x="-225" y="165" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c5264ff4-2786-4297-9690-105eeec823bd" name="Random Number" type="Block"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="-300" y="105" w="150" h="120" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="ea834600-18a0-4541-bf9e-815a6c930706" name="Random Number" type="Data"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="-225" y="195" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b75d1cd6-195a-44be-b56c-38999b45173e" name="Ch5 Example 3 Random Sampling Target" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="315" w="150" h="30" /><datatype>number</datatype><initialvalue>20</initialvalue><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="d3851f14-885d-4b9c-b238-ba314e536caf" name="Global Environment Variables" type="Block"><loginhibit onsuccess="true" /><display x="-300" y="285" w="180" h="195" /><font family="Segoe UI" size="10" style="Regular" color="FF9900" /></stage><stage stageid="fd3de115-7b1e-4758-b300-a7638023e9d5" name="04 Work Step" type="SubSheetInfo"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><display x="-105" y="-90" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="308f43c5-5697-48f7-8dd7-07c460485377" name="Retry Limit" type="Data"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="-135" y="45" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>3</initialvalue><private /><alwaysinit /></stage><stage stageid="74dc342a-19cc-49e7-adde-c458e72b9e78" name="Retry Count" type="Data"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="-135" y="75" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="e813e764-c676-4a19-bfeb-1c7118c7b2d9" name="Start" type="Start"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><display x="60" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>a6820832-c345-4959-9a64-a7078480d0d5</onsuccess></stage><stage stageid="819e7620-6f52-46fa-a35b-dba04bbad22c" name="Recover" type="Recover"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="255" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>4d98824a-8234-4e61-8b13-862fc6c934ea</onsuccess></stage><stage stageid="5327542f-0c16-4773-bed1-134b1f6262b6" name="Resume" type="Resume"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="255" y="45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>62157c97-49f4-4f52-b1ae-ab6a09a6d793</onsuccess></stage><stage stageid="f6e26f1f-c17a-4f43-a63b-e6f1df8d0da2" name="Count" type="Calculation"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="345" y="45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>5327542f-0c16-4773-bed1-134b1f6262b6</onsuccess><calculation expression="[Retry Count]+1" stage="Retry Count" /></stage><stage stageid="4d98824a-8234-4e61-8b13-862fc6c934ea" name="Retry?" type="Decision"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="345" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Retry Count]&lt;[Retry Limit] AND (Lower(ExceptionType())=&quot;system exception&quot; OR Lower(ExceptionType())=&quot;internal&quot;)" /><ontrue>f6e26f1f-c17a-4f43-a63b-e6f1df8d0da2</ontrue><onfalse>51552122-f69e-4d98-a33a-896cdfeebb6e</onfalse></stage><stage stageid="51552122-f69e-4d98-a33a-896cdfeebb6e" name="Throw" type="Exception"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="435" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="477bc1ef-8aa4-45cf-b864-7b4034e8d93a" name="Note3" type="Note"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><narrative>Step 1a</narrative><display x="60" y="45" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>a7b98ee2-7727-40ca-b8f8-05d6a636b3c3</onsuccess></stage><stage stageid="7cf273b6-ed66-4682-b161-9021cb762886" name="Step 1 Block" type="Block"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="-15" y="0" w="315" h="135" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="a7b98ee2-7727-40ca-b8f8-05d6a636b3c3" name="Note3" type="Note"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><narrative>Step 1b</narrative><display x="60" y="90" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>ad22c731-f5e9-41dd-964a-01b2607f9513</onsuccess></stage><stage stageid="a6820832-c345-4959-9a64-a7078480d0d5" name="anchor5" type="Anchor"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><display x="60" y="-45" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>477bc1ef-8aa4-45cf-b864-7b4034e8d93a</onsuccess></stage><stage stageid="ad22c731-f5e9-41dd-964a-01b2607f9513" name="End6" type="End"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><display x="60" y="165" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="62157c97-49f4-4f52-b1ae-ab6a09a6d793" name="Note3" type="Note"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><narrative>Navigate back ready for step 1a - maybe restart application (Close and Start pages)</narrative><display x="255" y="-45" w="180" h="60" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>a6820832-c345-4959-9a64-a7078480d0d5</onsuccess></stage><stage stageid="d9695bc3-6737-40da-96ca-286d4eac665f" name="Note4" type="Note"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><narrative>You will need to clean up the application and navigate ready to perform the first action again</narrative><display x="300" y="-135" w="180" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /><onsuccess>62157c97-49f4-4f52-b1ae-ab6a09a6d793</onsuccess></stage><stage stageid="5d70865d-4657-4147-a57e-52d267aa7406" name="04 Work Step" type="SubSheet"><loginhibit onsuccess="true" /><display x="120" y="390" w="90" h="30" /><onsuccess>e3035b4a-aba4-4fa5-932e-cbaab6a81b7b</onsuccess><processid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</processid></stage><stage stageid="9bcdcb8b-ec78-438f-95fe-94b0094840f0" name="Exists" type="Data"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="-195" y="285" w="150" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6cc34200-6b21-444c-b748-3a14d7a51494" name="Redirection File" type="Data"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="-195" y="195" w="150" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="af200597-55d8-450a-8c82-76c4aee03315" name="Inputs" type="Block"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="-285" y="15" w="165" h="60" /><font family="Segoe UI" size="10" style="Regular" color="FF99CC" /></stage><stage stageid="cfd76874-0899-41bb-9f32-28d59207baef" name="Customer Data" type="Collection"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="-195" y="45" w="150" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><singlerow /><field name="age" type="number" /><field name="job_id" type="number" /><field name="salary_range_id" type="number" /><field name="days_last_purchase" type="number" /><field name="avg_purchase_size" type="number" /><field name="rewards_club_points" type="number" /><field name="gender" type="number" /><field name="customer_id" type="text" /></collectioninfo><initialvalue><singlerow /><row><field name="age" type="number" value="" /><field name="job_id" type="number" value="" /><field name="salary_range_id" type="number" value="" /><field name="days_last_purchase" type="number" value="" /><field name="avg_purchase_size" type="number" value="" /><field name="rewards_club_points" type="number" value="" /><field name="gender" type="number" value="" /><field name="customer_id" type="text" value="" /></row></initialvalue></stage><stage stageid="2a85bbad-8ecf-47c2-af3d-6c4525167726" name="Success" type="Data"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="-195" y="225" w="150" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2e7d4557-747d-4c23-900b-70d8639ab426" name="Message" type="Data"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="-195" y="255" w="150" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2abe76be-3b9e-4c3d-8d5c-c92b3ebc8039" name="End" type="End"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="15" y="750" /></stage><stage stageid="b1b2ae36-0b70-42ec-a1ae-a72e789fe88b" name="Predict using PowerShell Script" type="Block"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="45" w="195" h="75" /><font family="Segoe UI" size="10" style="Regular" color="FF9900" /></stage><stage stageid="455fd628-ba19-4e7a-b080-44919a95060f" name="Redirection File Exists?" type="Decision"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="15" y="210" w="90" h="30" /><decision expression="[Exists]" /><ontrue>dae27001-9ee5-41b7-b08c-ea47018feb7f</ontrue><onfalse>699430c6-a94f-4d52-8b83-dd6f24e60632</onfalse></stage><stage stageid="44df47e0-abaa-4bc7-8c74-dece46e8befc" name="Set Redirection File" type="Calculation"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" /><onsuccess>39c91870-34ff-4b16-976b-1f1062bea3c9</onsuccess><calculation expression="&quot;C:\Users\Public\&quot; &amp; [Customer Data.customer_id] &amp; &quot;_&quot; &amp; FormatDateTime(Now(), &quot;yyyy_MM_dd_HH_mm_ss&quot;) &amp; &quot;.txt&quot;" stage="Redirection File" /></stage><stage stageid="6913c8e4-98d7-4e57-9f70-1aa8fe705c3e" name="Utility - File Management::File Exists" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="165" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The name of the file to check" expr="[Redirection File]" /></inputs><outputs><output type="flag" name="Exists" friendlyname="Exists" narrative="True if the file exists" stage="Exists" /></outputs><onsuccess>455fd628-ba19-4e7a-b080-44919a95060f</onsuccess><resource object="Utility - File Management" action="File Exists" /></stage><stage stageid="dae27001-9ee5-41b7-b08c-ea47018feb7f" name="Utility - File Management::Read All Text from File" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="255" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The full path the file to read the text from" expr="[Redirection File]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /><output type="text" name="Text" friendlyname="Text" narrative="The text of the file" stage="Text Result" /></outputs><onsuccess>9bd7147c-0f18-49e4-bf63-906dad06db5e</onsuccess><resource object="Utility - File Management" action="Read All Text from File" /></stage><stage stageid="9bd7147c-0f18-49e4-bf63-906dad06db5e" name="File Has Text?" type="Decision"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="15" y="300" /><decision expression="Trim([Text Result]) &lt;&gt; &quot;&quot;" /><ontrue>e637404c-ce57-4e4b-84c1-d1c53410a870</ontrue><onfalse>5c9c9152-eef3-4e2f-974b-abca9541046a</onfalse></stage><stage stageid="5c9c9152-eef3-4e2f-974b-abca9541046a" name="Anchor5" type="Anchor"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="285" y="300" w="10" h="10" /><onsuccess>699430c6-a94f-4d52-8b83-dd6f24e60632</onsuccess></stage><stage stageid="58b03554-ea40-430f-b21e-1bb32f36f5ab" name="Read Prediction from Redirected File" type="Block"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="135" w="195" h="285" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e637404c-ce57-4e4b-84c1-d1c53410a870" name="Utility - File Management::Delete File" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="345" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The full path to the file to delete" expr="[Redirection File]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="" /></outputs><onsuccess>8a6fb4f0-a823-495a-8073-a10fcb14679e</onsuccess><resource object="Utility - File Management" action="Delete File" /></stage><stage stageid="f2851675-f356-49d2-a8c2-e6ec8d4917f5" name="Utility - Environment::Run Process Until Ended" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="90" w="90" h="30" /><inputs><input type="text" name="Application" friendlyname="Application" narrative="The application or shortcut to start" expr="&quot;powershell.exe&quot;" /><input type="text" name="Arguments" friendlyname="Arguments" narrative="Optional - any arguments needed to run the application" expr="Chr(34) &amp; [PS Script File Path] &amp; Chr(34) &amp; &quot; &quot; &amp; [Item Data.age] &amp; &quot; &quot; &amp; [Item Data.job_id] &amp; &quot; &quot; &amp; [Item Data.salary_range_id] &amp; &quot; &quot; &amp; [Item Data.days_last_purchase] &amp; &quot; &quot; &amp; [Item Data.avg_purchase_size] &amp; &quot; &quot; &amp; [Item Data.rewards_club_points] &amp; &quot; &quot; &amp; [Item Data.gender] &amp; &quot; &gt; &quot; &amp; Chr(34) &amp; [Redirection File] &amp; Chr(34)" /><input type="text" name="Working Folder" friendlyname="Working Folder" narrative="Optional - the application working folder" expr="" /><input type="timespan" name="Timeout" friendlyname="Timeout" narrative="How long to wait for the application to finish. Default is 10 seconds" expr="MakeTimeSpan(0, 0, 0, 5)" /></inputs><onsuccess>6913c8e4-98d7-4e57-9f70-1aa8fe705c3e</onsuccess><resource object="Utility - Environment" action="Run Process Until Ended" /></stage><stage stageid="39c91870-34ff-4b16-976b-1f1062bea3c9" name="Anchor4" type="Anchor"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="15" w="10" h="10" /><onsuccess>f2851675-f356-49d2-a8c2-e6ec8d4917f5</onsuccess></stage><stage stageid="ca12687e-b64e-4e33-9336-99ccd9a9872a" name="Note1" type="Note"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><narrative>We need to have a unique filename for each prediction so that we can identify which prediction belongs to which customer</narrative><display x="165" y="-30" w="150" h="60" /></stage><stage stageid="19b9cab7-26df-4e7f-9a0a-2206d979d125" name="Retry Prediction?" type="Decision"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="285" y="90" /><decision expression="[Retry Count] &lt; [Retry Limit]" /><ontrue>350ad464-6d9b-4a16-9072-8190c0fe16eb</ontrue><onfalse>92a02da2-8615-4611-a653-d677ad8a747b</onfalse></stage><stage stageid="92a02da2-8615-4611-a653-d677ad8a747b" name="SE - Prediction failed" type="Exception"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="390" y="90" /><exception localized="yes" type="System Exception" detail="&quot;SE - Prediction failed&quot;" /></stage><stage stageid="67abb526-c982-479a-b148-258b34461286" name="Recover1" type="Recover"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit /><display x="105" y="90" /><onsuccess>f191df90-81b3-47c4-b8e8-b551ab946cf6</onsuccess></stage><stage stageid="f191df90-81b3-47c4-b8e8-b551ab946cf6" name="Resume1" type="Resume"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit /><display x="195" y="90" /><onsuccess>19b9cab7-26df-4e7f-9a0a-2206d979d125</onsuccess></stage><stage stageid="699430c6-a94f-4d52-8b83-dd6f24e60632" name="Anchor2" type="Anchor"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="285" y="210" w="10" h="10" /><onsuccess>19b9cab7-26df-4e7f-9a0a-2206d979d125</onsuccess></stage><stage stageid="350ad464-6d9b-4a16-9072-8190c0fe16eb" name="[Retry Count]+1" type="Calculation"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="285" y="15" /><onsuccess>39c91870-34ff-4b16-976b-1f1062bea3c9</onsuccess><calculation expression="[Retry Count]+1" stage="Retry Count" /></stage><stage stageid="8a6fb4f0-a823-495a-8073-a10fcb14679e" name="Convert to Number" type="Calculation"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="390" /><onsuccess>c3dce272-0974-4eb7-933f-6141ac5dcc09</onsuccess><calculation expression="ToNumber([Text Result])" stage="Confidence Score" /></stage><stage stageid="c3dce272-0974-4eb7-933f-6141ac5dcc09" name="Confidence Score &gt;= 0.5" type="Decision"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="15" y="450" /><decision expression="[Confidence Score] &gt;= 0.5" /><ontrue>d7f6eef2-a349-4990-b8f6-434b2676406f</ontrue><onfalse>ca661ce8-1088-4da7-ad1a-956869d26d62</onfalse></stage><stage stageid="d7f6eef2-a349-4990-b8f6-434b2676406f" name="Churn" type="Calculation"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="495" /><onsuccess>a066446b-56bd-467c-b27e-dd72348d74cb</onsuccess><calculation expression="&quot;Churn&quot;" stage="Label" /></stage><stage stageid="ca661ce8-1088-4da7-ad1a-956869d26d62" name="Not Churn" type="MultipleCalculation"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="75" y="495" /><onsuccess>a066446b-56bd-467c-b27e-dd72348d74cb</onsuccess><steps><calculation expression="&quot;Not Churn&quot;" stage="Label" /><calculation expression="1-[Confidence Score]" stage="Confidence Score" /></steps></stage><stage stageid="654cc1a6-25bf-47e3-b717-1f16f5f80107" name="Recover2" type="Recover"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit /><display x="105" y="390" /><onsuccess>418f1059-f4c8-4fd1-9756-6df99209cb71</onsuccess></stage><stage stageid="418f1059-f4c8-4fd1-9756-6df99209cb71" name="Resume2" type="Resume"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit /><display x="195" y="390" /><onsuccess>86381e71-723c-4548-b387-3d598afb8741</onsuccess></stage><stage stageid="86381e71-723c-4548-b387-3d598afb8741" name="Anchor7" type="Anchor"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="285" y="390" w="10" h="10" /><onsuccess>5c9c9152-eef3-4e2f-974b-abca9541046a</onsuccess></stage><stage stageid="5b98aaa6-56f8-49fa-8b7e-29265297ea5c" name="Text Result" type="Data"><display x="-210" y="555" w="150" h="30" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="03028732-0b21-4fe8-88f5-e2183cae6fd7" name="Global Prediction Results" type="Block"><loginhibit onsuccess="true" /><display x="-300" y="525" w="180" h="120" /><font family="Segoe UI" size="10" style="Regular" color="C0C0C0" /></stage><stage stageid="31b57a2c-088f-4b84-87fa-0c759c58e8a3" name="Confidence Score" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="585" w="150" h="30" /><datatype>number</datatype><initialvalue /><alwaysinit /></stage><stage stageid="4308dfed-7fbf-425d-99d4-b21f9ce25b57" name="Label" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="615" w="150" h="30" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="b5d8c493-eafe-4e79-a157-25bc8c338de2" name="All Customer Data" type="Collection"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="-180" y="60" w="150" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="age" type="number" /><field name="job_id" type="number" /><field name="salary_range_id" type="number" /><field name="days_last_purchase" type="number" /><field name="avg_purchase_size" type="number" /><field name="rewards_club_points" type="number" /><field name="gender" type="number" /><field name="customer_id" type="text" /></collectioninfo></stage><stage stageid="d7f2b506-2fc6-49f9-bd28-2f9d3c46340c" name="Utility - Environment::Start Process Read Stderr and Stdout" type="Action"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="-30" y="60" w="90" h="30" /><inputs><input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments that coincide with the process." expr="&quot;Get-Random -Minimum 1.0 -Maximum 100.0&quot;" /><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to start." expr="&quot;powershell.exe&quot;" /></inputs><outputs><output type="text" name="Standard Output" friendlyname="Standard Output" stage="Standard Output" /><output type="text" name="Standard Error" friendlyname="Standard Error" stage="Standard Error" /></outputs><onsuccess>392823ce-3cde-46d8-90df-f8443ccd571e</onsuccess><resource object="Utility - Environment" action="Start Process Read Stderr and Stdout" /></stage><stage stageid="34830b12-5fe3-43df-aede-68a24f035a1f" name="Require Manual Review?" type="Decision"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><display x="-30" y="150" w="90" h="30" /><decision expression="[Random Number] &lt; [Ch5 Example 3 Random Sampling Target]" /><ontrue>a6f84ba7-a8bd-4b41-980e-32463993a050</ontrue><onfalse>6aac182e-44f2-42ad-9021-1fd5ae0fdc59</onfalse></stage><stage stageid="392823ce-3cde-46d8-90df-f8443ccd571e" name="Convert to Number" type="Calculation"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="-30" y="105" w="90" h="30" /><onsuccess>34830b12-5fe3-43df-aede-68a24f035a1f</onsuccess><calculation expression="ToNumber([Standard Output])" stage="Random Number" /></stage><stage stageid="8ad1285b-0276-4db6-84ea-bcfe4f925573" name="Note7" type="Note"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><narrative>Generate a Random Number using PowerShell</narrative><display x="105" y="60" w="120" h="30" /><onsuccess>d7f2b506-2fc6-49f9-bd28-2f9d3c46340c</onsuccess></stage><stage stageid="c3a38aad-bba2-4db4-afae-4c1b6fb64d04" name="Manual Review Required" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="690" w="150" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><alwaysinit /></stage><stage stageid="a738625c-dd45-497d-b628-2345e6c09b97" name="Global Random Sampling Result" type="Block"><loginhibit onsuccess="true" /><display x="-300" y="660" w="180" h="60" /><font family="Segoe UI" size="10" style="Regular" color="CC99FF" /></stage><stage stageid="5380890d-c761-4a23-8b89-b86262e5acd1" name="Set Manual Review to True" type="Calculation"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="-30" y="15" w="90" h="30" /><onsuccess>d7f2b506-2fc6-49f9-bd28-2f9d3c46340c</onsuccess><calculation expression="True" stage="Manual Review Required" /></stage><stage stageid="a6f84ba7-a8bd-4b41-980e-32463993a050" name="End4" type="End"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="-30" y="195" /></stage><stage stageid="6aac182e-44f2-42ad-9021-1fd5ae0fdc59" name="Set Manual Review to False" type="Calculation"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="75" y="150" w="90" h="30" /><onsuccess>7f50af95-dd3b-4335-b0a0-6d6b7375bfe2</onsuccess><calculation expression="False" stage="Manual Review Required" /></stage><stage stageid="7f50af95-dd3b-4335-b0a0-6d6b7375bfe2" name="Anchor8" type="Anchor"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="75" y="195" w="10" h="10" /><onsuccess>a6f84ba7-a8bd-4b41-980e-32463993a050</onsuccess></stage><stage stageid="eb15fe18-d64f-4ffc-a07b-90af38776ded" name="Manual Review?" type="Decision"><display x="120" y="330" w="90" h="30" /><decision expression="[Manual Review Required]" /><ontrue>5fe63bae-23eb-4645-92fc-45220651bca4</ontrue><onfalse>5d70865d-4657-4147-a57e-52d267aa7406</onfalse></stage><stage stageid="4dacfcdf-d936-4a4c-b66b-9057cffd0bb4" name="Defer Item for Manual Review" type="SubSheetInfo"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><narrative>Write out the excel files that need review, update the item status, and defer the item</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="5de429f4-b33e-4c34-a6e7-c8ee524d6036" name="Start" type="Start"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><display x="15" y="-120" /><onsuccess>bf0e8803-487a-4ce5-8270-67eadac536ed</onsuccess></stage><stage stageid="8f0985cb-d08c-42d9-9a58-a003f3756a9a" name="End" type="End"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><display x="15" y="885" /></stage><stage stageid="5fe63bae-23eb-4645-92fc-45220651bca4" name="Defer Item for Manual Review" type="SubSheet"><loginhibit onsuccess="true" /><display x="285" y="330" w="90" h="30" /><onsuccess>1cfde7f1-28bb-4c91-973d-915317f4f54e</onsuccess><processid>aef794a5-348a-4de6-9810-f7f57b96166b</processid></stage><stage stageid="1cfde7f1-28bb-4c91-973d-915317f4f54e" name="Anchor9" type="Anchor"><loginhibit onsuccess="true" /><display x="390" y="330" w="10" h="10" /><onsuccess>bef8f1ff-727a-4e0a-b29e-ed73fb6f0147</onsuccess></stage><stage stageid="fb425411-7539-409e-a0e3-5c3c5bc2bafe" name="Defer" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><narrative>Marks the item as deferred. It is unlocked, but it will not be made available for processing again until the specified time.

The attempts count for the item is reset to zero.</narrative><display x="15" y="750" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to defer" expr="[Item ID]" /><input type="datetime" name="Until" friendlyname="Until" narrative="When to resume processing the case" expr="Now() + MakeTimeSpan(0, 0, 5, 0)" /></inputs><onsuccess>b071d707-2613-4eb1-b5fc-de9a12ab0b29</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Defer" /></stage><stage stageid="9cf51c94-58fe-45ec-b14a-c50ba96985ef" name="Set Status" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><narrative>Updates the status field for the item. The status field can be used to flag what has been done in a process so far. If a process encounters an exception, this information can be used to skip to the parts of the process not yet done for the item next time it is worked. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.

This action will also reset the Attempts column to zero, because if the status updated the process should have successfully done something.</narrative><display x="15" y="705" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Status" narrative="The new status - 255 characters maximum." expr="&quot;Manual Review Required&quot;" /></inputs><onsuccess>fb425411-7539-409e-a0e3-5c3c5bc2bafe</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Update Status" /></stage><stage stageid="b071d707-2613-4eb1-b5fc-de9a12ab0b29" name="Reset Consecutive Exception Indicators" type="MultipleCalculation"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><display x="15" y="825" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8f0985cb-d08c-42d9-9a58-a003f3756a9a</onsuccess><steps><calculation expression="&quot;&quot;" stage="Previous Exception Detail" /><calculation expression="0" stage="Consecutive Exception Count" /></steps></stage><stage stageid="e5389da9-0767-440a-9800-4a3845529302" name="Check Status" type="ChoiceStart"><display x="-60" y="135" /><groupid>6c8a1f10-8152-42c6-91b3-264a1fe1781e</groupid><choices><choice expression="[Item Status] = &quot;&quot;"><name>Empty Status</name><distance>60</distance><ontrue>f52977fa-5395-47ee-a08b-35f92f89554c</ontrue></choice><choice expression="[Item Status] = &quot;Prediction Complete&quot;"><name>Prediction Complete</name><distance>150</distance><ontrue>731b1d6d-580d-4e96-9d99-20280f13ae57</ontrue></choice><choice expression="[Item Status] = &quot;Manual Review Required&quot;"><name>Manual Review Required</name><distance>195</distance><ontrue>83e93808-6085-487b-8367-5b2e09081fde</ontrue></choice><choice expression="[Item Status] = &quot;Manual Review Complete&quot;"><name>Manual Review Complete</name><distance>255</distance><ontrue>5d70865d-4657-4147-a57e-52d267aa7406</ontrue></choice></choices></stage><stage stageid="67152e54-cfe7-46a2-9e09-ecd2c66418fa" name="Otherwise1" type="ChoiceEnd"><display x="-60" y="450" /><onsuccess>3cfd9db1-a593-4215-b1e1-9d0708a939e5</onsuccess><groupid>6c8a1f10-8152-42c6-91b3-264a1fe1781e</groupid></stage><stage stageid="b2882ef7-4b96-44fe-974c-0c0833e543bc" name="Anchor10" type="Anchor"><loginhibit onsuccess="true" /><display x="120" y="135" w="10" h="10" /><onsuccess>e5389da9-0767-440a-9800-4a3845529302</onsuccess></stage><stage stageid="4d1c5743-1440-4ff5-b9ac-35ba877c5386" name="Set Status" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><narrative>Updates the status field for the item. The status field can be used to flag what has been done in a process so far. If a process encounters an exception, this information can be used to skip to the parts of the process not yet done for the item next time it is worked. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.

This action will also reset the Attempts column to zero, because if the status updated the process should have successfully done something.</narrative><display x="15" y="690" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Status" narrative="The new status - 255 characters maximum." expr="&quot;Prediction Complete&quot;" /></inputs><onsuccess>2abe76be-3b9e-4c3d-8d5c-c92b3ebc8039</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Update Status" /></stage><stage stageid="a066446b-56bd-467c-b27e-dd72348d74cb" name="Add Confidence Score to Item Data" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="555" w="90" h="30" /><inputs><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Item Data]" /><input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;Confidence Score&quot;" /><input type="number" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="[Confidence Score]" /></inputs><outputs><output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Item Data" /></outputs><onsuccess>8bc2527a-e555-4a10-8dfa-0615973102d3</onsuccess><resource object="Utility - Collection Manipulation" action="Append Field (Number)" /></stage><stage stageid="8bc2527a-e555-4a10-8dfa-0615973102d3" name="Add Label to Item Data" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="600" w="90" h="30" /><inputs><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Item Data]" /><input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;Label&quot;" /><input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="[Label]" /></inputs><outputs><output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Item Data" /></outputs><onsuccess>edf53ff3-9fb9-4989-88d2-37fff87a36bb</onsuccess><resource object="Utility - Collection Manipulation" action="Append Field (Text)" /></stage><stage stageid="edf53ff3-9fb9-4989-88d2-37fff87a36bb" name="Work Queues::Set Data" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><narrative>Sets the data on the specified item to the given value. 
The collection must contain one row exactly, and the key field, if present, must match the key field of the item being updated.
Also, the item must currently be locked by the current session - ie. it must have been retrieved using the 'Get Next' action.</narrative><display x="15" y="645" w="90" h="30" /><inputs><input type="collection" name="Data" friendlyname="Data" narrative="A collection with one row containing the data to be set on the item. If the item has a key value and this collection has a key value, they should match exactly." expr="[Item Data]" /><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the work item to set the data on. This item should be locked by the calling session." expr="[Item ID]" /></inputs><onsuccess>4d1c5743-1440-4ff5-b9ac-35ba877c5386</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Set Data" /></stage><stage stageid="83e93808-6085-487b-8367-5b2e09081fde" name="Set Manual Review to True" type="Calculation"><loginhibit onsuccess="true" /><display x="0" y="330" /><onsuccess>eb15fe18-d64f-4ffc-a07b-90af38776ded</onsuccess><calculation expression="True" stage="Manual Review Required" /></stage><stage stageid="3cfd9db1-a593-4215-b1e1-9d0708a939e5" name="SE - Unknown Item Status" type="Exception"><display x="120" y="450" /><exception localized="yes" type="System Exception" detail="&quot;SE - Unknown Item Status&quot;" /></stage><stage stageid="f4a84d64-8865-4e4c-a00f-7319f1263e82" name="Ch5 Example 3 To Review Folder Path" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="390" w="150" h="30" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="2b902881-f99f-435c-ae3d-5621d119e53c" name="Ch5 Example 3 Completed Review Folder Path" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="420" w="150" h="30" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="610d38a3-618a-4005-a0df-ea0864561a3d" name="Standard Error" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="-180" y="120" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a9e17291-3f10-4898-9a10-be3bbf3e97b5" name="Random Number" type="Block"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-255" y="90" w="150" h="270" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="280a89cd-7bfd-464b-ae5f-3266b780caf3" name="Utility - Environment::Start Process Read Stderr and Stdout" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="105" w="120" h="30" /><inputs><input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments that coincide with the process." expr="&quot;Get-Random -Minimum 18 -Maximum 100&quot;" /><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to start." expr="&quot;powershell.exe&quot;" /></inputs><outputs><output type="text" name="Standard Output" friendlyname="Standard Output" stage="age" /><output type="text" name="Standard Error" friendlyname="Standard Error" stage="Standard Error" /></outputs><onsuccess>6556dec4-0d5f-4b65-95ac-d26bd9d6a678</onsuccess><resource object="Utility - Environment" action="Start Process Read Stderr and Stdout" /></stage><stage stageid="6be513d0-ce24-4e64-9795-461d39a8fb75" name="Customers to Generate" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="435" w="120" h="30" /><datatype>number</datatype><initialvalue>30</initialvalue><private /><alwaysinit /></stage><stage stageid="9e9622b0-6c96-421f-afb9-5d1e9e44ad9d" name="Count" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="465" w="120" h="30" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="b2b301fb-9a48-4052-8b93-4c9e44358621" name="Continue Generating Customers?" type="Decision"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="30" y="60" w="90" h="30" /><decision expression="[Count] &lt; [Customers to Generate]" /><ontrue>280a89cd-7bfd-464b-ae5f-3266b780caf3</ontrue><onfalse>83203064-35b8-4dac-93e3-6d5f9a2e6100</onfalse></stage><stage stageid="34f693a4-f763-429a-9aaf-cd470f46c18d" name="age" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="150" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="dd13f36a-be2f-4e94-9439-3e11dbdaf045" name="job_id" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="180" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0192aa35-c409-4a38-9197-e3dfde8b0eef" name="salary_range_id" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="210" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ff74c11f-6e3c-4a89-9953-5eba6cee5ae0" name="days_last_purchase" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="240" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="10fc0193-9c48-471c-a7e6-0f7f277571e2" name="avg_purchase_size" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="270" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="cb22e21f-6878-4093-83ea-02a55bae3238" name="rewards_club_points" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="300" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="37c7fdc6-1d48-45c5-bfa3-03a138dbe4a8" name="gender" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="330" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="62571d0f-3830-4e36-9008-37b5aa73a429" name="customer_id" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="390" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="172d4798-cbe0-4e3d-b157-9f329487cc79" name="Utility - Strings::Generate New GUID" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="420" w="120" h="30" /><outputs><output type="text" name="GUID" friendlyname="GUID" narrative="The new guid" stage="customer_id" /></outputs><onsuccess>053fb854-372a-4779-880c-e854a64c1621</onsuccess><resource object="Utility - Strings" action="Generate New GUID" /></stage><stage stageid="6556dec4-0d5f-4b65-95ac-d26bd9d6a678" name="Utility - Environment::Start Process Read Stderr and Stdout" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="150" w="120" h="30" /><inputs><input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments that coincide with the process." expr="&quot;Get-Random -Minimum 1 -Maximum 10&quot;" /><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to start." expr="&quot;powershell.exe&quot;" /></inputs><outputs><output type="text" name="Standard Output" friendlyname="Standard Output" stage="job_id" /><output type="text" name="Standard Error" friendlyname="Standard Error" stage="Standard Error" /></outputs><onsuccess>8a3e3068-ce13-4768-972d-27f17f6e612e</onsuccess><resource object="Utility - Environment" action="Start Process Read Stderr and Stdout" /></stage><stage stageid="8a3e3068-ce13-4768-972d-27f17f6e612e" name="Utility - Environment::Start Process Read Stderr and Stdout" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="195" w="120" h="30" /><inputs><input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments that coincide with the process." expr="&quot;Get-Random -Minimum 1 -Maximum 10&quot;" /><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to start." expr="&quot;powershell.exe&quot;" /></inputs><outputs><output type="text" name="Standard Output" friendlyname="Standard Output" stage="salary_range_id" /><output type="text" name="Standard Error" friendlyname="Standard Error" stage="Standard Error" /></outputs><onsuccess>754dd988-5b19-49ff-95c4-0bda0e181ccd</onsuccess><resource object="Utility - Environment" action="Start Process Read Stderr and Stdout" /></stage><stage stageid="754dd988-5b19-49ff-95c4-0bda0e181ccd" name="Utility - Environment::Start Process Read Stderr and Stdout" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="240" w="120" h="30" /><inputs><input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments that coincide with the process." expr="&quot;Get-Random -Minimum 0 -Maximum 1000&quot;" /><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to start." expr="&quot;powershell.exe&quot;" /></inputs><outputs><output type="text" name="Standard Output" friendlyname="Standard Output" stage="days_last_purchase" /><output type="text" name="Standard Error" friendlyname="Standard Error" stage="Standard Error" /></outputs><onsuccess>be2e5c5f-ca18-4bb0-bb15-3d5087ba0217</onsuccess><resource object="Utility - Environment" action="Start Process Read Stderr and Stdout" /></stage><stage stageid="be2e5c5f-ca18-4bb0-bb15-3d5087ba0217" name="Utility - Environment::Start Process Read Stderr and Stdout" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="285" w="120" h="30" /><inputs><input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments that coincide with the process." expr="&quot;Get-Random -Minimum 0.0 -Maximum 1000.0&quot;" /><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to start." expr="&quot;powershell.exe&quot;" /></inputs><outputs><output type="text" name="Standard Output" friendlyname="Standard Output" stage="avg_purchase_size" /><output type="text" name="Standard Error" friendlyname="Standard Error" stage="Standard Error" /></outputs><onsuccess>f5e2f8e3-6f42-4d18-b021-adb265615027</onsuccess><resource object="Utility - Environment" action="Start Process Read Stderr and Stdout" /></stage><stage stageid="f5e2f8e3-6f42-4d18-b021-adb265615027" name="Utility - Environment::Start Process Read Stderr and Stdout" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="330" w="120" h="30" /><inputs><input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments that coincide with the process." expr="&quot;Get-Random -Minimum 0 -Maximum 100000&quot;" /><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to start." expr="&quot;powershell.exe&quot;" /></inputs><outputs><output type="text" name="Standard Output" friendlyname="Standard Output" stage="rewards_club_points" /><output type="text" name="Standard Error" friendlyname="Standard Error" stage="Standard Error" /></outputs><onsuccess>e6b2a7b3-bfe1-457b-9efd-01c47012ff35</onsuccess><resource object="Utility - Environment" action="Start Process Read Stderr and Stdout" /></stage><stage stageid="e6b2a7b3-bfe1-457b-9efd-01c47012ff35" name="Utility - Environment::Start Process Read Stderr and Stdout" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="375" w="120" h="30" /><inputs><input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments that coincide with the process." expr="&quot;Get-Random -Minimum 0 -Maximum 1&quot;" /><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to start." expr="&quot;powershell.exe&quot;" /></inputs><outputs><output type="text" name="Standard Output" friendlyname="Standard Output" stage="gender" /><output type="text" name="Standard Error" friendlyname="Standard Error" stage="Standard Error" /></outputs><onsuccess>172d4798-cbe0-4e3d-b157-9f329487cc79</onsuccess><resource object="Utility - Environment" action="Start Process Read Stderr and Stdout" /></stage><stage stageid="053fb854-372a-4779-880c-e854a64c1621" name="Collections::Add Row" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="465" w="120" h="30" /><inputs><input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;All Customer Data&quot;" /></inputs><onsuccess>f26d765d-ee3b-42a6-9048-bf4e5db28e02</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" /></stage><stage stageid="f26d765d-ee3b-42a6-9048-bf4e5db28e02" name="Set Customer Data" type="MultipleCalculation"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="510" w="90" h="30" /><onsuccess>29e4fb6c-ed0b-4ded-a581-1355565291cf</onsuccess><steps><calculation expression="ToNumber([age])" stage="All Customer Data.age" /><calculation expression="ToNumber([avg_purchase_size])" stage="All Customer Data.avg_purchase_size" /><calculation expression="Left([customer_id], 7)" stage="All Customer Data.customer_id" /><calculation expression="ToNumber([days_last_purchase])" stage="All Customer Data.days_last_purchase" /><calculation expression="ToNumber([gender])" stage="All Customer Data.gender" /><calculation expression="ToNumber([job_id])" stage="All Customer Data.job_id" /><calculation expression="ToNumber([rewards_club_points])" stage="All Customer Data.rewards_club_points" /><calculation expression="ToNumber([salary_range_id])" stage="All Customer Data.salary_range_id" /></steps></stage><stage stageid="29e4fb6c-ed0b-4ded-a581-1355565291cf" name="Increment Count" type="Calculation"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="555" /><onsuccess>65cf6e76-0ebe-4993-875d-8985e0452260</onsuccess><calculation expression="[Count]+1" stage="Count" /></stage><stage stageid="65cf6e76-0ebe-4993-875d-8985e0452260" name="Anchor11" type="Anchor"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-60" y="555" w="10" h="10" /><onsuccess>ebaae007-1b85-4df9-9a30-ccefa2be725b</onsuccess></stage><stage stageid="ebaae007-1b85-4df9-9a30-ccefa2be725b" name="Anchor12" type="Anchor"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-60" y="60" w="10" h="10" /><onsuccess>b2b301fb-9a48-4052-8b93-4c9e44358621</onsuccess></stage><stage stageid="35b56903-2b8b-4935-9a7e-1b35a712cc53" name="Success?" type="Decision"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="15" y="525" w="90" h="30" /><decision expression="[Success]" /><ontrue>454a6c89-f65f-4697-9b94-85569a625992</ontrue><onfalse>b8e82045-9ae6-4470-b2e2-b3fcfefb6dba</onfalse></stage><stage stageid="b8e82045-9ae6-4470-b2e2-b3fcfefb6dba" name="SE - To Review Folder does not exist" type="Exception"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="165" y="525" w="90" h="30" /><exception localized="yes" type="System Exception" detail="&quot;SE - To Review Folder does not exist: &quot; &amp; [Ch5 Example 3 To Review Folder Path]" /></stage><stage stageid="5e1ba49e-c205-4215-ae0f-6a7c63a2d240" name="SE - Completed Review Folder does not exist" type="Exception"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="165" y="435" w="90" h="30" /><exception localized="yes" type="System Exception" detail="&quot;SE - Completed Review Folder does not exist: &quot; &amp; [Ch5 Example 3 Completed Review Folder Path]" /></stage><stage stageid="24039d62-c2f9-4175-b140-16308c25f311" name="Create Completed Review Folder" type="Action"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="390" w="90" h="30" /><inputs><input type="text" name="Directory Path" friendlyname="Directory Path" narrative="The path in which to create the directory" expr="[Ch5 Example 3 Completed Review Folder Path]" /><input type="flag" name="Error If Already Exists" friendlyname="Error If Already Exists" narrative="True to generate an error if the directory already exists" expr="False" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>cdd49fcb-4079-4b15-9e26-0baf3fedefc3</onsuccess><resource object="Utility - File Management" action="Create Directory" /></stage><stage stageid="cdd49fcb-4079-4b15-9e26-0baf3fedefc3" name="Success?" type="Decision"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="15" y="435" w="90" h="30" /><decision expression="[Success]" /><ontrue>42a8b679-94d6-4dbb-870e-e78d92c65006</ontrue><onfalse>5e1ba49e-c205-4215-ae0f-6a7c63a2d240</onfalse></stage><stage stageid="42a8b679-94d6-4dbb-870e-e78d92c65006" name="Create To Review Folder" type="Action"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="480" w="90" h="30" /><inputs><input type="text" name="Directory Path" friendlyname="Directory Path" narrative="The path in which to create the directory" expr="[Ch5 Example 3 To Review Folder Path]" /><input type="flag" name="Error If Already Exists" friendlyname="Error If Already Exists" narrative="True to generate an error if the directory already exists" expr="False" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>35b56903-2b8b-4935-9a7e-1b35a712cc53</onsuccess><resource object="Utility - File Management" action="Create Directory" /></stage><stage stageid="30a66f60-d072-443c-928b-10d0fd418740" name="Current Batch Count" type="Data"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="0" w="120" h="30" /><datatype>number</datatype><initialvalue>0</initialvalue><private /></stage><stage stageid="18eef906-b41a-4a97-82d7-87062725c20d" name="Increment Batch Count" type="Calculation"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="15" y="405" w="90" h="30" /><onsuccess>0ebee812-85fa-4789-ac78-43c5f2999373</onsuccess><calculation expression="[Current Batch Count]+1" stage="Current Batch Count" /></stage><stage stageid="a33b5c92-f1d0-41cb-bbe2-c2d2eff83621" name="MS Excel VBO::Create Instance" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="30" w="90" h="30" /><inputs><input type="flag" name="Enable Events" friendlyname="Enable Events" narrative="Flag to indicate that events should be enabled / disabled on the attached instance - defaulted to True" expr="" /></inputs><outputs><output type="number" name="handle" friendlyname="handle" narrative="An integer which can be used to identify the created instance in subsequent actions" stage="handle" /></outputs><onsuccess>ddf43c6b-5efc-4643-a8c6-85c120afde2d</onsuccess><resource object="MS Excel VBO" action="Create Instance" /></stage><stage stageid="64bf0ad8-9aa0-4c67-821d-421813a4b274" name="handle" type="Data"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><display x="-195" y="165" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2a208ca0-cf1e-416b-be71-4352eb5a3d98" name="MS Excel VBO::Open Workbook" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="75" y="75" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the required workbook should be opened. The default of zero indicates the currently active instance." expr="[handle]" /><input type="text" name="File name" friendlyname="File name" narrative="The path and name of the file which should be opened." expr="[Ch5 Example 3 Temporary Review Folder Path] &amp; &quot;\&quot; &amp; [Excel File Name]" /></inputs><outputs><output type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name used by Excel to identify the workbook - usually this is the file name (without the path)." stage="Workbook Name" /></outputs><onsuccess>9e6b648a-3e97-499b-a35c-cb27041f7e46</onsuccess><resource object="MS Excel VBO" action="Open Workbook" /></stage><stage stageid="f27a08df-5e23-4c31-ad4d-e824d1631713" name="Excel File Name" type="Data"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="30" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /></stage><stage stageid="0ebee812-85fa-4789-ac78-43c5f2999373" name="Start New Batch?" type="Decision"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><display x="15" y="450" w="90" h="30" /><decision expression="[Current Batch Count] = [Ch5 Example 3 Review Batch Size]" /><ontrue>3d4a405a-b3de-4918-9c56-c018aa0ba9c5</ontrue><onfalse>6e764822-dcfb-49f7-9e31-73c2594efb57</onfalse></stage><stage stageid="1705e43c-6b6d-411e-8899-02bc26003d50" name="Set Excel Filename" type="Calculation"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="-15" w="90" h="30" /><onsuccess>a33b5c92-f1d0-41cb-bbe2-c2d2eff83621</onsuccess><calculation expression="&quot;review_&quot; &amp; GetResourceName() &amp; &quot;_&quot; &amp; FormatDateTime(Now(), &quot;yyyy_MM_dd_HHmmss&quot;) &amp; &quot;.xlsx&quot;" stage="Excel File Name" /></stage><stage stageid="bf0e8803-487a-4ce5-8270-67eadac536ed" name="Create new Excel File?" type="Decision"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><display x="15" y="-60" w="90" h="30" /><decision expression="[Current Batch Count] = 0" /><ontrue>1705e43c-6b6d-411e-8899-02bc26003d50</ontrue><onfalse>70ae3f94-33b8-4e06-a4f9-4a9189d8c3a7</onfalse></stage><stage stageid="5b80dda0-2e5a-4585-bc8d-dde916b8263d" name="MS Excel VBO::Write Collection" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="255" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the specified collection should be written. The default of zero indicates the currently active instance." expr="[handle]" /><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection containing the data which should be written to the worksheet." expr="[Row]" /><input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook within which the data should be written. The default empty value indicates the current workbook within the specified instance." expr="[Workbook Name]" /><input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the worksheet on which the given data should be written. The default empty value indicates the current sheet within the specified workbook." expr="" /><input type="text" name="Cell Reference" friendlyname="Cell Reference" narrative="The reference at which the collection should be written." expr="&quot;A1&quot;" /><input type="flag" name="Include Column Names" friendlyname="Include Column Names" narrative="True to indicate that the column names from the collection should be written out as the first row; False to ignore the column names and just write out the data." expr="True" /></inputs><onsuccess>ac900cb4-d407-4781-8cfa-e48fdf8a3277</onsuccess><resource object="MS Excel VBO" action="Write Collection" /></stage><stage stageid="ddf43c6b-5efc-4643-a8c6-85c120afde2d" name="MS Excel VBO::Create Workbook" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="75" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the workbook should be created. The default of zero indicates the currently active instance." expr="[handle]" /></inputs><outputs><output type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook that Excel has created - this can be changed using the &quot;Save Workbook As&quot; action" stage="Workbook Name" /></outputs><onsuccess>454adb86-e484-4e50-98d4-7b140553a973</onsuccess><resource object="MS Excel VBO" action="Create Workbook" /></stage><stage stageid="f455f9ce-33e2-48d7-862d-54a114296769" name="Workbook Name" type="Data"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><display x="-195" y="195" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="454adb86-e484-4e50-98d4-7b140553a973" name="Set Collection" type="MultipleCalculation"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="210" w="90" h="30" /><onsuccess>5b80dda0-2e5a-4585-bc8d-dde916b8263d</onsuccess><steps><calculation expression="[Item ID]" stage="Row.Item ID" /><calculation expression="[Item Data.age]" stage="Row.age" /><calculation expression="[Item Data.avg_purchase_size]" stage="Row.avg_purchase_size" /><calculation expression="[Item Data.customer_id]" stage="Row.customer_id" /><calculation expression="[Item Data.days_last_purchase]" stage="Row.days_last_purchase" /><calculation expression="[Item Data.gender]" stage="Row.gender" /><calculation expression="[Item Data.job_id]" stage="Row.job_id" /><calculation expression="[Item Data.rewards_club_points]" stage="Row.rewards_club_points" /><calculation expression="[Item Data.salary_range_id]" stage="Row.salary_range_id" /><calculation expression="[Item Data.Label]" stage="Row.label" /></steps></stage><stage stageid="9daa7f45-be21-49a7-b45c-90b5395493b9" name="Row" type="Collection"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><display x="-195" y="135" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><singlerow /><field name="age" type="text" /><field name="job_id" type="text" /><field name="salary_range_id" type="text" /><field name="days_last_purchase" type="text" /><field name="avg_purchase_size" type="text" /><field name="rewards_club_points" type="text" /><field name="gender" type="text" /><field name="customer_id" type="text" /><field name="label" type="text" /><field name="Item ID" type="text" /></collectioninfo><initialvalue><singlerow /><row><field name="age" type="text" value="" /><field name="job_id" type="text" value="" /><field name="salary_range_id" type="text" value="" /><field name="days_last_purchase" type="text" value="" /><field name="avg_purchase_size" type="text" value="" /><field name="rewards_club_points" type="text" value="" /><field name="gender" type="text" value="" /><field name="customer_id" type="text" value="" /><field name="label" type="text" value="" /><field name="Item ID" type="text" value="" /></row></initialvalue></stage><stage stageid="ac900cb4-d407-4781-8cfa-e48fdf8a3277" name="MS Excel VBO::Save Current Workbook As" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="15" y="300" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance for which the current workbook which should be saved. The default of zero indicates the currently active instance." expr="[handle]" /><input type="text" name="File name" friendlyname="File name" narrative="The full path and file name to which the current workbook should be saved." expr="[Ch5 Example 3 Temporary Review Folder Path] &amp; &quot;\&quot; &amp; [Excel File Name]" /></inputs><outputs><output type="text" name="New Workbook Name" friendlyname="New Workbook Name" narrative="The new workbook name which Excel will use to identify the workbook." stage="" /></outputs><onsuccess>003b022a-7b05-46e3-b1af-d3fe58759f10</onsuccess><resource object="MS Excel VBO" action="Save Current Workbook As" /></stage><stage stageid="003b022a-7b05-46e3-b1af-d3fe58759f10" name="MS Excel VBO::Close Instance" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="15" y="345" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance to be closed. Zero indicates the currently active instance." expr="[handle]" /><input type="flag" name="Save Changes" friendlyname="Save Changes" narrative="True to save the changes to the open workbooks on the instance, False to discard any changes. Default is False." expr="" /></inputs><onsuccess>18eef906-b41a-4a97-82d7-87062725c20d</onsuccess><resource object="MS Excel VBO" action="Close Instance" /></stage><stage stageid="70ae3f94-33b8-4e06-a4f9-4a9189d8c3a7" name="MS Excel VBO::Create Instance" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="75" y="30" w="90" h="30" /><inputs><input type="flag" name="Enable Events" friendlyname="Enable Events" narrative="Flag to indicate that events should be enabled / disabled on the attached instance - defaulted to True" expr="" /></inputs><outputs><output type="number" name="handle" friendlyname="handle" narrative="An integer which can be used to identify the created instance in subsequent actions" stage="handle" /></outputs><onsuccess>2a208ca0-cf1e-416b-be71-4352eb5a3d98</onsuccess><resource object="MS Excel VBO" action="Create Instance" /></stage><stage stageid="9e6b648a-3e97-499b-a35c-cb27041f7e46" name="MS Excel VBO::Get Worksheet As Collection" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="75" y="120" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the worksheet which should be retrieved resides. The default of zero indicates the currently active instance." expr="[handle]" /><input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook which contains the sheet required. The default empty text indicates the currently active workbook on the specified instance." expr="[Workbook Name]" /><input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the worksheet within the specified workbook which should be written to a collection. The default empty text indicates the currently active worksheet within the specified workbook." expr="" /><input type="text" name="Fetch Data With Method" friendlyname="Fetch Data With Method" narrative="The method used to fetch data from cells in the worksheet. Options include Text, Value, and Value2. The default indicates Value will be used." expr="" /></inputs><outputs><output type="collection" name="Data" friendlyname="Data" narrative="The collection containing the data from the specified worksheet - the column IDs will be gleaned from the first row on the sheet being retrieved." stage="Data" /></outputs><onsuccess>a7edbd75-6b85-4806-b8ff-d2490db17216</onsuccess><resource object="MS Excel VBO" action="Get Worksheet As Collection" /></stage><stage stageid="a7edbd75-6b85-4806-b8ff-d2490db17216" name="Collections::Add Row" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="75" y="165" w="90" h="30" /><inputs><input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Data&quot;" /></inputs><onsuccess>aa542821-d128-4530-805b-0c053d3da4e7</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" /></stage><stage stageid="835941b8-9319-46e6-9e83-1810575e13ea" name="Data" type="Collection"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><display x="-195" y="225" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="aa542821-d128-4530-805b-0c053d3da4e7" name="Set Collection" type="MultipleCalculation"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="75" y="210" w="90" h="30" /><onsuccess>482a7d2b-22af-4a0c-b8b7-d5afa05df7e5</onsuccess><steps><calculation expression="[Item ID]" stage="Data.Item ID" /><calculation expression="[Item Data.age]" stage="Data.age" /><calculation expression="[Item Data.avg_purchase_size]" stage="Data.avg_purchase_size" /><calculation expression="[Item Data.customer_id]" stage="Data.customer_id" /><calculation expression="[Item Data.days_last_purchase]" stage="Data.days_last_purchase" /><calculation expression="[Item Data.gender]" stage="Data.gender" /><calculation expression="[Item Data.job_id]" stage="Data.job_id" /><calculation expression="[Item Data.rewards_club_points]" stage="Data.rewards_club_points" /><calculation expression="[Item Data.salary_range_id]" stage="Data.salary_range_id" /><calculation expression="[Item Data.Label]" stage="Data.label" /></steps></stage><stage stageid="482a7d2b-22af-4a0c-b8b7-d5afa05df7e5" name="MS Excel VBO::Write Collection" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="75" y="255" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the specified collection should be written. The default of zero indicates the currently active instance." expr="[handle]" /><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection containing the data which should be written to the worksheet." expr="[Data]" /><input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook within which the data should be written. The default empty value indicates the current workbook within the specified instance." expr="[Workbook Name]" /><input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the worksheet on which the given data should be written. The default empty value indicates the current sheet within the specified workbook." expr="" /><input type="text" name="Cell Reference" friendlyname="Cell Reference" narrative="The reference at which the collection should be written." expr="&quot;A1&quot;" /><input type="flag" name="Include Column Names" friendlyname="Include Column Names" narrative="True to indicate that the column names from the collection should be written out as the first row; False to ignore the column names and just write out the data." expr="True" /></inputs><onsuccess>ac900cb4-d407-4781-8cfa-e48fdf8a3277</onsuccess><resource object="MS Excel VBO" action="Write Collection" /></stage><stage stageid="3d4a405a-b3de-4918-9c56-c018aa0ba9c5" name="Reset Batch Count" type="Calculation"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="15" y="495" w="90" h="30" /><onsuccess>97e3d50e-a9a2-40bf-91b3-67388983ef09</onsuccess><calculation expression="0" stage="Current Batch Count" /></stage><stage stageid="6e764822-dcfb-49f7-9e31-73c2594efb57" name="Anchor13" type="Anchor"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="-60" y="450" w="10" h="10" /><onsuccess>5b9dde4f-399f-4daf-8e64-5fefde168149</onsuccess></stage><stage stageid="5b9dde4f-399f-4daf-8e64-5fefde168149" name="Anchor14" type="Anchor"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="-60" y="705" w="10" h="10" /><onsuccess>9cf51c94-58fe-45ec-b14a-c50ba96985ef</onsuccess></stage><stage stageid="2e37fd40-aa3a-47a0-ba67-caabbc6ac40d" name="Check for Reviewed Predictions" type="SubSheetInfo"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><narrative>Here we update the status of the Work Queue Items that have already been reviewed so that they can continue processing.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="e4cd300b-a6f9-4731-9d89-5822e0ed4f5c" name="Start" type="Start"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="15" y="-195" /><onsuccess>95845bb0-d197-47e3-8bba-868053a5e138</onsuccess></stage><stage stageid="9343b14e-0229-4bcb-ace5-135abe03c4e6" name="End" type="End"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="15" y="1050" /></stage><stage stageid="95845bb0-d197-47e3-8bba-868053a5e138" name="Utility - File Management::Get Files" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-150" w="90" h="30" /><inputs><input type="text" name="Folder" friendlyname="Folder" narrative="The folder in which to look for files" expr="[Ch5 Example 3 Completed Review Folder Path]" /><input type="text" name="Patterns CSV" friendlyname="Patterns CSV" narrative="The comma seperated list of wildcard patterns" expr="&quot;*.xlsx&quot;" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="A message if unsuccessful" stage="Message" /><output type="collection" name="Files" friendlyname="Files" narrative="The collection of files found" stage="Files" /></outputs><onsuccess>97cba157-61e1-45c0-ad1f-e54940a049f5</onsuccess><resource object="Utility - File Management" action="Get Files" /></stage><stage stageid="6f0595d6-0e6b-4628-9db9-fb463856e4e5" name="Success" type="Data"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="-195" y="105" w="150" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a5a8f102-7b64-40e2-8970-ce8f8870b08e" name="Message" type="Data"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="-195" y="135" w="150" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e8005ae9-f0ad-40b8-8479-8693487ca717" name="Files" type="Collection"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="-195" y="75" w="150" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="97cba157-61e1-45c0-ad1f-e54940a049f5" name="Loop Files" type="LoopStart"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-105" w="120" h="30" /><onsuccess>648c209d-7b8a-4033-a787-04a8567df901</onsuccess><groupid>1a57f3b0-8341-4de7-a9c1-b36820407f49</groupid><looptype>ForEach</looptype><loopdata>Files</loopdata></stage><stage stageid="ba1dc0bb-6651-4a41-b646-b6138098ac39" name="Loop Files" type="LoopEnd"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="15" y="990" w="120" h="30" /><onsuccess>9343b14e-0229-4bcb-ace5-135abe03c4e6</onsuccess><groupid>1a57f3b0-8341-4de7-a9c1-b36820407f49</groupid></stage><stage stageid="ba328fc6-96c6-46e0-9138-8c0c939e8660" name="MS Excel VBO::Open Workbook" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the required workbook should be opened. The default of zero indicates the currently active instance." expr="[handle]" /><input type="text" name="File name" friendlyname="File name" narrative="The path and name of the file which should be opened." expr="[Files.Path]" /></inputs><outputs><output type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name used by Excel to identify the workbook - usually this is the file name (without the path)." stage="Workbook Name" /></outputs><onsuccess>2eb15a4d-a159-48ed-96d0-24029110dc7c</onsuccess><resource object="MS Excel VBO" action="Open Workbook" /></stage><stage stageid="852db67b-ab8e-4553-b00e-1d631276ce77" name="MS Excel VBO::Create Instance" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="15" y="30" w="90" h="30" /><inputs><input type="flag" name="Enable Events" friendlyname="Enable Events" narrative="Flag to indicate that events should be enabled / disabled on the attached instance - defaulted to True" expr="" /></inputs><outputs><output type="number" name="handle" friendlyname="handle" narrative="An integer which can be used to identify the created instance in subsequent actions" stage="handle" /></outputs><onsuccess>ba328fc6-96c6-46e0-9138-8c0c939e8660</onsuccess><resource object="MS Excel VBO" action="Create Instance" /></stage><stage stageid="2eb15a4d-a159-48ed-96d0-24029110dc7c" name="MS Excel VBO::Get Worksheet As Collection" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="15" y="120" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the worksheet which should be retrieved resides. The default of zero indicates the currently active instance." expr="[handle]" /><input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook which contains the sheet required. The default empty text indicates the currently active workbook on the specified instance." expr="[Workbook Name]" /><input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the worksheet within the specified workbook which should be written to a collection. The default empty text indicates the currently active worksheet within the specified workbook." expr="" /><input type="text" name="Fetch Data With Method" friendlyname="Fetch Data With Method" narrative="The method used to fetch data from cells in the worksheet. Options include Text, Value, and Value2. The default indicates Value will be used." expr="" /></inputs><outputs><output type="collection" name="Data" friendlyname="Data" narrative="The collection containing the data from the specified worksheet - the column IDs will be gleaned from the first row on the sheet being retrieved." stage="Data" /></outputs><onsuccess>3f4a3acc-0da8-46c5-933d-c9646e35b8a8</onsuccess><resource object="MS Excel VBO" action="Get Worksheet As Collection" /></stage><stage stageid="5f6aaa5d-98c4-4b07-9b95-3a0711ce1d72" name="handle" type="Data"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="105" y="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e88f8bba-2d65-4015-a414-89ec4791298f" name="Workbook Name" type="Data"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="105" y="75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b80edfa7-a2cc-4897-88ea-9deee38d556d" name="Data" type="Collection"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="105" y="120" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="64ed70c9-6fc2-4e87-b5dc-bf1fce9a3fb7" name="Loop Data" type="LoopStart"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="15" y="270" /><onsuccess>9615a543-d62b-4878-bbc3-72eb07fe9ea9</onsuccess><groupid>5793e07b-9861-4acf-805c-eb19f0a8cdcf</groupid><looptype>ForEach</looptype><loopdata>Data</loopdata></stage><stage stageid="391ff9cc-782c-47ff-9d8b-a3d3d7ec6054" name="Loop Data" type="LoopEnd"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="15" y="525" /><onsuccess>b26072bd-dd2e-44a4-bcd8-b19856e1ded3</onsuccess><groupid>5793e07b-9861-4acf-805c-eb19f0a8cdcf</groupid></stage><stage stageid="5050f270-9d5e-493b-a15a-93ec7e7bbc07" name="Work Queues::Update Status" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><narrative>Updates the status field for the item. The status field can be used to flag what has been done in a process so far. If a process encounters an exception, this information can be used to skip to the parts of the process not yet done for the item next time it is worked. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.

This action will also reset the Attempts column to zero, because if the status updated the process should have successfully done something.</narrative><display x="15" y="435" w="90" h="30" /><inputs><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to mark" expr="[Data.Item ID]" /><input type="text" name="Status" friendlyname="Status" narrative="The new status - 255 characters maximum." expr="&quot;Manual Review Complete&quot;" /></inputs><onsuccess>f2efad60-5159-43fb-b085-268c18d4313f</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Update Status" /></stage><stage stageid="c8af4392-5cc7-4181-acc6-f2cba890aa5e" name="Ch5 Example 3 Temporary Review Folder Path" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="450" w="150" h="30" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="2c1b9838-a5ce-48c9-a40b-d632fb16c8dc" name="Note10" type="Note"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><narrative>Move to temp folder, preferably inaccessible to reviewer</narrative><display x="-195" y="300" w="120" h="60" /><onsuccess>ac900cb4-d407-4781-8cfa-e48fdf8a3277</onsuccess></stage><stage stageid="97e3d50e-a9a2-40bf-91b3-67388983ef09" name="Utility - File Management::Move File" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="15" y="540" w="90" h="30" /><inputs><input type="text" name="File Path" friendlyname="File Path" narrative="The full path to the file to move" expr="[Ch5 Example 3 Temporary Review Folder Path] &amp; &quot;\&quot; &amp; [Excel File Name]" /><input type="text" name="Destination Path" friendlyname="Destination Path" narrative="The path to the folder to move the file to" expr="[Ch5 Example 3 To Review Folder Path] &amp; &quot;\&quot; &amp; [Excel File Name]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>0584166a-5b82-47ee-ae36-4ff4c7dbad01</onsuccess><resource object="Utility - File Management" action="Move File" /></stage><stage stageid="7faa2a32-7531-4284-afa6-a55c8a6b8bb8" name="Success" type="Data"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><display x="240" y="540" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3261aaa7-206b-41c4-a706-1277efff8427" name="Message" type="Data"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><display x="300" y="540" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4616dd94-db34-4901-901e-64bc391ceb0f" name="Note11" type="Note"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><narrative>Move from the Temporary path to the Path accessible by the reviewer</narrative><display x="135" y="540" w="90" h="60" /><onsuccess>97e3d50e-a9a2-40bf-91b3-67388983ef09</onsuccess></stage><stage stageid="b0567de3-e9a2-4b37-aeab-970359b96187" name="Ch5 Example 3 Review Batch Size" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="345" w="150" h="30" /><datatype>number</datatype><initialvalue>5</initialvalue><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="0584166a-5b82-47ee-ae36-4ff4c7dbad01" name="Note12" type="Note"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><narrative>Some sort of messaging or notification could be sent to the reviewers here, to let them know that there is an Excel file that is ready for review</narrative><display x="15" y="615" w="120" h="90" /><onsuccess>9cf51c94-58fe-45ec-b14a-c50ba96985ef</onsuccess></stage><stage stageid="b193f3c4-0a4d-4a3b-9ca6-cd2c5825a51d" name="Writing the Temporary Excel file" type="Block"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="-105" y="-90" w="240" h="465" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="12fd9ad7-6931-4b66-a97c-0217c1f49fa3" name="Do not Reset to Initial Value" type="Block"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><display x="-270" y="-30" w="150" h="90" /><font family="Segoe UI" size="10" style="Regular" color="339966" /></stage><stage stageid="9615a543-d62b-4878-bbc3-72eb07fe9ea9" name="Work Queues::Get Item By ID" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><narrative>This action gets the item corresponding to the Id</narrative><display x="15" y="330" w="90" h="30" /><inputs><input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue." expr="[Queue Name]" /><input type="text" name="Item ID" friendlyname="Item ID" narrative="The Id of the queue item" expr="[Data.Item ID]" /></inputs><outputs><output type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="" /><output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="" /><output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" /><output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" /></outputs><onsuccess>a6524bd7-a3ce-4088-8f28-553a016eb387</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Item By ID" /></stage><stage stageid="56316f94-d1b5-4c54-9409-15691c3187c8" name="Note8" type="Note"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><narrative>We must lock the Item before we can update its status</narrative><display x="-105" y="330" w="90" h="60" /><onsuccess>9615a543-d62b-4878-bbc3-72eb07fe9ea9</onsuccess></stage><stage stageid="ff85cd3a-bfd7-455d-89d9-8782d4c4bf4f" name="Lock Item" type="Block"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="300" w="210" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="f2efad60-5159-43fb-b085-268c18d4313f" name="Work Queues::Unlock Item" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><narrative>Unlocks a currently locked work queue item</narrative><display x="15" y="480" w="90" h="30" /><inputs><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the work queue item which should be unlocked" expr="[Data.Item ID]" /></inputs><outputs><output type="flag" name="Unlocked" friendlyname="Unlocked" narrative="Whether the item was unlocked as a result of this action or not. If the item had finished being worked elsewhere before this action had run, this will be 'False'" stage="" /></outputs><onsuccess>391ff9cc-782c-47ff-9d8b-a3d3d7ec6054</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Unlock Item" /></stage><stage stageid="0cc03ae5-2a22-4c13-8095-a58499ada6ec" name="Note13" type="Note"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><narrative>If we can't lock the item, skip it, and don't delete the Excel file</narrative><display x="345" y="390" w="120" h="60" /><onsuccess>016ac95f-adae-4ef5-958a-4941e87668c9</onsuccess></stage><stage stageid="895e7c27-21b8-4f58-9185-f810c56e9111" name="Failed to Update Status" type="Collection"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="-195" y="180" w="150" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="age" type="text" /><field name="job_id" type="text" /><field name="salary_range_id" type="text" /><field name="days_last_purchase" type="text" /><field name="avg_purchase_size" type="text" /><field name="rewards_club_points" type="text" /><field name="gender" type="text" /><field name="customer_id" type="text" /><field name="label" type="text" /><field name="Item ID" type="text" /></collectioninfo></stage><stage stageid="67559b17-ad4a-44fe-84a5-2972ce56aca6" name="Collections::Add Row" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="225" y="435" w="90" h="30" /><inputs><input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Failed to Update Status&quot;" /></inputs><onsuccess>2f0bef9b-b6f0-455f-9f6a-67fe6493ef60</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" /></stage><stage stageid="2f0bef9b-b6f0-455f-9f6a-67fe6493ef60" name="Set Failed to Update Status Collection" type="MultipleCalculation"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="225" y="525" w="90" h="30" /><onsuccess>391ff9cc-782c-47ff-9d8b-a3d3d7ec6054</onsuccess><steps><calculation expression="[Data.Item ID]" stage="Failed to Update Status.Item ID" /><calculation expression="[Data.age]" stage="Failed to Update Status.age" /><calculation expression="[Data.avg_purchase_size]" stage="Failed to Update Status.avg_purchase_size" /><calculation expression="[Data.customer_id]" stage="Failed to Update Status.customer_id" /><calculation expression="[Data.days_last_purchase]" stage="Failed to Update Status.days_last_purchase" /><calculation expression="[Data.gender]" stage="Failed to Update Status.gender" /><calculation expression="[Data.job_id]" stage="Failed to Update Status.job_id" /><calculation expression="[Data.rewards_club_points]" stage="Failed to Update Status.rewards_club_points" /><calculation expression="[Data.salary_range_id]" stage="Failed to Update Status.salary_range_id" /><calculation expression="[Data.label]" stage="Failed to Update Status.label" /></steps></stage><stage stageid="e72ec14c-b68a-410a-b35a-66b825edae6d" name="MS Excel VBO::Save Current Workbook As" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="165" y="900" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance for which the current workbook which should be saved. The default of zero indicates the currently active instance." expr="[handle2]" /><input type="text" name="File name" friendlyname="File name" narrative="The full path and file name to which the current workbook should be saved." expr="[Files.Path]" /></inputs><outputs><output type="text" name="New Workbook Name" friendlyname="New Workbook Name" narrative="The new workbook name which Excel will use to identify the workbook." stage="" /></outputs><onsuccess>81424b5b-d88c-4bb3-a67e-6512009d5662</onsuccess><resource object="MS Excel VBO" action="Save Current Workbook As" /></stage><stage stageid="81424b5b-d88c-4bb3-a67e-6512009d5662" name="MS Excel VBO::Close Instance" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="165" y="945" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance to be closed. Zero indicates the currently active instance." expr="[handle2]" /><input type="flag" name="Save Changes" friendlyname="Save Changes" narrative="True to save the changes to the open workbooks on the instance, False to discard any changes. Default is False." expr="" /></inputs><onsuccess>25a5b8ab-add5-407f-a884-a2e3af27f9e3</onsuccess><resource object="MS Excel VBO" action="Close Instance" /></stage><stage stageid="bce9ce6d-8707-42e3-813c-9022f5abde2a" name="MS Excel VBO::Write Collection" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="165" y="855" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the specified collection should be written. The default of zero indicates the currently active instance." expr="[handle2]" /><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection containing the data which should be written to the worksheet." expr="[Failed to Update Status]" /><input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook within which the data should be written. The default empty value indicates the current workbook within the specified instance." expr="[Workbook Name2]" /><input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the worksheet on which the given data should be written. The default empty value indicates the current sheet within the specified workbook." expr="" /><input type="text" name="Cell Reference" friendlyname="Cell Reference" narrative="The reference at which the collection should be written." expr="&quot;A1&quot;" /><input type="flag" name="Include Column Names" friendlyname="Include Column Names" narrative="True to indicate that the column names from the collection should be written out as the first row; False to ignore the column names and just write out the data." expr="True" /></inputs><onsuccess>e72ec14c-b68a-410a-b35a-66b825edae6d</onsuccess><resource object="MS Excel VBO" action="Write Collection" /></stage><stage stageid="92d5ffe3-3dc3-464f-bc52-eaf707e94362" name="Failed to Lock" type="Data"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><narrative>Set to true we failed to lock any item in this Excel file</narrative><display x="-195" y="210" w="150" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="016ac95f-adae-4ef5-958a-4941e87668c9" name="Set Failed to Lock" type="Calculation"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="225" y="390" w="90" h="30" /><onsuccess>67559b17-ad4a-44fe-84a5-2972ce56aca6</onsuccess><calculation expression="True" stage="Failed to Lock" /></stage><stage stageid="b26072bd-dd2e-44a4-bcd8-b19856e1ded3" name="Updated all Items?" type="Decision"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="15" y="585" w="90" h="30" /><decision expression="[Failed to Lock] = False" /><ontrue>f61706ed-41f1-470b-817f-b036058bcc41</ontrue><onfalse>a3f13a74-cc37-49ed-86e0-d7b2bcb718b7</onfalse></stage><stage stageid="db2f3bfa-e424-40fa-ad6b-ef9738807c22" name="Utility - File Management::Delete File" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="-60" y="675" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The full path to the file to delete" expr="[Files.Path]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>abfbaf6d-0257-4918-8b6f-5775f04cdb6e</onsuccess><resource object="Utility - File Management" action="Delete File" /></stage><stage stageid="f61706ed-41f1-470b-817f-b036058bcc41" name="MS Excel VBO::Close Instance" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="-60" y="630" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance to be closed. Zero indicates the currently active instance." expr="[handle]" /><input type="flag" name="Save Changes" friendlyname="Save Changes" narrative="True to save the changes to the open workbooks on the instance, False to discard any changes. Default is False." expr="" /></inputs><onsuccess>db2f3bfa-e424-40fa-ad6b-ef9738807c22</onsuccess><resource object="MS Excel VBO" action="Close Instance" /></stage><stage stageid="0f7c8055-2c81-40bf-a865-23854aaaf25b" name="Recover3" type="Recover"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit /><display x="120" y="330" /><onsuccess>228725c3-ea98-40eb-b42e-d34918da6023</onsuccess></stage><stage stageid="8e048550-99ef-4987-a927-3e6ca32ea01e" name="Lock Token" type="Data"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="-195" y="15" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0283ede9-2296-4076-b3eb-172c421356d1" name="Lock Prefix" type="Data"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="-195" y="-15" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">Chapter 5 Example 3 Lock 2</initialvalue><private /><alwaysinit /></stage><stage stageid="7e55ff14-010f-4e16-9608-82876e925e43" name="Populate Queue Settings" type="Block"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="-270" y="-45" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="228725c3-ea98-40eb-b42e-d34918da6023" name="Resume3" type="Resume"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit /><display x="225" y="330" /><onsuccess>016ac95f-adae-4ef5-958a-4941e87668c9</onsuccess></stage><stage stageid="4e4ba193-dfb3-4769-b9f5-fdb19be888cd" name="Note14" type="Note"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><narrative>If we successfully update the status of all of the predictions in the file, delete the file</narrative><display x="-180" y="675" w="90" h="90" /><onsuccess>db2f3bfa-e424-40fa-ad6b-ef9738807c22</onsuccess></stage><stage stageid="7ae1338e-20a2-41bc-b93a-c7caf32fed6e" name="Note14" type="Note"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><narrative>If we fail to update the status for some of the predictions in the file, overwrite the file with the failures</narrative><display x="345" y="855" w="90" h="90" /><onsuccess>bce9ce6d-8707-42e3-813c-9022f5abde2a</onsuccess></stage><stage stageid="4861b6f7-1f8b-4844-8164-e6fd41cfc898" name="Success?" type="Decision"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="15" y="615" w="90" h="30" /><decision expression="[Success]" /><ontrue>4d340ec5-7fd4-4b55-8171-ed587c84eaa4</ontrue><onfalse>702680be-a3f5-418a-9203-cd1c6e8d397d</onfalse></stage><stage stageid="702680be-a3f5-418a-9203-cd1c6e8d397d" name="SE - Temporary Review Folder does not exist" type="Exception"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="165" y="615" w="90" h="30" /><exception localized="yes" type="System Exception" detail="&quot;SE - Temporary Review Folder does not exist: &quot; &amp; [Ch5 Example 3 Temporary Review Folder Path]" /></stage><stage stageid="454a6c89-f65f-4697-9b94-85569a625992" name="Create Temporary Review Folder" type="Action"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="570" w="90" h="30" /><inputs><input type="text" name="Directory Path" friendlyname="Directory Path" narrative="The path in which to create the directory" expr="[Ch5 Example 3 Temporary Review Folder Path]" /><input type="flag" name="Error If Already Exists" friendlyname="Error If Already Exists" narrative="True to generate an error if the directory already exists" expr="False" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>4861b6f7-1f8b-4844-8164-e6fd41cfc898</onsuccess><resource object="Utility - File Management" action="Create Directory" /></stage><stage stageid="421a95ba-3974-40d7-bf6c-652da59b8eb1" name="Move Temporary Files" type="SubSheetInfo"><subsheetid>f4027e91-43b5-4c69-9723-14dea558d3f0</subsheetid><narrative>If there are any files that haven't been moved to the "To Review" folder due to Exception, Stop Request or not meeting the batch file size limit, move the files here. Terminations won't result on files copied, but the next time the process runs, and ends for a non-termination reason, this should catch it.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="de49abec-53f1-4493-9e40-b2ef6f9dc433" name="Start" type="Start"><subsheetid>f4027e91-43b5-4c69-9723-14dea558d3f0</subsheetid><display x="15" y="-105" /><onsuccess>2a779367-6038-4ba8-ae69-87911dafeca4</onsuccess></stage><stage stageid="053dce8a-5f39-4766-aad4-b4a631dbd035" name="End" type="End"><subsheetid>f4027e91-43b5-4c69-9723-14dea558d3f0</subsheetid><display x="15" y="120" /></stage><stage stageid="2a779367-6038-4ba8-ae69-87911dafeca4" name="Utility - File Management::Get Files" type="Action"><subsheetid>f4027e91-43b5-4c69-9723-14dea558d3f0</subsheetid><loginhibit onsuccess="true" /><narrative>Slash needs to be added to the end</narrative><display x="15" y="-60" w="90" h="30" /><inputs><input type="text" name="Folder" friendlyname="Folder" narrative="The folder in which to look for files" expr="[Ch5 Example 3 Temporary Review Folder Path] &amp; &quot;\&quot;" /><input type="text" name="Patterns CSV" friendlyname="Patterns CSV" narrative="The comma seperated list of wildcard patterns" expr="&quot;review_&quot; &amp; GetResourceName() &amp; &quot;*.xlsx&quot;" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="A message if unsuccessful" stage="Message" /><output type="collection" name="Files" friendlyname="Files" narrative="The collection of files found" stage="Files" /></outputs><onsuccess>5e395d3c-e0bf-4f43-8c1d-52894949dccf</onsuccess><resource object="Utility - File Management" action="Get Files" /></stage><stage stageid="6dc5c879-3862-4f5f-a001-55790654c438" name="Success" type="Data"><subsheetid>f4027e91-43b5-4c69-9723-14dea558d3f0</subsheetid><display x="-195" y="0" w="150" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b7559875-33bf-4c88-9e07-55e60c5b46a1" name="Message" type="Data"><subsheetid>f4027e91-43b5-4c69-9723-14dea558d3f0</subsheetid><display x="-195" y="30" w="150" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5d3c76b9-8503-42ce-be5d-11af78817ef4" name="Files" type="Collection"><subsheetid>f4027e91-43b5-4c69-9723-14dea558d3f0</subsheetid><display x="-195" y="-30" w="150" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="5e395d3c-e0bf-4f43-8c1d-52894949dccf" name="Loop Files" type="LoopStart"><subsheetid>f4027e91-43b5-4c69-9723-14dea558d3f0</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-15" w="120" h="30" /><onsuccess>eb7dc0f1-7f7f-40ff-82df-7e2215422273</onsuccess><groupid>51806209-d7db-4fe7-b806-9d4657517ec5</groupid><looptype>ForEach</looptype><loopdata>Files</loopdata></stage><stage stageid="06dd7532-b8a3-404e-8a89-857a18d88538" name="Loop Files" type="LoopEnd"><subsheetid>f4027e91-43b5-4c69-9723-14dea558d3f0</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="120" h="30" /><onsuccess>053dce8a-5f39-4766-aad4-b4a631dbd035</onsuccess><groupid>51806209-d7db-4fe7-b806-9d4657517ec5</groupid></stage><stage stageid="78c4a272-b628-45f6-abea-36b5971a017e" name="Note16" type="Note"><subsheetid>f4027e91-43b5-4c69-9723-14dea558d3f0</subsheetid><narrative>No lock is needed because we will filter files based on this Resource's name</narrative><display x="165" y="-60" w="120" h="60" /><onsuccess>2a779367-6038-4ba8-ae69-87911dafeca4</onsuccess></stage><stage stageid="eb7dc0f1-7f7f-40ff-82df-7e2215422273" name="Utility - File Management::Move File" type="Action"><subsheetid>f4027e91-43b5-4c69-9723-14dea558d3f0</subsheetid><loginhibit onsuccess="true" /><display x="15" y="30" w="90" h="30" /><inputs><input type="text" name="File Path" friendlyname="File Path" narrative="The full path to the file to move" expr="[Files.Path]" /><input type="text" name="Destination Path" friendlyname="Destination Path" narrative="The path to the folder to move the file to" expr="[Ch5 Example 3 To Review Folder Path]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>06dd7532-b8a3-404e-8a89-857a18d88538</onsuccess><resource object="Utility - File Management" action="Move File" /></stage><stage stageid="e530266a-f28c-4ca8-b845-5313fdb98d5e" name="Move Temporary Files" type="SubSheet"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="15" y="105" /><onsuccess>f9758604-8646-4883-90b3-b7e59d317183</onsuccess><processid>f4027e91-43b5-4c69-9723-14dea558d3f0</processid></stage><stage stageid="c3c265ed-6f1a-4af2-ad52-e007cdcdda14" name="Check for Reviewed Predictions" type="SubSheet"><loginhibit onsuccess="true" /><display x="15" y="0" w="90" h="30" /><onsuccess>85fbb578-f410-4f72-8ca9-58513939bc51</onsuccess><processid>0f6bea13-07af-439b-9498-383a5ad24099</processid></stage><stage stageid="caf3f515-bf0c-4e5b-87dc-c8b14fd4d44d" name="Rewrite Excel Needed" type="Data"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><narrative>Set to true we successfully update one Item ID's Status</narrative><display x="-195" y="240" w="150" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="a6524bd7-a3ce-4088-8f28-553a016eb387" name="Set Rewrite Excel Needed" type="Calculation"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="15" y="390" w="90" h="30" /><onsuccess>5050f270-9d5e-493b-a15a-93ec7e7bbc07</onsuccess><calculation expression="True" stage="Rewrite Excel Needed" /></stage><stage stageid="3f4a3acc-0da8-46c5-933d-c9646e35b8a8" name="Reset Flags to False" type="MultipleCalculation"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="15" y="165" w="90" h="30" /><onsuccess>d956b88a-10b3-49b1-bfba-48fa93e3631b</onsuccess><steps><calculation expression="False" stage="Failed to Lock" /><calculation expression="False" stage="Rewrite Excel Needed" /></steps></stage><stage stageid="a3f13a74-cc37-49ed-86e0-d7b2bcb718b7" name="Updated none of the Items?" type="Decision"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="105" y="630" w="90" h="30" /><decision expression="[Rewrite Excel Needed] = False" /><ontrue>3f8032ca-3fe5-4ad7-b598-0b1480b16ed5</ontrue><onfalse>90e670dd-63ba-4a4a-8f58-7c90d109d3b9</onfalse></stage><stage stageid="abfbaf6d-0257-4918-8b6f-5775f04cdb6e" name="Anchor15" type="Anchor"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="15" y="765" w="10" h="10" /><onsuccess>25a5b8ab-add5-407f-a884-a2e3af27f9e3</onsuccess></stage><stage stageid="54765ae8-5b6c-4eea-aeec-9e166fa8b6cc" name="MS Excel VBO::Create Instance" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="165" y="765" w="90" h="30" /><inputs><input type="flag" name="Enable Events" friendlyname="Enable Events" narrative="Flag to indicate that events should be enabled / disabled on the attached instance - defaulted to True" expr="" /></inputs><outputs><output type="number" name="handle" friendlyname="handle" narrative="An integer which can be used to identify the created instance in subsequent actions" stage="handle2" /></outputs><onsuccess>5f1c41c0-d772-48a1-a4d7-60e78ef1a6b7</onsuccess><resource object="MS Excel VBO" action="Create Instance" /></stage><stage stageid="fa309fe5-439f-40a1-ae4e-cf24624fd087" name="Utility - File Management::Delete File" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="165" y="720" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The full path to the file to delete" expr="[Files.Path]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>54765ae8-5b6c-4eea-aeec-9e166fa8b6cc</onsuccess><resource object="Utility - File Management" action="Delete File" /></stage><stage stageid="90e670dd-63ba-4a4a-8f58-7c90d109d3b9" name="MS Excel VBO::Close Instance" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="165" y="675" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance to be closed. Zero indicates the currently active instance." expr="[handle]" /><input type="flag" name="Save Changes" friendlyname="Save Changes" narrative="True to save the changes to the open workbooks on the instance, False to discard any changes. Default is False." expr="" /></inputs><onsuccess>fa309fe5-439f-40a1-ae4e-cf24624fd087</onsuccess><resource object="MS Excel VBO" action="Close Instance" /></stage><stage stageid="5f1c41c0-d772-48a1-a4d7-60e78ef1a6b7" name="MS Excel VBO::Create Workbook" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="165" y="810" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the workbook should be created. The default of zero indicates the currently active instance." expr="[handle2]" /></inputs><outputs><output type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook that Excel has created - this can be changed using the &quot;Save Workbook As&quot; action" stage="Workbook Name2" /></outputs><onsuccess>bce9ce6d-8707-42e3-813c-9022f5abde2a</onsuccess><resource object="MS Excel VBO" action="Create Workbook" /></stage><stage stageid="a7c2bb27-b0d5-4632-8044-a346353f494b" name="handle2" type="Data"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="270" y="765" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4adcba37-9d6b-4277-8ba4-36b605462c2d" name="Workbook Name2" type="Data"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="270" y="810" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3f8032ca-3fe5-4ad7-b598-0b1480b16ed5" name="MS Excel VBO::Close Instance" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="60" y="675" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance to be closed. Zero indicates the currently active instance." expr="[handle]" /><input type="flag" name="Save Changes" friendlyname="Save Changes" narrative="True to save the changes to the open workbooks on the instance, False to discard any changes. Default is False." expr="" /></inputs><onsuccess>abfbaf6d-0257-4918-8b6f-5775f04cdb6e</onsuccess><resource object="MS Excel VBO" action="Close Instance" /></stage><stage stageid="d956b88a-10b3-49b1-bfba-48fa93e3631b" name="Collections::Remove All Rows" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="15" y="210" w="90" h="30" /><inputs><input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Failed to Update Status&quot;" /></inputs><onsuccess>64ed70c9-6fc2-4e87-b5dc-bf1fce9a3fb7</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove All Rows" /></stage><stage stageid="648c209d-7b8a-4033-a787-04a8567df901" name="Aquire Lock" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><narrative>Acquires the lock associated with the given name. If this session already holds the required lock, it will be re-acquired with a new token</narrative><display x="15" y="-60" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Name" narrative="The name of the required lock. Mandatory parameter." expr="[Lock Prefix] &amp; [Files.Path]" /><input type="timespan" name="Timeout" narrative="The maximum amount of time to await the lock. Default is to wait forever" expr="MakeTimeSpan(0, 0, 0, 0)" /><input type="text" name="Preferred Token" narrative="The preferred token to use for the lock. Default behaviour is to generate a new unique token." expr="[Lock Token]" /><input type="text" name="Comment" narrative="The comments to set on the lock" expr="&quot;Acquire Lock&quot;" /></inputs><outputs><output type="text" name="Token" narrative="The token registered against the lock. This will be empty if the lock could not be acquired" stage="Lock Token" /></outputs><onsuccess>e6ab75aa-a444-436f-8275-d9ac94d44173</onsuccess><resource object="BluePrism.AutomateAppCore.clsEnvironmentLockingBusinessObject" action="Acquire Lock" /></stage><stage stageid="e6ab75aa-a444-436f-8275-d9ac94d44173" name="Got Lock?" type="Decision"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><display x="15" y="-15" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Lock Token] &lt;&gt; &quot;&quot;" /><ontrue>852db67b-ab8e-4553-b00e-1d631276ce77</ontrue><onfalse>421879d6-5cb0-41ea-b9da-00a46c51ba3a</onfalse></stage><stage stageid="25a5b8ab-add5-407f-a884-a2e3af27f9e3" name="Release Lock" type="Action"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><narrative>Releases the lock(s) associated with the given name and token</narrative><display x="15" y="945" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Name" narrative="The name of the specific lock to be released. Default behaviour is to release all locks with the given token." expr="[Lock Prefix] &amp; [Files.Path]" /><input type="text" name="Token" narrative="The token associated with the lock(s) to be released. Mandatory parameter." expr="[Lock Token]" /><input type="text" name="Comment" narrative="The comments to set on the lock(s)" expr="&quot;Release lock&quot;" /><input type="flag" name="All Sessions" narrative="True to release locks matching the specified constraints across all sessions; False to only release locks acquired in the current session. Default is False" expr="True" /><input type="flag" name="Keep Environment Lock" friendlyname="Keep Environment Lock" narrative="The environment lock will be kept after that lock is released. Default behaviour is to delete the lock." expr="" /></inputs><onsuccess>ba1dc0bb-6651-4a41-b646-b6138098ac39</onsuccess><resource object="BluePrism.AutomateAppCore.clsEnvironmentLockingBusinessObject" action="Release Lock" /></stage><stage stageid="421879d6-5cb0-41ea-b9da-00a46c51ba3a" name="Anchor16" type="Anchor"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="450" y="-15" w="10" h="10" /><onsuccess>03d1f72f-1886-4f1a-95b2-18db1c50817d</onsuccess></stage><stage stageid="03d1f72f-1886-4f1a-95b2-18db1c50817d" name="Anchor17" type="Anchor"><subsheetid>0f6bea13-07af-439b-9498-383a5ad24099</subsheetid><loginhibit onsuccess="true" /><display x="450" y="990" w="10" h="10" /><onsuccess>ba1dc0bb-6651-4a41-b646-b6138098ac39</onsuccess></stage></process></process>
        <work-queue id="4" name="Chapter 5 Example 3 Queue" key-field="customer_id" xmlns="http://www.blueprism.co.uk/product/work-queue" />
        <environment-variable id="Ch5 Example 3 Completed Review Folder Path" name="Ch5 Example 3 Completed Review Folder Path" type="text" value="C:\Users\Public\Ch5\Completed_Review" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>The folder where items that have been reviewed are saved</description>
        </environment-variable>
        <environment-variable id="Ch5 Example 3 Random Sampling Target" name="Ch5 Example 3 Random Sampling Target" type="number" value="0" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>The percentage of ML predictions that should be manually reviewed</description>
        </environment-variable>
        <environment-variable id="Ch5 Example 3 Review Batch Size" name="Ch5 Example 3 Review Batch Size" type="number" value="5" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>How many reviews should be written into each Excel file</description>
        </environment-variable>
        <environment-variable id="Ch5 Example 3 Temporary Review Folder Path" name="Ch5 Example 3 Temporary Review Folder Path" type="text" value="C:\Users\Public\Ch5\Temporary_Review" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>The folder where temporary excel files are stored</description>
        </environment-variable>
        <environment-variable id="Ch5 Example 3 To Review Folder Path" name="Ch5 Example 3 To Review Folder Path" type="text" value="C:\Users\Public\Ch5\To_Review" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>The folder where items that need reviewing are saved</description>
        </environment-variable>
        <process-group id="fec7909f-4304-4ef8-bb2e-82ef32e2af23" name="Ch5" isDefaultGroup="False" xmlns="http://www.blueprism.co.uk/product/process-group">
            <members>
                <process id="85805791-f97d-481c-b16b-d9f30123d3a9" />
            </members>
        </process-group>
    </bpr:contents>
</bpr:release>