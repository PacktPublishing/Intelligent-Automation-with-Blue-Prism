<?xml version="1.0" encoding="utf-8"?>
<bpr:release xmlns:bpr="http://www.blueprism.co.uk/product/release">
    <bpr:name>1.1</bpr:name>
    <bpr:release-notes />
    <bpr:created>2023-07-11 15:07:03Z</bpr:created>
    <bpr:package-id>4017</bpr:package-id>
    <bpr:package-name>Ch6 - Example 2 Independent Review Logic</bpr:package-name>
    <bpr:user-created-by>admin</bpr:user-created-by>
    <bpr:contents count="9">
        <process id="0b265c19-a58d-4278-81a0-f61ea018874b" name="Example 2A - Random Sampling" published="true" xmlns="http://www.blueprism.co.uk/product/process"><process name="Example 2A - Random Sampling" version="1.0" bpversion="7.1.2.3518" narrative="This is a Random Sampling example using Shared folders / Excel files to exchange data with the reviewer. The review checking logic is in a separate process." byrefcollection="true"><view><camerax>63</camerax><cameray>118</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7" type="Normal" published="False"><name>Start Up</name><view><camerax>51</camerax><cameray>453</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="cf13a1fa-a9be-4527-973b-e2f66f99d14b" type="Normal" published="False"><name>Close Down</name><view><camerax>0</camerax><cameray>59</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="b749d60a-bded-4d36-b099-3627ed699606" type="Normal" published="False"><name>Populate Queue</name><view><camerax>-126</camerax><cameray>225</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="bf57723b-f31f-465f-a44d-6b23e78fd2de" type="Normal" published="False"><name>01 Work Step</name><view><camerax>97</camerax><cameray>25</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="4f5f8a61-abf2-40dd-8169-d8ab45ffd78c" type="Normal" published="False"><name>02 ML Prediction</name><view><camerax>-76</camerax><cameray>513</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="47e58161-0f42-47cc-aa94-af755a8de010" type="Normal" published="False"><name>03 Random Sampling</name><view><camerax>5</camerax><cameray>101</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="5ad2c3a7-152c-4eb5-ac1c-922e32db3271" type="Normal" published="False"><name>04 Work Step</name><view><camerax>97</camerax><cameray>25</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="d31d1c11-61ad-4c49-91a4-44bbf0bf0725" type="Normal" published="False"><name>Mark Item As Completed</name><view><camerax>0</camerax><cameray>2</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="aef794a5-348a-4de6-9810-f7f57b96166b" type="Normal" published="False"><name>Update Status and Tag for Manual Review</name><view><camerax>10</camerax><cameray>178</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="d599353b-a78b-40f4-ab04-255791b86a1a" type="Normal" published="False"><name>Mark Item As Exception</name><view><camerax>-8</camerax><cameray>118</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="5fd952f0-1be2-40e8-8afa-485524c5a5cd" type="Normal" published="False"><name>Reset Global Data</name><view><camerax>0</camerax><cameray>42</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="30a66a72-d51e-464f-89e3-f40b54998601" name="Start" type="Start"><display x="15" y="-150" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>832b89eb-e411-459f-ac7a-4584e360f5ef</onsuccess></stage><stage stageid="458762d9-7dd4-47c0-bbdc-55d193273d9c" name="End" type="End"><display x="390" y="-165" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="8b6eaa66-766c-4d2a-a0d1-cc6ab7e4f32d" name="Stage1" type="ProcessInfo"><display x="-180" y="-180" w="270" h="120" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="62aec640-1920-44e6-8b1e-be6a9725cec8" name="Mark Item As Completed" type="SubSheetInfo"><subsheetid>d31d1c11-61ad-4c49-91a4-44bbf0bf0725</subsheetid><narrative>Marks the current work queue item as complete</narrative><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="1446dc69-509c-446c-8f20-b7f580423da2" name="Mark Item As Exception" type="SubSheetInfo"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Marks the current work queue item as an exception</narrative><display x="-120" y="-195" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="bc2ffba4-5cb1-48b6-a390-3b1aadd5dab4" name="Start" type="Start"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="15" y="-120" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>808cbef2-cfe3-460f-ba72-91e0e6283988</onsuccess></stage><stage stageid="b49e249e-bbb1-427e-8bd1-902ce03e3a79" name="Recover" type="Recover"><display x="120" y="525" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>6fa1db8d-0510-4c35-8416-9a938e94c78d</onsuccess></stage><stage stageid="53762061-333e-4023-b99f-1de349dfc4a4" name="Resume" type="Resume"><display x="120" y="675" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>ffb4d158-5875-4239-bd22-b7ca87c93bbc</onsuccess></stage><stage stageid="b9fbad6e-b3b1-4e9b-bc71-1b96d40beeb2" name="Retry Exception?" type="Decision"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="15" y="30" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="Lower([Exception Type])=&quot;system exception&quot; OR Lower([Exception Type])=&quot;internal&quot;" /><ontrue>6b5864ff-c8f2-4c69-8e1b-d090c057cdc2</ontrue><onfalse>5ce83707-f042-4e73-929c-e7358ebdc456</onfalse></stage><stage stageid="a374264f-2dbf-4477-bad7-ee4ba812e5b1" name="Previous Exception?" type="Decision"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="15" y="225" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Previous Exception Detail]=[Exception Detail]" /><ontrue>3484ce27-f1ef-4f28-926b-efaa03fc5fed</ontrue><onfalse>7105b714-612a-4e50-84b3-f789f0634902</onfalse></stage><stage stageid="a08fa84e-da3f-447e-80f1-1db9c2935d76" name="Previous Exception Detail" type="Data"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="-225" y="165" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /></stage><stage stageid="3484ce27-f1ef-4f28-926b-efaa03fc5fed" name="Count" type="Calculation"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="15" y="300" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>02c69925-9f7c-41af-844f-259d82504b0a</onsuccess><calculation expression="1+ [Consecutive Exception Count]" stage="Consecutive Exception Count" /></stage><stage stageid="279f2417-29f4-4931-9039-5d9693cd6b93" name="Consecutive Exception Count" type="Data"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="-225" y="195" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue></stage><stage stageid="02c69925-9f7c-41af-844f-259d82504b0a" name="Limit?" type="Decision"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="15" y="375" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Consecutive Exception Count]&gt;=[Consecutive Exception Limit]" /><ontrue>4dda9efd-3cd9-4714-b293-fe6aa9cd269c</ontrue><onfalse>7360eced-01c7-4dc8-a7ef-817d130f1cc5</onfalse></stage><stage stageid="aefca01e-0501-4f8e-ba6c-a5aa4896e4ea" name="TERMINATE" type="Exception"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="15" y="570" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><exception type="" detail="[Consecutive Exception Limit] &amp; &quot; consecutive incidents of &quot; &amp; [Exception Type] &amp; &quot;: &quot; &amp; [Exception Detail]" /></stage><stage stageid="36455e9b-9b0b-4078-b5b2-338e1aab1f84" name="Consecutive Exception Limit" type="Data"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="-225" y="225" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>3</initialvalue><private /><alwaysinit /></stage><stage stageid="64a4e876-5092-4568-829b-73faed844a31" name="End2" type="End"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="285" y="375" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="9de6523c-e14d-4937-b854-1b0930857c02" name="Reset Consecutive Exception Indicators" type="MultipleCalculation"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="285" y="225" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>64a4e876-5092-4568-829b-73faed844a31</onsuccess><steps><calculation expression="[Exception Detail]" stage="Previous Exception Detail" /><calculation expression="0" stage="Consecutive Exception Count" /></steps></stage><stage stageid="4dda9efd-3cd9-4714-b293-fe6aa9cd269c" name="Stop the process because consecutive exceptions are occuring" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>The consecutive exception limit has been reached, so throw a new exception to terminate the process.</narrative><display x="15" y="480" w="120" h="90" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>aefca01e-0501-4f8e-ba6c-a5aa4896e4ea</onsuccess></stage><stage stageid="6047b42e-0003-4ddb-8ba3-d3607d6ce770" name="Start" type="Start"><subsheetid>d31d1c11-61ad-4c49-91a4-44bbf0bf0725</subsheetid><display x="15" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>126538a7-7404-4369-8cdd-056490ecc46c</onsuccess></stage><stage stageid="86bb4f43-18d4-43dd-9bf5-b8902e21521c" name="Mark Completed" type="Action"><subsheetid>d31d1c11-61ad-4c49-91a4-44bbf0bf0725</subsheetid><narrative>Marks the item as completed, by updating the Completed timestamp and setting Locked to null. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative><display x="15" y="0" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /></inputs><onsuccess>8f6d0bfa-2d98-469e-997c-88b0c126d4d7</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Completed" /></stage><stage stageid="126538a7-7404-4369-8cdd-056490ecc46c" name="Set Status" type="Action"><subsheetid>d31d1c11-61ad-4c49-91a4-44bbf0bf0725</subsheetid><narrative>Updates the status field for the item. The status field can be used to flag what has been done in a process so far. If a process encounters an exception, this information can be used to skip to the parts of the process not yet done for the item next time it is worked. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.

This action will also reset the Attempts column to zero, because if the status updated the process should have successfully done something.</narrative><display x="15" y="-45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Status" narrative="The new status - 255 characters maximum." expr="&quot;Completed&quot;" /></inputs><onsuccess>86bb4f43-18d4-43dd-9bf5-b8902e21521c</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Update Status" /></stage><stage stageid="09fc131c-2803-4daf-b8cf-351f28b78783" name="New Item ID" type="Data"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="-225" y="105" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="10cdebf6-ced7-425b-91dd-2b0b764b5ee0" name="Got Item?" type="Decision"><display x="120" y="60" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Item ID]&lt;&gt;&quot;&quot;" /><ontrue>b2882ef7-4b96-44fe-974c-0c0833e543bc</ontrue><onfalse>7cfa842f-7ad3-4458-943f-6d7007300925</onfalse></stage><stage stageid="6322bec5-84f1-4af9-9af5-5406339262c4" name="01 Work Step" type="SubSheetInfo"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><display x="-105" y="-90" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="f52977fa-5395-47ee-a08b-35f92f89554c" name="01 Work Step" type="SubSheet"><display x="120" y="195" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>ddcca36f-4cf9-489e-abf7-6135db964332</onsuccess><processid>bf57723b-f31f-465f-a44d-6b23e78fd2de</processid></stage><stage stageid="97b3d7cc-18e6-4683-a321-c7c736d2d8b0" name="Start Up" type="SubSheetInfo"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><narrative>Prepares any variables according to the Run Mode, starts the applications and fills the queue.</narrative><display x="-195" y="195" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="58267ed1-deb3-498d-bdf8-42959ffc8bac" name="Close Down" type="SubSheetInfo"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><narrative>Closes down the applications and maintains the work queue.</narrative><display x="-210" y="-240" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="ebd3e811-a42f-4f89-b4da-5a793c6cd798" name="Start" type="Start"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="15" y="-165" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8edd051f-93cd-4a50-b830-432cc195b19c</onsuccess></stage><stage stageid="832b89eb-e411-459f-ac7a-4584e360f5ef" name="Start Up" type="SubSheet"><display x="15" y="-90" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>1db94fff-eca8-49a2-9404-2b6ba6688410</onsuccess><processid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</processid></stage><stage stageid="22b42ab0-feae-42b2-a098-9871956bb826" name="Close Down" type="SubSheet"><display x="390" y="-90" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>458762d9-7dd4-47c0-bbdc-55d193273d9c</onsuccess><processid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</processid></stage><stage stageid="c820952e-9e6d-4733-8604-b1360d80ecde" name="Work" type="Block"><display x="60" y="105" w="120" h="450" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="1ef745eb-5713-4876-9937-47ac6d74b94b" name="anchor8" type="Anchor"><display x="390" y="390" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>1cfde7f1-28bb-4c91-973d-915317f4f54e</onsuccess></stage><stage stageid="ae4ae986-9e90-407c-bdc5-098a2eaf7d1c" name="02 ML Prediction" type="SubSheetInfo"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><narrative>This page is a mock of a Machine Learning prediction</narrative><display x="-195" y="-60" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="e1b17a89-74f4-4c4e-9fc1-dcd90c44c837" name="Start" type="Start"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="15" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>44df47e0-abaa-4bc7-8c74-dece46e8befc</onsuccess></stage><stage stageid="6dace494-d4a8-4d6a-8169-cfd699f9f583" name="03 Random Sampling" type="SubSheetInfo"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><narrative>This page generates the random number using PowerShell, compares it to the desired target percentage and sets a global flag indicating whether manual review is needed</narrative><display x="-225" y="-30" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="ddcca36f-4cf9-489e-abf7-6135db964332" name="02 ML Prediction" type="SubSheet"><display x="120" y="240" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>731b1d6d-580d-4e96-9d99-20280f13ae57</onsuccess><processid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</processid></stage><stage stageid="731b1d6d-580d-4e96-9d99-20280f13ae57" name="03 Random Sampling" type="SubSheet"><display x="120" y="285" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>eb15fe18-d64f-4ffc-a07b-90af38776ded</onsuccess><processid>47e58161-0f42-47cc-aa94-af755a8de010</processid></stage><stage stageid="4fc18802-6f3f-497d-84f9-d4647d4fe33a" name="Reset Global Data" type="SubSheetInfo"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><narrative>This page is only used to reset global data items</narrative><display x="-165" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="077ec244-9c84-4210-b6a5-e54b1b6000f0" name="Start" type="Start"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><display x="15" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0dee5c1d-8e68-49ec-a0ae-94125067ae6a</onsuccess></stage><stage stageid="0dee5c1d-8e68-49ec-a0ae-94125067ae6a" name="End" type="End"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><display x="15" y="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="bef8f1ff-727a-4e0a-b29e-ed73fb6f0147" name="Reset Global Data" type="SubSheet"><display x="390" y="210" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0341efdc-206a-43f9-8369-583aa2642c07</onsuccess><processid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</processid></stage><stage stageid="ffb4d158-5875-4239-bd22-b7ca87c93bbc" name="Mark Item As Exception" type="SubSheet"><display x="285" y="675" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8f17792f-057d-4155-804d-35098307f65b</onsuccess><processid>d599353b-a78b-40f4-ab04-255791b86a1a</processid></stage><stage stageid="e3035b4a-aba4-4fa5-932e-cbaab6a81b7b" name="Mark Item As Completed" type="SubSheet"><display x="285" y="390" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>1ef745eb-5713-4876-9937-47ac6d74b94b</onsuccess><processid>d31d1c11-61ad-4c49-91a4-44bbf0bf0725</processid></stage><stage stageid="8f6d0bfa-2d98-469e-997c-88b0c126d4d7" name="Reset Consecutive Exception Indicators" type="MultipleCalculation"><subsheetid>d31d1c11-61ad-4c49-91a4-44bbf0bf0725</subsheetid><display x="15" y="60" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>7f3bfe56-9180-4254-8d9c-ee9ab331b39a</onsuccess><steps><calculation expression="&quot;&quot;" stage="Previous Exception Detail" /><calculation expression="0" stage="Consecutive Exception Count" /></steps></stage><stage stageid="7f3bfe56-9180-4254-8d9c-ee9ab331b39a" name="End3" type="End"><subsheetid>d31d1c11-61ad-4c49-91a4-44bbf0bf0725</subsheetid><display x="15" y="120" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="46407e01-19d6-439f-b64b-e6a18e1ae3db" name="Stop?" type="Decision"><display x="390" y="60" w="90" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><decision expression="IsStopRequested() OR [Stop After Items]=0 OR LocalTime()&gt;[Stop After Time]" /><ontrue>22b42ab0-feae-42b2-a098-9871956bb826</ontrue><onfalse>b9deef81-8e13-43ef-b6e4-c7554776c97d</onfalse></stage><stage stageid="5ce83707-f042-4e73-929c-e7358ebdc456" name="Tag Item" type="Action"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Adds a tag to a work queue item</narrative><display x="105" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the queue item to add the tag to" expr="[Item ID]" /><input type="text" name="Tag" narrative="The tag to add to the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;Business Exception&quot;" /></inputs><onsuccess>daa36ca6-f942-4ebc-86fc-8ba76b19cb4d</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Tag Item" /></stage><stage stageid="0341efdc-206a-43f9-8369-583aa2642c07" name="Count Items" type="Calculation"><display x="390" y="135" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>46407e01-19d6-439f-b64b-e6a18e1ae3db</onsuccess><calculation expression="[Stop After Items]-1" stage="Stop After Items" /></stage><stage stageid="131b5818-75e5-49ed-9fd5-4d8a51ce52f1" name="Item ID" type="Data"><display x="-210" y="165" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="2d0552e3-8ed7-4090-b123-2fbe46f2918e" name="Item Data" type="Collection"><display x="-210" y="120" w="150" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><alwaysinit /></stage><stage stageid="ab543cd9-eb36-48bb-869d-f0e87751767b" name="Item Status" type="Data"><display x="-210" y="195" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="3615f299-65d4-4b0b-ba12-72bd84993bf8" name="Item Attempts" type="Data"><display x="-210" y="225" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><alwaysinit /></stage><stage stageid="85fbb578-f410-4f72-8ca9-58513939bc51" name="Get Next Item" type="Action"><narrative>This action gets the next item to be worked from the queue, returning its details and locking it so no other case can work it.

Items with higher priorities (lower numerical value) are processed first. Where the priority is the same, the next item is the one that has been in the queue the longest,  is not already locked, and is not already completed.

The Item ID returned is used to make further calls to update the work status for that item. It may be empty, in which case there are no items available. This can mean either a) the queue is empty, or b) the queue is not running. This mechanism can be used to cleanly stop all processes working a particular queue at the end of the next case. Items that have a 'deferred' time set will not be returned unless that time has been reached.</narrative><display x="15" y="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Queue Name" narrative="The name of the queue" expr="[Queue Name]" /><input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" /><input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="&quot;-Manual Review Required&quot;" /></inputs><outputs><output type="text" name="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" /><output type="collection" name="Data" narrative="The data associated with the item - a single collection row." stage="Item Data" /><output type="text" name="Status" narrative="The status of the item." stage="Item Status" /><output type="number" name="Attempts" narrative="The number of attempts already made to work this item." stage="Item Attempts" /></outputs><onsuccess>10cdebf6-ced7-425b-91dd-2b0b764b5ee0</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" /></stage><stage stageid="e7450b45-6166-42c1-b727-c904883265b5" name="Reset Consecutive Exception Indicators" type="MultipleCalculation"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="450" y="30" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>f06041aa-ea81-4ef5-b916-b46c6a06f168</onsuccess><steps><calculation expression="&quot;&quot;" stage="Previous Exception Detail" /><calculation expression="0" stage="Consecutive Exception Count" /></steps></stage><stage stageid="d08c5e70-1fd1-416b-9fdc-df51ccc54906" name="Exception Type" type="Data"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><display x="-165" y="-15" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="7ec266b2-b0c3-4dca-9e5b-f4cc61966dfa" name="Exception Detail" type="Data"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><display x="-165" y="15" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="b9deef81-8e13-43ef-b6e4-c7554776c97d" name="Get Next Item" type="Action"><narrative>This action gets the next item to be worked from the queue, returning its details and locking it so no other case can work it.

Items with higher priorities (lower numerical value) are processed first. Where the priority is the same, the next item is the one that has been in the queue the longest,  is not already locked, and is not already completed.

The Item ID returned is used to make further calls to update the work status for that item. It may be empty, in which case there are no items available. This can mean either a) the queue is empty, or b) the queue is not running. This mechanism can be used to cleanly stop all processes working a particular queue at the end of the next case. Items that have a 'deferred' time set will not be returned unless that time has been reached.</narrative><display x="270" y="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Queue Name" narrative="The name of the queue" expr="[Queue Name]" /><input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" /><input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="&quot;-Manual Review Required&quot;" /></inputs><outputs><output type="text" name="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" /><output type="collection" name="Data" narrative="The data associated with the item - a single collection row." stage="Item Data" /><output type="text" name="Status" narrative="The status of the item." stage="Item Status" /><output type="number" name="Attempts" narrative="The number of attempts already made to work this item." stage="Item Attempts" /></outputs><onsuccess>10cdebf6-ced7-425b-91dd-2b0b764b5ee0</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" /></stage><stage stageid="8f17792f-057d-4155-804d-35098307f65b" name="anchor14" type="Anchor"><display x="390" y="675" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>1ef745eb-5713-4876-9937-47ac6d74b94b</onsuccess></stage><stage stageid="7cfa842f-7ad3-4458-943f-6d7007300925" name="Note9" type="Note"><narrative>No more items available</narrative><display x="120" y="-90" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>22b42ab0-feae-42b2-a098-9871956bb826</onsuccess></stage><stage stageid="d64ced1f-6499-41a5-b006-5b03a3bd4ed0" name="Stop After Time" type="Data"><narrative>Used by the process to decide whether to keep working or close itself down. This value can be modified from Control Room to bring a session to an early finish.</narrative><display x="-210" y="0" w="150" h="30" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><datatype>time</datatype><initialvalue>23:59:59</initialvalue><exposure>Session</exposure><private /><alwaysinit /></stage><stage stageid="aff8912c-98ae-4bb9-84d5-a2eab0253c71" name="Stop After Items" type="Data"><narrative>Used by the process to decide whether to keep working or close itself down. This value can be modified from Control Room to bring a session to an early finish.</narrative><display x="-210" y="30" w="150" h="30" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><datatype>number</datatype><initialvalue>9999999999</initialvalue><exposure>Session</exposure><private /><alwaysinit /></stage><stage stageid="eb957176-69ca-436f-b5b8-a0af1c12f549" name="Stopping Control Settings" type="Block"><display x="-300" y="-30" w="180" h="90" /><font family="Tahoma" size="10" style="Regular" color="FF0000" /></stage><stage stageid="d303b2cb-0441-445a-8463-956e2863a1d4" name="Queue Name" type="Data"><display x="-210" y="-75" w="150" h="30" /><font family="Tahoma" size="10" style="Bold" color="0000FF" /><datatype>text</datatype><initialvalue xml:space="preserve">Chapter 6 Example 2 Queue</initialvalue><alwaysinit /></stage><stage stageid="f9d7ca2d-a983-471c-bc79-408b2230269a" name="Process Settings" type="Block"><display x="-300" y="-105" w="180" h="60" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="c46d4291-41ed-4f54-9fce-f5b76838fb18" name="Retry Limit" type="Data"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="-135" y="45" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>3</initialvalue><private /><alwaysinit /></stage><stage stageid="e7d7779b-4ada-4ae1-9722-512eb475bfcd" name="Retry Count" type="Data"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="-135" y="75" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="6fa1db8d-0510-4c35-8416-9a938e94c78d" name="Exception Data" type="MultipleCalculation"><display x="120" y="600" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>53762061-333e-4023-b99f-1de349dfc4a4</onsuccess><steps><calculation expression="ExceptionType()" stage="Exception Type" /><calculation expression="ExceptionDetail()" stage="Exception Detail" /></steps></stage><stage stageid="7105b714-612a-4e50-84b3-f789f0634902" name="Note5" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><loginhibit /><narrative>This exception is different from the previous one.</narrative><display x="150" y="225" w="120" h="90" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>9de6523c-e14d-4937-b854-1b0930857c02</onsuccess></stage><stage stageid="7360eced-01c7-4dc8-a7ef-817d130f1cc5" name="Note5" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><loginhibit /><narrative>This exception is the same as the previous one but the consecutive exception limit has not yet been reached.</narrative><display x="150" y="375" w="120" h="90" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>64a4e876-5092-4568-829b-73faed844a31</onsuccess></stage><stage stageid="daa36ca6-f942-4ebc-86fc-8ba76b19cb4d" name="Note5" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><loginhibit /><narrative>Don't retry this type of exception, just mark the queue item and carry on.</narrative><display x="225" y="30" w="120" h="90" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>a97071fe-23f0-44d4-a04a-1516826f8ace</onsuccess></stage><stage stageid="52e45164-64b2-41fd-b6da-09c88ec7cdf7" name="Mark Exception" type="Action"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative><display x="15" y="150" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Exception Reason" narrative="A description of the reason for the exception" expr="[Exception Detail]" /><input type="flag" name="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="True" /><input type="flag" name="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="False" /></inputs><outputs><output type="text" name="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="New Item ID" /></outputs><onsuccess>a374264f-2dbf-4477-bad7-ee4ba812e5b1</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" /></stage><stage stageid="a97071fe-23f0-44d4-a04a-1516826f8ace" name="Mark Exception" type="Action"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative><display x="345" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Exception Reason" narrative="A description of the reason for the exception" expr="[Exception Detail]" /><input type="flag" name="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="False" /><input type="flag" name="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="False" /></inputs><outputs><output type="text" name="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="New Item ID" /></outputs><onsuccess>e7450b45-6166-42c1-b727-c904883265b5</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" /></stage><stage stageid="f06041aa-ea81-4ef5-b916-b46c6a06f168" name="End1" type="End"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="555" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="6b5864ff-c8f2-4c69-8e1b-d090c057cdc2" name="Tag Item" type="Action"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Adds a tag to a work queue item</narrative><display x="15" y="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the queue item to add the tag to" expr="[Item ID]" /><input type="text" name="Tag" narrative="The tag to add to the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;System Exception&quot;" /></inputs><onsuccess>52e45164-64b2-41fd-b6da-09c88ec7cdf7</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Tag Item" /></stage><stage stageid="6d17105a-27e9-4ac6-8d57-801cf94fefe2" name="Retry Limit" type="Data"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit /><display x="-195" y="105" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>3</initialvalue><private /><alwaysinit /></stage><stage stageid="c16b3a3f-92d4-4cde-a139-24194f2d7952" name="Retry Count" type="Data"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit /><display x="-195" y="135" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="808cbef2-cfe3-460f-ba72-91e0e6283988" name="System Unavailable?" type="Decision"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="15" y="-45" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="Lower([Exception Type])=&quot;system unavailable exception&quot; OR Lower([Exception Type])=&quot;login system exception&quot;" /><ontrue>5669721f-c338-4600-9152-9d0d75cbce7e</ontrue><onfalse>b9fbad6e-b3b1-4e9b-bc71-1b96d40beeb2</onfalse></stage><stage stageid="5669721f-c338-4600-9152-9d0d75cbce7e" name="Release Item" type="Action"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Marks the item as deferred. It is unlocked, but it will not be made available for processing again until the specified time.

The attempts count for the item is reset to zero.</narrative><display x="-120" y="-45" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to defer" expr="[Item ID]" /><input type="datetime" name="Until" narrative="When to resume processing the case" expr="Now()" /></inputs><onsuccess>8500ffb8-f46a-46cf-9ec9-3637f23f10ff</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Defer" /></stage><stage stageid="8500ffb8-f46a-46cf-9ec9-3637f23f10ff" name="TERMINATE" type="Exception"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><display x="-120" y="30" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><exception type="" detail="[Consecutive Exception Limit] &amp; &quot; consecutive incidents of &quot; &amp; [Exception Type] &amp; &quot;: &quot; &amp; [Exception Detail]" /></stage><stage stageid="de2c89a2-171e-4bd8-b1cf-34b1f4040f68" name="Start" type="Start"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit /><display x="-30" y="-30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>5380890d-c761-4a23-8b89-b86262e5acd1</onsuccess></stage><stage stageid="8ff3b78a-04ad-4b33-9fb0-691f386100eb" name="End" type="End"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit /><display x="15" y="465" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="ffdfc19f-b656-4eb8-870d-f179be1f3891" name="Retry Limit" type="Data"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit /><display x="-225" y="45" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>3</initialvalue><private /><alwaysinit /></stage><stage stageid="b7db49cd-d54b-483a-bf59-413986011ce4" name="Retry Count" type="Data"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit /><display x="-225" y="75" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="655536e7-b3fd-4080-9f98-2fe98e6dbbfb" name="Start" type="Start"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><display x="60" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0aebd4a9-50d3-4389-982d-14e4d0f344d1</onsuccess></stage><stage stageid="309d561b-7459-41fc-bdc8-048a46336106" name="Recover" type="Recover"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="255" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8943e5dc-119d-4aef-9e2d-61bc9b4ad225</onsuccess></stage><stage stageid="e43623c9-38bf-47db-b5f0-db158e681de8" name="Resume" type="Resume"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="255" y="45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8d4036c4-fb6d-4b8e-b512-9a713fbc0c0c</onsuccess></stage><stage stageid="2848a429-d5d1-4546-9a1b-16ef0f3c3a0c" name="Count" type="Calculation"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="345" y="45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>e43623c9-38bf-47db-b5f0-db158e681de8</onsuccess><calculation expression="[Retry Count]+1" stage="Retry Count" /></stage><stage stageid="8943e5dc-119d-4aef-9e2d-61bc9b4ad225" name="Retry?" type="Decision"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="345" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Retry Count]&lt;[Retry Limit] AND (Lower(ExceptionType())=&quot;system exception&quot; OR Lower(ExceptionType())=&quot;internal&quot;)" /><ontrue>2848a429-d5d1-4546-9a1b-16ef0f3c3a0c</ontrue><onfalse>f12f8dc4-9c47-4f0b-be74-736b78b0bc2d</onfalse></stage><stage stageid="f12f8dc4-9c47-4f0b-be74-736b78b0bc2d" name="Throw" type="Exception"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="435" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="97b3f0e6-9371-4bab-a12d-c39f8dbf2a41" name="Note3" type="Note"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><narrative>Step 1a</narrative><display x="60" y="45" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>91a71005-8abc-4f43-9615-fec34ccf57df</onsuccess></stage><stage stageid="ee64c95b-60b1-4479-ad29-9e474ce55feb" name="Step 1 Block" type="Block"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><display x="-15" y="0" w="315" h="135" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="91a71005-8abc-4f43-9615-fec34ccf57df" name="Note3" type="Note"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><narrative>Step 1b</narrative><display x="60" y="90" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>dd1ff1be-5f88-4cf7-9047-232b3cde232a</onsuccess></stage><stage stageid="0aebd4a9-50d3-4389-982d-14e4d0f344d1" name="anchor5" type="Anchor"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><display x="60" y="-45" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>97b3f0e6-9371-4bab-a12d-c39f8dbf2a41</onsuccess></stage><stage stageid="dd1ff1be-5f88-4cf7-9047-232b3cde232a" name="End6" type="End"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><display x="60" y="165" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="8d4036c4-fb6d-4b8e-b512-9a713fbc0c0c" name="Note3" type="Note"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><loginhibit /><narrative>Navigate back ready for step 1a - maybe restart application (Close and Start pages)</narrative><display x="255" y="-45" w="180" h="60" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>0aebd4a9-50d3-4389-982d-14e4d0f344d1</onsuccess></stage><stage stageid="ce1f11b6-9a7a-41aa-9e43-0a058afb3c8c" name="Note4" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>System not working or can not log in</narrative><display x="-105" y="-105" w="90" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /><onsuccess>808cbef2-cfe3-460f-ba72-91e0e6283988</onsuccess></stage><stage stageid="8ffb59ed-f576-43df-89b7-8e91fa563bd0" name="Note4" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Check for concurrent exceptions, a system change may have occured</narrative><display x="150" y="135" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /><onsuccess>a374264f-2dbf-4477-bad7-ee4ba812e5b1</onsuccess></stage><stage stageid="23e8a233-85ce-49a2-8a49-032f65ee413b" name="Note4" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>Tag exception category for Blue Prism Performance reports</narrative><display x="150" y="-60" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /><onsuccess>5ce83707-f042-4e73-929c-e7358ebdc456</onsuccess></stage><stage stageid="0b73e13d-4605-495a-88f9-22456673ef57" name="Start" type="Start"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="15" y="195" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>2224f402-cc78-4d9f-ad30-36aaf7c782f2</onsuccess></stage><stage stageid="76aa907d-c3fe-489a-bd3c-6e44ead806ff" name="PS Script" type="Block"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="-270" y="270" w="150" h="60" /><font family="Tahoma" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="a9123fda-6d02-4484-aaf0-14b9b85d6b97" name="Populate Queue" type="SubSheetInfo"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="-180" y="-120" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="275b91ea-8c22-44f7-804b-201f234f19b9" name="Start" type="Start"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="30" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>a62fb73d-4ede-4f55-a9c2-91f7d8be5718</onsuccess></stage><stage stageid="dc7df0cb-5182-477f-8c1e-181fcc08d09b" name="End" type="End"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="210" y="150" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="1db94fff-eca8-49a2-9404-2b6ba6688410" name="Populate Queue" type="SubSheet"><display x="15" y="0" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>85fbb578-f410-4f72-8ca9-58513939bc51</onsuccess><processid>b749d60a-bded-4d36-b099-3627ed699606</processid></stage><stage stageid="fee70eb7-dda6-4069-bfec-62e1ea4809d8" name="Lock Token" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="-180" y="0" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a62fb73d-4ede-4f55-a9c2-91f7d8be5718" name="Aquire Lock" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><narrative>Acquires the lock associated with the given name. If this session already holds the required lock, it will be re-acquired with a new token</narrative><display x="30" y="-60" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Name" narrative="The name of the required lock. Mandatory parameter." expr="[Lock Name]" /><input type="timespan" name="Timeout" narrative="The maximum amount of time to await the lock. Default is to wait forever" expr="MakeTimeSpan(0, 0, 0, 0)" /><input type="text" name="Preferred Token" narrative="The preferred token to use for the lock. Default behaviour is to generate a new unique token." expr="[Lock Token]" /><input type="text" name="Comment" narrative="The comments to set on the lock" expr="&quot;Acquire Lock&quot;" /></inputs><outputs><output type="text" name="Token" narrative="The token registered against the lock. This will be empty if the lock could not be acquired" stage="Lock Token" /></outputs><onsuccess>ea479a64-b2ee-4352-b497-669bf791346a</onsuccess><resource object="BluePrism.AutomateAppCore.clsEnvironmentLockingBusinessObject" action="Acquire Lock" /></stage><stage stageid="318bacb1-b302-4f7b-b4e2-8cb1dd422e25" name="Lock Name" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="-180" y="-30" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">Chapter 6 Example 2 Lock</initialvalue><private /><alwaysinit /></stage><stage stageid="1fe7d33e-bda4-42f2-8389-528c1ad42f60" name="Populate Queue Settings" type="Block"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="-255" y="-60" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="ea479a64-b2ee-4352-b497-669bf791346a" name="Got Lock?" type="Decision"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="30" y="-15" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Lock Token] &lt;&gt; &quot;&quot;" /><ontrue>b2b301fb-9a48-4052-8b93-4c9e44358621</ontrue><onfalse>30e6e9dd-dca0-47d6-b758-8260a5269a57</onfalse></stage><stage stageid="949d4522-7e6e-4e78-b4c0-6b5a82cc49ad" name="End5" type="End"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="240" y="-15" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="30e6e9dd-dca0-47d6-b758-8260a5269a57" name="Note6" type="Note"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><narrative>Another session is loading work</narrative><display x="135" y="-15" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>949d4522-7e6e-4e78-b4c0-6b5a82cc49ad</onsuccess></stage><stage stageid="0bfa9daa-527c-47fb-8383-6cf663d9ee6c" name="Load Work Block" type="Block"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="-75" y="30" w="210" h="510" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="bf23b5fb-a7eb-4f0b-a81c-45b0a4470209" name="Recover" type="Recover"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="180" y="330" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>2741e925-6743-4547-b72c-65c3a5ee6be4</onsuccess></stage><stage stageid="2741e925-6743-4547-b72c-65c3a5ee6be4" name="Release Lock" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><narrative>Releases the lock(s) associated with the given name and token</narrative><display x="270" y="330" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Name" narrative="The name of the specific lock to be released. Default behaviour is to release all locks with the given token." expr="[Lock Name]" /><input type="text" name="Token" narrative="The token associated with the lock(s) to be released. Mandatory parameter." expr="[Lock Token]" /><input type="text" name="Comment" narrative="The comments to set on the lock(s)" expr="&quot;Release Lock&quot;" /><input type="flag" name="All Sessions" narrative="True to release locks matching the specified constraints across all sessions; False to only release locks acquired in the current session. Default is False" expr="True" /></inputs><onsuccess>3088063b-55f9-4d06-944f-ea1edf0e1882</onsuccess><resource object="BluePrism.AutomateAppCore.clsEnvironmentLockingBusinessObject" action="Release Lock" /></stage><stage stageid="3088063b-55f9-4d06-944f-ea1edf0e1882" name="Throw" type="Exception"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="345" y="330" /><font family="Tahoma" size="10" style="Regular" color="000000" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="798a2609-c9b8-49fb-900d-19a17a2a1c74" name="Release Lock" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><narrative>Releases the lock(s) associated with the given name and token</narrative><display x="210" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Name" narrative="The name of the specific lock to be released. Default behaviour is to release all locks with the given token." expr="[Lock Name]" /><input type="text" name="Token" narrative="The token associated with the lock(s) to be released. Mandatory parameter." expr="[Lock Token]" /><input type="text" name="Comment" narrative="The comments to set on the lock(s)" expr="&quot;Release lock&quot;" /><input type="flag" name="All Sessions" narrative="True to release locks matching the specified constraints across all sessions; False to only release locks acquired in the current session. Default is False" expr="True" /></inputs><onsuccess>dc7df0cb-5182-477f-8c1e-181fcc08d09b</onsuccess><resource object="BluePrism.AutomateAppCore.clsEnvironmentLockingBusinessObject" action="Release Lock" /></stage><stage stageid="393e5c0f-7d23-4433-9ad0-a7efc47a783f" name="Note4" type="Note"><subsheetid>bf57723b-f31f-465f-a44d-6b23e78fd2de</subsheetid><narrative>You will need to clean up the application and navigate ready to perform the first action again</narrative><display x="300" y="-135" w="180" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /><onsuccess>8d4036c4-fb6d-4b8e-b512-9a713fbc0c0c</onsuccess></stage><stage stageid="60ff9c2a-74c0-43ce-8d08-313ffc4fa0e8" name="Note4" type="Note"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><narrative>You can take the opportunity when traversing this page to confirm that the target applications are on the correct screen ready for processing the next case.</narrative><display x="120" y="-45" w="150" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /></stage><stage stageid="ac95564f-20e4-4325-a844-ced15edc3dc2" name="Note4" type="Note"><subsheetid>d599353b-a78b-40f4-ab04-255791b86a1a</subsheetid><narrative>The case will only retry if the WQ has been configured to enable retries.</narrative><display x="-90" y="120" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /></stage><stage stageid="1367cffe-d9cb-4483-b9a6-29f59634fb13" name="Success" type="Data"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="-195" y="435" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4be54441-152c-4aec-9d1a-102570288d23" name="Message" type="Data"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="-195" y="465" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="fc00ceef-3266-4c60-af2a-751dd4dcb5d2" name="PS Script Contents" type="Data"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="300" w="120" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">param ($age, $job_id, $salary_range_id, $days_last_purchase, $avg_purchase_size, $rewards_club_points, $gender)
$concat = Write-Output "$($age) $($job_id) $($salary_range_id) $($days_last_purchase) $($avg_purchase_size) $($rewards_club_points) $($gender)"
$hash=[System.Security.Cryptography.HashAlgorithm]::Create("sha256").ComputeHash([System.Text.Encoding]::UTF8.GetBytes($concat))
$hash_str = [System.BitConverter]::ToString($hash).Replace("-","").ToLower()
$nums = $hash_str -replace "[^0-9]", ''
Write-Output "0.$($nums)"</initialvalue><private /><alwaysinit /></stage><stage stageid="2224f402-cc78-4d9f-ad30-36aaf7c782f2" name="Utility - File Management::Write Text File" type="Action"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="285" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The full path to the file to write the text to" expr="[PS Script File Path]" /><input type="text" name="Text" friendlyname="Text" narrative="The text to write to the file" expr="[PS Script Contents]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>2044ecf4-bc37-4a36-8536-7e21f59936b3</onsuccess><resource object="Utility - File Management" action="Write Text File" /></stage><stage stageid="2044ecf4-bc37-4a36-8536-7e21f59936b3" name="File Write Success?" type="Decision"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="15" y="330" w="90" h="30" /><decision expression="[Success]" /><ontrue>24039d62-c2f9-4175-b140-16308c25f311</ontrue><onfalse>8b560626-81ac-4fd3-9ecf-513821b17c15</onfalse></stage><stage stageid="8b560626-81ac-4fd3-9ecf-513821b17c15" name="SE - File write unsuccessful" type="Exception"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="165" y="330" w="90" h="30" /><exception localized="yes" type="System Exception" detail="&quot;SE - File write unsuccessful: &quot; &amp; [Message]" /></stage><stage stageid="13aa1208-da07-44b1-809b-205821c6de1b" name="Note2" type="Note"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><narrative>For purposes of this example, we first write the PS script to disk</narrative><display x="180" y="225" w="90" h="60" /><onsuccess>2224f402-cc78-4d9f-ad30-36aaf7c782f2</onsuccess></stage><stage stageid="cad133c1-c4d2-406a-84af-7a8b40840139" name="Write the Script to Disk" type="Block"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="255" w="135" h="105" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="f37e491b-3315-4449-bcd8-e8c637f8c1bb" name="PS Script File Path" type="Data"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="375" w="120" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">C:\Users\Public\ch6_example2.ps1</initialvalue><alwaysinit /></stage><stage stageid="b3d6ada9-3d75-4f2d-8738-5c7621725b48" name="Change if necessary" type="Block"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="-270" y="345" w="150" h="60" /><font family="Segoe UI" size="10" style="Regular" color="33CCCC" /></stage><stage stageid="4d340ec5-7fd4-4b55-8171-ed587c84eaa4" name="End7" type="End"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="675" /></stage><stage stageid="14f3c27e-8315-4c5c-add2-384f509eb52a" name="Success" type="Data"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="-210" y="-120" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6fb6d556-997e-4cff-8a82-7d0c27cb3198" name="Message" type="Data"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="-210" y="-90" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4845aa0d-6dbe-47fc-ae46-6b35778c7317" name="Exists" type="Data"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="-210" y="-150" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f9758604-8646-4883-90b3-b7e59d317183" name="End" type="End"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="15" y="105" /></stage><stage stageid="73635005-3d4b-4688-a655-29a77eeacf4a" name="Utility - File Management::Delete File" type="Action"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-15" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The full path to the file to delete" expr="[PS Script File Path]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>27cc4c5c-1199-4af3-9f83-7cd6e4c922cd</onsuccess><resource object="Utility - File Management" action="Delete File" /></stage><stage stageid="8edd051f-93cd-4a50-b830-432cc195b19c" name="Utility - File Management::File Exists" type="Action"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-105" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The name of the file to check" expr="[PS Script File Path]" /></inputs><outputs><output type="flag" name="Exists" friendlyname="Exists" narrative="True if the file exists" stage="Exists" /></outputs><onsuccess>3532ab74-1605-46e8-bd40-f2ea17331a16</onsuccess><resource object="Utility - File Management" action="File Exists" /></stage><stage stageid="3532ab74-1605-46e8-bd40-f2ea17331a16" name="PS File Exists?" type="Decision"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="15" y="-60" w="90" h="30" /><decision expression="[Exists]" /><ontrue>73635005-3d4b-4688-a655-29a77eeacf4a</ontrue><onfalse>e7a8f929-d185-4195-88ed-2dd1e11427f2</onfalse></stage><stage stageid="27cc4c5c-1199-4af3-9f83-7cd6e4c922cd" name="File Delete Success?" type="Decision"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="15" y="30" w="90" h="30" /><decision expression="[Success]" /><ontrue>f9758604-8646-4883-90b3-b7e59d317183</ontrue><onfalse>6381877c-5fa2-46ab-bc55-ad45071059db</onfalse></stage><stage stageid="b2cef6df-bccc-40ca-beda-1572e9a738e7" name="Delete Script" type="Block"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="-135" w="150" h="195" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="6381877c-5fa2-46ab-bc55-ad45071059db" name="Anchor2" type="Anchor"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="135" y="30" w="10" h="10" /><onsuccess>7a6c41dd-7548-434f-aa62-7cdc30a67c79</onsuccess></stage><stage stageid="7a6c41dd-7548-434f-aa62-7cdc30a67c79" name="Anchor3" type="Anchor"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="135" y="105" w="10" h="10" /><onsuccess>f9758604-8646-4883-90b3-b7e59d317183</onsuccess></stage><stage stageid="28a77b39-291a-488c-b002-900379be62fc" name="Global Item Data" type="Block"><loginhibit onsuccess="true" /><display x="-300" y="75" w="180" h="180" /><font family="Segoe UI" size="10" style="Regular" color="FF99CC" /></stage><stage stageid="83203064-35b8-4dac-93e3-6d5f9a2e6100" name="Work Queues::Add To Queue" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative><display x="210" y="60" w="120" h="30" /><inputs><input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to add items to" expr="[Queue Name]" /><input type="collection" name="Data" friendlyname="Data" narrative="A collection containing the data, one row for each item to be added" expr="[All Customer Data]" /><input type="datetime" name="Defer Until" friendlyname="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="" /><input type="number" name="Priority" friendlyname="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="" /><input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="" /><input type="text" name="Status" friendlyname="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="" /><input type="number" name="Batch Size" friendlyname="Batch Size" narrative="Optionally, the batch size to use when adding many items to the queue.  A Value of 0 will process all items in one batch.  An empty field will use the default batch size of 1000." expr=""><validator type="BluePrism.AutomateProcessCore.RangeParameterValidation" parameter="0:25000" /></input></inputs><outputs><output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="" /></outputs><onsuccess>798a2609-c9b8-49fb-900d-19a17a2a1c74</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" /></stage><stage stageid="ab59e6a7-01dd-463f-8da7-038aff9933d9" name="Standard Output" type="Data"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><display x="-225" y="135" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1fd430fc-b8f4-4f88-9f61-8e2e3f248926" name="Standard Error" type="Data"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><display x="-225" y="165" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c5264ff4-2786-4297-9690-105eeec823bd" name="Random Number" type="Block"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="-300" y="105" w="150" h="120" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="ea834600-18a0-4541-bf9e-815a6c930706" name="Random Number" type="Data"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="-225" y="195" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b75d1cd6-195a-44be-b56c-38999b45173e" name="Ch6 Example 2 Random Sampling Target" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="300" w="150" h="30" /><datatype>number</datatype><initialvalue>20</initialvalue><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="d3851f14-885d-4b9c-b238-ba314e536caf" name="Global Environment Variables" type="Block"><loginhibit onsuccess="true" /><display x="-300" y="270" w="180" h="165" /><font family="Segoe UI" size="10" style="Regular" color="FF9900" /></stage><stage stageid="fd3de115-7b1e-4758-b300-a7638023e9d5" name="04 Work Step" type="SubSheetInfo"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><display x="-105" y="-90" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="308f43c5-5697-48f7-8dd7-07c460485377" name="Retry Limit" type="Data"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="-135" y="45" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>3</initialvalue><private /><alwaysinit /></stage><stage stageid="74dc342a-19cc-49e7-adde-c458e72b9e78" name="Retry Count" type="Data"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="-135" y="75" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="e813e764-c676-4a19-bfeb-1c7118c7b2d9" name="Start" type="Start"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><display x="60" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>a6820832-c345-4959-9a64-a7078480d0d5</onsuccess></stage><stage stageid="819e7620-6f52-46fa-a35b-dba04bbad22c" name="Recover" type="Recover"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="255" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>4d98824a-8234-4e61-8b13-862fc6c934ea</onsuccess></stage><stage stageid="5327542f-0c16-4773-bed1-134b1f6262b6" name="Resume" type="Resume"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="255" y="45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>62157c97-49f4-4f52-b1ae-ab6a09a6d793</onsuccess></stage><stage stageid="f6e26f1f-c17a-4f43-a63b-e6f1df8d0da2" name="Count" type="Calculation"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="345" y="45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>5327542f-0c16-4773-bed1-134b1f6262b6</onsuccess><calculation expression="[Retry Count]+1" stage="Retry Count" /></stage><stage stageid="4d98824a-8234-4e61-8b13-862fc6c934ea" name="Retry?" type="Decision"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="345" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Retry Count]&lt;[Retry Limit] AND (Lower(ExceptionType())=&quot;system exception&quot; OR Lower(ExceptionType())=&quot;internal&quot;)" /><ontrue>f6e26f1f-c17a-4f43-a63b-e6f1df8d0da2</ontrue><onfalse>51552122-f69e-4d98-a33a-896cdfeebb6e</onfalse></stage><stage stageid="51552122-f69e-4d98-a33a-896cdfeebb6e" name="Throw" type="Exception"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="435" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="477bc1ef-8aa4-45cf-b864-7b4034e8d93a" name="Note3" type="Note"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><narrative>Step 1a</narrative><display x="60" y="45" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>a7b98ee2-7727-40ca-b8f8-05d6a636b3c3</onsuccess></stage><stage stageid="7cf273b6-ed66-4682-b161-9021cb762886" name="Step 1 Block" type="Block"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><display x="-15" y="0" w="315" h="135" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="a7b98ee2-7727-40ca-b8f8-05d6a636b3c3" name="Note3" type="Note"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><narrative>Step 1b</narrative><display x="60" y="90" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>ad22c731-f5e9-41dd-964a-01b2607f9513</onsuccess></stage><stage stageid="a6820832-c345-4959-9a64-a7078480d0d5" name="anchor5" type="Anchor"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><display x="60" y="-45" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>477bc1ef-8aa4-45cf-b864-7b4034e8d93a</onsuccess></stage><stage stageid="ad22c731-f5e9-41dd-964a-01b2607f9513" name="End6" type="End"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><display x="60" y="165" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="62157c97-49f4-4f52-b1ae-ab6a09a6d793" name="Note3" type="Note"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><loginhibit /><narrative>Navigate back ready for step 1a - maybe restart application (Close and Start pages)</narrative><display x="255" y="-45" w="180" h="60" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>a6820832-c345-4959-9a64-a7078480d0d5</onsuccess></stage><stage stageid="d9695bc3-6737-40da-96ca-286d4eac665f" name="Note4" type="Note"><subsheetid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</subsheetid><narrative>You will need to clean up the application and navigate ready to perform the first action again</narrative><display x="300" y="-135" w="180" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /><onsuccess>62157c97-49f4-4f52-b1ae-ab6a09a6d793</onsuccess></stage><stage stageid="5d70865d-4657-4147-a57e-52d267aa7406" name="04 Work Step" type="SubSheet"><loginhibit onsuccess="true" /><display x="120" y="390" w="90" h="30" /><onsuccess>e3035b4a-aba4-4fa5-932e-cbaab6a81b7b</onsuccess><processid>5ad2c3a7-152c-4eb5-ac1c-922e32db3271</processid></stage><stage stageid="9bcdcb8b-ec78-438f-95fe-94b0094840f0" name="Exists" type="Data"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="-195" y="285" w="150" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6cc34200-6b21-444c-b748-3a14d7a51494" name="Redirection File" type="Data"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="-195" y="195" w="150" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="af200597-55d8-450a-8c82-76c4aee03315" name="Inputs" type="Block"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="-285" y="15" w="165" h="60" /><font family="Segoe UI" size="10" style="Regular" color="FF99CC" /></stage><stage stageid="cfd76874-0899-41bb-9f32-28d59207baef" name="Customer Data" type="Collection"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="-195" y="45" w="150" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><singlerow /><field name="age" type="number" /><field name="job_id" type="number" /><field name="salary_range_id" type="number" /><field name="days_last_purchase" type="number" /><field name="avg_purchase_size" type="number" /><field name="rewards_club_points" type="number" /><field name="gender" type="number" /><field name="customer_id" type="text" /></collectioninfo><initialvalue><singlerow /><row><field name="age" type="number" value="" /><field name="job_id" type="number" value="" /><field name="salary_range_id" type="number" value="" /><field name="days_last_purchase" type="number" value="" /><field name="avg_purchase_size" type="number" value="" /><field name="rewards_club_points" type="number" value="" /><field name="gender" type="number" value="" /><field name="customer_id" type="text" value="" /></row></initialvalue></stage><stage stageid="2a85bbad-8ecf-47c2-af3d-6c4525167726" name="Success" type="Data"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="-195" y="225" w="150" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2e7d4557-747d-4c23-900b-70d8639ab426" name="Message" type="Data"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="-195" y="255" w="150" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2abe76be-3b9e-4c3d-8d5c-c92b3ebc8039" name="End" type="End"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="15" y="750" /></stage><stage stageid="b1b2ae36-0b70-42ec-a1ae-a72e789fe88b" name="Predict using PowerShell Script" type="Block"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="45" w="195" h="75" /><font family="Segoe UI" size="10" style="Regular" color="FF9900" /></stage><stage stageid="455fd628-ba19-4e7a-b080-44919a95060f" name="Redirection File Exists?" type="Decision"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="15" y="210" w="90" h="30" /><decision expression="[Exists]" /><ontrue>dae27001-9ee5-41b7-b08c-ea47018feb7f</ontrue><onfalse>699430c6-a94f-4d52-8b83-dd6f24e60632</onfalse></stage><stage stageid="44df47e0-abaa-4bc7-8c74-dece46e8befc" name="Set Redirection File" type="Calculation"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" /><onsuccess>39c91870-34ff-4b16-976b-1f1062bea3c9</onsuccess><calculation expression="&quot;C:\Users\Public\&quot; &amp; [Customer Data.customer_id] &amp; &quot;_&quot; &amp; FormatDateTime(Now(), &quot;yyyy_MM_dd_HH_mm_ss&quot;) &amp; &quot;.txt&quot;" stage="Redirection File" /></stage><stage stageid="6913c8e4-98d7-4e57-9f70-1aa8fe705c3e" name="Utility - File Management::File Exists" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="165" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The name of the file to check" expr="[Redirection File]" /></inputs><outputs><output type="flag" name="Exists" friendlyname="Exists" narrative="True if the file exists" stage="Exists" /></outputs><onsuccess>455fd628-ba19-4e7a-b080-44919a95060f</onsuccess><resource object="Utility - File Management" action="File Exists" /></stage><stage stageid="dae27001-9ee5-41b7-b08c-ea47018feb7f" name="Utility - File Management::Read All Text from File" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="255" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The full path the file to read the text from" expr="[Redirection File]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /><output type="text" name="Text" friendlyname="Text" narrative="The text of the file" stage="Text Result" /></outputs><onsuccess>9bd7147c-0f18-49e4-bf63-906dad06db5e</onsuccess><resource object="Utility - File Management" action="Read All Text from File" /></stage><stage stageid="9bd7147c-0f18-49e4-bf63-906dad06db5e" name="File Has Text?" type="Decision"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="15" y="300" /><decision expression="Trim([Text Result]) &lt;&gt; &quot;&quot;" /><ontrue>e637404c-ce57-4e4b-84c1-d1c53410a870</ontrue><onfalse>5c9c9152-eef3-4e2f-974b-abca9541046a</onfalse></stage><stage stageid="5c9c9152-eef3-4e2f-974b-abca9541046a" name="Anchor5" type="Anchor"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="285" y="300" w="10" h="10" /><onsuccess>699430c6-a94f-4d52-8b83-dd6f24e60632</onsuccess></stage><stage stageid="58b03554-ea40-430f-b21e-1bb32f36f5ab" name="Read Prediction from Redirected File" type="Block"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="135" w="195" h="285" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e637404c-ce57-4e4b-84c1-d1c53410a870" name="Utility - File Management::Delete File" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="345" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The full path to the file to delete" expr="[Redirection File]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="" /></outputs><onsuccess>8a6fb4f0-a823-495a-8073-a10fcb14679e</onsuccess><resource object="Utility - File Management" action="Delete File" /></stage><stage stageid="f2851675-f356-49d2-a8c2-e6ec8d4917f5" name="Utility - Environment::Run Process Until Ended" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="90" w="90" h="30" /><inputs><input type="text" name="Application" friendlyname="Application" narrative="The application or shortcut to start" expr="&quot;powershell.exe&quot;" /><input type="text" name="Arguments" friendlyname="Arguments" narrative="Optional - any arguments needed to run the application" expr="Chr(34) &amp; [PS Script File Path] &amp; Chr(34) &amp; &quot; &quot; &amp; [Item Data.age] &amp; &quot; &quot; &amp; [Item Data.job_id] &amp; &quot; &quot; &amp; [Item Data.salary_range_id] &amp; &quot; &quot; &amp; [Item Data.days_last_purchase] &amp; &quot; &quot; &amp; [Item Data.avg_purchase_size] &amp; &quot; &quot; &amp; [Item Data.rewards_club_points] &amp; &quot; &quot; &amp; [Item Data.gender] &amp; &quot; &gt; &quot; &amp; Chr(34) &amp; [Redirection File] &amp; Chr(34)" /><input type="text" name="Working Folder" friendlyname="Working Folder" narrative="Optional - the application working folder" expr="" /><input type="timespan" name="Timeout" friendlyname="Timeout" narrative="How long to wait for the application to finish. Default is 10 seconds" expr="MakeTimeSpan(0, 0, 0, 5)" /></inputs><onsuccess>6913c8e4-98d7-4e57-9f70-1aa8fe705c3e</onsuccess><resource object="Utility - Environment" action="Run Process Until Ended" /></stage><stage stageid="39c91870-34ff-4b16-976b-1f1062bea3c9" name="Anchor4" type="Anchor"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="15" w="10" h="10" /><onsuccess>f2851675-f356-49d2-a8c2-e6ec8d4917f5</onsuccess></stage><stage stageid="ca12687e-b64e-4e33-9336-99ccd9a9872a" name="Note1" type="Note"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><narrative>We need to have a unique filename for each prediction so that we can identify which prediction belongs to which customer</narrative><display x="165" y="-30" w="150" h="60" /></stage><stage stageid="19b9cab7-26df-4e7f-9a0a-2206d979d125" name="Retry Prediction?" type="Decision"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="285" y="90" /><decision expression="[Retry Count] &lt; [Retry Limit]" /><ontrue>350ad464-6d9b-4a16-9072-8190c0fe16eb</ontrue><onfalse>92a02da2-8615-4611-a653-d677ad8a747b</onfalse></stage><stage stageid="92a02da2-8615-4611-a653-d677ad8a747b" name="SE - Prediction failed" type="Exception"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="390" y="90" /><exception localized="yes" type="System Exception" detail="&quot;SE - Prediction failed&quot;" /></stage><stage stageid="67abb526-c982-479a-b148-258b34461286" name="Recover1" type="Recover"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit /><display x="105" y="90" /><onsuccess>f191df90-81b3-47c4-b8e8-b551ab946cf6</onsuccess></stage><stage stageid="f191df90-81b3-47c4-b8e8-b551ab946cf6" name="Resume1" type="Resume"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit /><display x="195" y="90" /><onsuccess>19b9cab7-26df-4e7f-9a0a-2206d979d125</onsuccess></stage><stage stageid="699430c6-a94f-4d52-8b83-dd6f24e60632" name="Anchor2" type="Anchor"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="285" y="210" w="10" h="10" /><onsuccess>19b9cab7-26df-4e7f-9a0a-2206d979d125</onsuccess></stage><stage stageid="350ad464-6d9b-4a16-9072-8190c0fe16eb" name="[Retry Count]+1" type="Calculation"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="285" y="15" /><onsuccess>39c91870-34ff-4b16-976b-1f1062bea3c9</onsuccess><calculation expression="[Retry Count]+1" stage="Retry Count" /></stage><stage stageid="8a6fb4f0-a823-495a-8073-a10fcb14679e" name="Convert to Number" type="Calculation"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="390" /><onsuccess>c3dce272-0974-4eb7-933f-6141ac5dcc09</onsuccess><calculation expression="ToNumber([Text Result])" stage="Confidence Score" /></stage><stage stageid="c3dce272-0974-4eb7-933f-6141ac5dcc09" name="Confidence Score &gt;= 0.5" type="Decision"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><display x="15" y="450" /><decision expression="[Confidence Score] &gt;= 0.5" /><ontrue>d7f6eef2-a349-4990-b8f6-434b2676406f</ontrue><onfalse>ca661ce8-1088-4da7-ad1a-956869d26d62</onfalse></stage><stage stageid="d7f6eef2-a349-4990-b8f6-434b2676406f" name="Churn" type="Calculation"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="495" /><onsuccess>a066446b-56bd-467c-b27e-dd72348d74cb</onsuccess><calculation expression="&quot;Churn&quot;" stage="Label" /></stage><stage stageid="ca661ce8-1088-4da7-ad1a-956869d26d62" name="Not Churn" type="MultipleCalculation"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="75" y="495" /><onsuccess>a066446b-56bd-467c-b27e-dd72348d74cb</onsuccess><steps><calculation expression="&quot;Not Churn&quot;" stage="Label" /><calculation expression="1-[Confidence Score]" stage="Confidence Score" /></steps></stage><stage stageid="654cc1a6-25bf-47e3-b717-1f16f5f80107" name="Recover2" type="Recover"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit /><display x="105" y="390" /><onsuccess>418f1059-f4c8-4fd1-9756-6df99209cb71</onsuccess></stage><stage stageid="418f1059-f4c8-4fd1-9756-6df99209cb71" name="Resume2" type="Resume"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit /><display x="195" y="390" /><onsuccess>86381e71-723c-4548-b387-3d598afb8741</onsuccess></stage><stage stageid="86381e71-723c-4548-b387-3d598afb8741" name="Anchor7" type="Anchor"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="285" y="390" w="10" h="10" /><onsuccess>5c9c9152-eef3-4e2f-974b-abca9541046a</onsuccess></stage><stage stageid="5b98aaa6-56f8-49fa-8b7e-29265297ea5c" name="Text Result" type="Data"><display x="-210" y="480" w="150" h="30" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="03028732-0b21-4fe8-88f5-e2183cae6fd7" name="Global Prediction Results" type="Block"><loginhibit onsuccess="true" /><display x="-300" y="450" w="180" h="120" /><font family="Segoe UI" size="10" style="Regular" color="C0C0C0" /></stage><stage stageid="31b57a2c-088f-4b84-87fa-0c759c58e8a3" name="Confidence Score" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="510" w="150" h="30" /><datatype>number</datatype><initialvalue /><alwaysinit /></stage><stage stageid="4308dfed-7fbf-425d-99d4-b21f9ce25b57" name="Label" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="540" w="150" h="30" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="b5d8c493-eafe-4e79-a157-25bc8c338de2" name="All Customer Data" type="Collection"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="-180" y="60" w="150" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="age" type="number" /><field name="job_id" type="number" /><field name="salary_range_id" type="number" /><field name="days_last_purchase" type="number" /><field name="avg_purchase_size" type="number" /><field name="rewards_club_points" type="number" /><field name="gender" type="number" /><field name="customer_id" type="text" /></collectioninfo></stage><stage stageid="d7f2b506-2fc6-49f9-bd28-2f9d3c46340c" name="Utility - Environment::Start Process Read Stderr and Stdout" type="Action"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="-30" y="60" w="90" h="30" /><inputs><input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments that coincide with the process." expr="&quot;Get-Random -Minimum 1.0 -Maximum 100.0&quot;" /><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to start." expr="&quot;powershell.exe&quot;" /></inputs><outputs><output type="text" name="Standard Output" friendlyname="Standard Output" stage="Standard Output" /><output type="text" name="Standard Error" friendlyname="Standard Error" stage="Standard Error" /></outputs><onsuccess>392823ce-3cde-46d8-90df-f8443ccd571e</onsuccess><resource object="Utility - Environment" action="Start Process Read Stderr and Stdout" /></stage><stage stageid="34830b12-5fe3-43df-aede-68a24f035a1f" name="Require Manual Review?" type="Decision"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><display x="-30" y="150" w="90" h="30" /><decision expression="[Random Number] &lt; [Ch6 Example 2 Random Sampling Target]" /><ontrue>a6f84ba7-a8bd-4b41-980e-32463993a050</ontrue><onfalse>6aac182e-44f2-42ad-9021-1fd5ae0fdc59</onfalse></stage><stage stageid="392823ce-3cde-46d8-90df-f8443ccd571e" name="Convert to Number" type="Calculation"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="-30" y="105" w="90" h="30" /><onsuccess>34830b12-5fe3-43df-aede-68a24f035a1f</onsuccess><calculation expression="ToNumber([Standard Output])" stage="Random Number" /></stage><stage stageid="8ad1285b-0276-4db6-84ea-bcfe4f925573" name="Note7" type="Note"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><narrative>Generate a Random Number using PowerShell</narrative><display x="105" y="60" w="120" h="30" /><onsuccess>d7f2b506-2fc6-49f9-bd28-2f9d3c46340c</onsuccess></stage><stage stageid="c3a38aad-bba2-4db4-afae-4c1b6fb64d04" name="Manual Review Required" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="615" w="150" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><alwaysinit /></stage><stage stageid="a738625c-dd45-497d-b628-2345e6c09b97" name="Global Random Sampling Result" type="Block"><loginhibit onsuccess="true" /><display x="-300" y="585" w="180" h="60" /><font family="Segoe UI" size="10" style="Regular" color="CC99FF" /></stage><stage stageid="5380890d-c761-4a23-8b89-b86262e5acd1" name="Set Manual Review to True" type="Calculation"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="-30" y="15" w="90" h="30" /><onsuccess>d7f2b506-2fc6-49f9-bd28-2f9d3c46340c</onsuccess><calculation expression="True" stage="Manual Review Required" /></stage><stage stageid="a6f84ba7-a8bd-4b41-980e-32463993a050" name="End4" type="End"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="-30" y="195" /></stage><stage stageid="6aac182e-44f2-42ad-9021-1fd5ae0fdc59" name="Set Manual Review to False" type="Calculation"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="75" y="150" w="90" h="30" /><onsuccess>7f50af95-dd3b-4335-b0a0-6d6b7375bfe2</onsuccess><calculation expression="False" stage="Manual Review Required" /></stage><stage stageid="7f50af95-dd3b-4335-b0a0-6d6b7375bfe2" name="Anchor8" type="Anchor"><subsheetid>47e58161-0f42-47cc-aa94-af755a8de010</subsheetid><loginhibit onsuccess="true" /><display x="75" y="195" w="10" h="10" /><onsuccess>a6f84ba7-a8bd-4b41-980e-32463993a050</onsuccess></stage><stage stageid="eb15fe18-d64f-4ffc-a07b-90af38776ded" name="Manual Review?" type="Decision"><display x="120" y="330" w="90" h="30" /><decision expression="[Manual Review Required]" /><ontrue>5fe63bae-23eb-4645-92fc-45220651bca4</ontrue><onfalse>5d70865d-4657-4147-a57e-52d267aa7406</onfalse></stage><stage stageid="4dacfcdf-d936-4a4c-b66b-9057cffd0bb4" name="Update Status and Tag for Manual Review" type="SubSheetInfo"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><narrative>Write out the excel files that need review, update the item status, and defer the item</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="5de429f4-b33e-4c34-a6e7-c8ee524d6036" name="Start" type="Start"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><display x="15" y="-120" /><onsuccess>9cf51c94-58fe-45ec-b14a-c50ba96985ef</onsuccess></stage><stage stageid="8f0985cb-d08c-42d9-9a58-a003f3756a9a" name="End" type="End"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><display x="15" y="135" /></stage><stage stageid="5fe63bae-23eb-4645-92fc-45220651bca4" name="Update Status and Tag for Manual Review" type="SubSheet"><loginhibit onsuccess="true" /><display x="285" y="330" w="90" h="30" /><onsuccess>1cfde7f1-28bb-4c91-973d-915317f4f54e</onsuccess><processid>aef794a5-348a-4de6-9810-f7f57b96166b</processid></stage><stage stageid="1cfde7f1-28bb-4c91-973d-915317f4f54e" name="Anchor9" type="Anchor"><loginhibit onsuccess="true" /><display x="390" y="330" w="10" h="10" /><onsuccess>bef8f1ff-727a-4e0a-b29e-ed73fb6f0147</onsuccess></stage><stage stageid="9cf51c94-58fe-45ec-b14a-c50ba96985ef" name="Set Status" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><narrative>Updates the status field for the item. The status field can be used to flag what has been done in a process so far. If a process encounters an exception, this information can be used to skip to the parts of the process not yet done for the item next time it is worked. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.

This action will also reset the Attempts column to zero, because if the status updated the process should have successfully done something.</narrative><display x="15" y="-75" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Status" narrative="The new status - 255 characters maximum." expr="&quot;Manual Review Required&quot;" /></inputs><onsuccess>7efce76a-3f4a-4be7-9ad6-9dcdd21fa959</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Update Status" /></stage><stage stageid="b071d707-2613-4eb1-b5fc-de9a12ab0b29" name="Reset Consecutive Exception Indicators" type="MultipleCalculation"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><display x="15" y="75" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8f0985cb-d08c-42d9-9a58-a003f3756a9a</onsuccess><steps><calculation expression="&quot;&quot;" stage="Previous Exception Detail" /><calculation expression="0" stage="Consecutive Exception Count" /></steps></stage><stage stageid="e5389da9-0767-440a-9800-4a3845529302" name="Check Status" type="ChoiceStart"><display x="-60" y="135" /><groupid>6c8a1f10-8152-42c6-91b3-264a1fe1781e</groupid><choices><choice expression="[Item Status] = &quot;&quot;"><name>Empty Status</name><distance>60</distance><ontrue>f52977fa-5395-47ee-a08b-35f92f89554c</ontrue></choice><choice expression="[Item Status] = &quot;Prediction Complete&quot;"><name>Prediction Complete</name><distance>150</distance><ontrue>731b1d6d-580d-4e96-9d99-20280f13ae57</ontrue></choice><choice expression="[Item Status] = &quot;Manual Review Required&quot;"><name>Manual Review Required</name><distance>195</distance><ontrue>83e93808-6085-487b-8367-5b2e09081fde</ontrue></choice><choice expression="[Item Status] = &quot;Manual Review Complete&quot;"><name>Manual Review Complete</name><distance>255</distance><ontrue>5d70865d-4657-4147-a57e-52d267aa7406</ontrue></choice></choices></stage><stage stageid="67152e54-cfe7-46a2-9e09-ecd2c66418fa" name="Otherwise1" type="ChoiceEnd"><display x="-60" y="450" /><onsuccess>3cfd9db1-a593-4215-b1e1-9d0708a939e5</onsuccess><groupid>6c8a1f10-8152-42c6-91b3-264a1fe1781e</groupid></stage><stage stageid="b2882ef7-4b96-44fe-974c-0c0833e543bc" name="Anchor10" type="Anchor"><loginhibit onsuccess="true" /><display x="120" y="135" w="10" h="10" /><onsuccess>e5389da9-0767-440a-9800-4a3845529302</onsuccess></stage><stage stageid="4d1c5743-1440-4ff5-b9ac-35ba877c5386" name="Set Status" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><narrative>Updates the status field for the item. The status field can be used to flag what has been done in a process so far. If a process encounters an exception, this information can be used to skip to the parts of the process not yet done for the item next time it is worked. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.

This action will also reset the Attempts column to zero, because if the status updated the process should have successfully done something.</narrative><display x="15" y="690" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Status" narrative="The new status - 255 characters maximum." expr="&quot;Prediction Complete&quot;" /></inputs><onsuccess>2abe76be-3b9e-4c3d-8d5c-c92b3ebc8039</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Update Status" /></stage><stage stageid="a066446b-56bd-467c-b27e-dd72348d74cb" name="Add Confidence Score to Item Data" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="555" w="90" h="30" /><inputs><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Item Data]" /><input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;Confidence Score&quot;" /><input type="number" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="[Confidence Score]" /></inputs><outputs><output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Item Data" /></outputs><onsuccess>8bc2527a-e555-4a10-8dfa-0615973102d3</onsuccess><resource object="Utility - Collection Manipulation" action="Append Field (Number)" /></stage><stage stageid="8bc2527a-e555-4a10-8dfa-0615973102d3" name="Add Label to Item Data" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="600" w="90" h="30" /><inputs><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Item Data]" /><input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;Label&quot;" /><input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="[Label]" /></inputs><outputs><output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Item Data" /></outputs><onsuccess>edf53ff3-9fb9-4989-88d2-37fff87a36bb</onsuccess><resource object="Utility - Collection Manipulation" action="Append Field (Text)" /></stage><stage stageid="edf53ff3-9fb9-4989-88d2-37fff87a36bb" name="Work Queues::Set Data" type="Action"><subsheetid>4f5f8a61-abf2-40dd-8169-d8ab45ffd78c</subsheetid><loginhibit onsuccess="true" /><narrative>Sets the data on the specified item to the given value. 
The collection must contain one row exactly, and the key field, if present, must match the key field of the item being updated.
Also, the item must currently be locked by the current session - ie. it must have been retrieved using the 'Get Next' action.</narrative><display x="15" y="645" w="90" h="30" /><inputs><input type="collection" name="Data" friendlyname="Data" narrative="A collection with one row containing the data to be set on the item. If the item has a key value and this collection has a key value, they should match exactly." expr="[Item Data]" /><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the work item to set the data on. This item should be locked by the calling session." expr="[Item ID]" /></inputs><onsuccess>4d1c5743-1440-4ff5-b9ac-35ba877c5386</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Set Data" /></stage><stage stageid="83e93808-6085-487b-8367-5b2e09081fde" name="Set Manual Review to True" type="Calculation"><loginhibit onsuccess="true" /><display x="0" y="330" /><onsuccess>eb15fe18-d64f-4ffc-a07b-90af38776ded</onsuccess><calculation expression="True" stage="Manual Review Required" /></stage><stage stageid="3cfd9db1-a593-4215-b1e1-9d0708a939e5" name="SE - Unknown Item Status" type="Exception"><display x="120" y="450" /><exception localized="yes" type="System Exception" detail="&quot;SE - Unknown Item Status&quot;" /></stage><stage stageid="f4a84d64-8865-4e4c-a00f-7319f1263e82" name="Ch6 Example 2 To Review Folder Path" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="345" w="150" h="30" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="2b902881-f99f-435c-ae3d-5621d119e53c" name="Ch6 Example 2 Completed Review Folder Path" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="375" w="150" h="30" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="610d38a3-618a-4005-a0df-ea0864561a3d" name="Standard Error" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="-180" y="120" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a9e17291-3f10-4898-9a10-be3bbf3e97b5" name="Random Text Number" type="Block"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-255" y="90" w="150" h="180" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="6be513d0-ce24-4e64-9795-461d39a8fb75" name="Customers to Generate" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="345" w="120" h="30" /><datatype>number</datatype><initialvalue>13</initialvalue><private /><alwaysinit /></stage><stage stageid="9e9622b0-6c96-421f-afb9-5d1e9e44ad9d" name="Count" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="375" w="120" h="30" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="b2b301fb-9a48-4052-8b93-4c9e44358621" name="Continue Generating Customers?" type="Decision"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><display x="30" y="60" w="90" h="30" /><decision expression="[Count] &lt; [Customers to Generate]" /><ontrue>5c6b0793-e0f0-4d3d-be9a-21d844ceca76</ontrue><onfalse>83203064-35b8-4dac-93e3-6d5f9a2e6100</onfalse></stage><stage stageid="34f693a4-f763-429a-9aaf-cd470f46c18d" name="age and job_id" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="150" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0192aa35-c409-4a38-9197-e3dfde8b0eef" name="salary_range_id and rewards_club_points" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="180" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ff74c11f-6e3c-4a89-9953-5eba6cee5ae0" name="days_last_purchase and avg_purchase_size" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="210" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="37c7fdc6-1d48-45c5-bfa3-03a138dbe4a8" name="gender" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="240" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="62571d0f-3830-4e36-9008-37b5aa73a429" name="customer_id" type="Data"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-180" y="300" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="172d4798-cbe0-4e3d-b157-9f329487cc79" name="Utility - Strings::Generate New GUID" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="375" w="120" h="30" /><outputs><output type="text" name="GUID" friendlyname="GUID" narrative="The new guid" stage="customer_id" /></outputs><onsuccess>053fb854-372a-4779-880c-e854a64c1621</onsuccess><resource object="Utility - Strings" action="Generate New GUID" /></stage><stage stageid="053fb854-372a-4779-880c-e854a64c1621" name="Collections::Add Row" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="420" w="120" h="30" /><inputs><input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;All Customer Data&quot;" /></inputs><onsuccess>f26d765d-ee3b-42a6-9048-bf4e5db28e02</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" /></stage><stage stageid="f26d765d-ee3b-42a6-9048-bf4e5db28e02" name="Set Customer Data" type="MultipleCalculation"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="465" w="90" h="30" /><onsuccess>29e4fb6c-ed0b-4ded-a581-1355565291cf</onsuccess><steps><calculation expression="ToNumber(Right([age and job_id], 2))" stage="All Customer Data.age" /><calculation expression="ToNumber(Left([age and job_id], 1))" stage="All Customer Data.job_id" /><calculation expression="ToNumber(Right([salary_range_id and rewards_club_points], 2))" stage="All Customer Data.salary_range_id" /><calculation expression="ToNumber(Left([salary_range_id and rewards_club_points],4))" stage="All Customer Data.rewards_club_points" /><calculation expression="ToNumber(Right([days_last_purchase and avg_purchase_size], 2))" stage="All Customer Data.avg_purchase_size" /><calculation expression="Left([customer_id], 7)" stage="All Customer Data.customer_id" /><calculation expression="ToNumber(Left([days_last_purchase and avg_purchase_size], 3))" stage="All Customer Data.days_last_purchase" /><calculation expression="RndDn(2*[Count]/[Customers to Generate],0)" stage="All Customer Data.gender" /></steps></stage><stage stageid="29e4fb6c-ed0b-4ded-a581-1355565291cf" name="Increment Count" type="Calculation"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="510" /><onsuccess>65cf6e76-0ebe-4993-875d-8985e0452260</onsuccess><calculation expression="[Count]+1" stage="Count" /></stage><stage stageid="65cf6e76-0ebe-4993-875d-8985e0452260" name="Anchor11" type="Anchor"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-60" y="510" w="10" h="10" /><onsuccess>ebaae007-1b85-4df9-9a30-ccefa2be725b</onsuccess></stage><stage stageid="ebaae007-1b85-4df9-9a30-ccefa2be725b" name="Anchor12" type="Anchor"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="-60" y="60" w="10" h="10" /><onsuccess>b2b301fb-9a48-4052-8b93-4c9e44358621</onsuccess></stage><stage stageid="35b56903-2b8b-4935-9a7e-1b35a712cc53" name="Success?" type="Decision"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="15" y="525" w="90" h="30" /><decision expression="[Success]" /><ontrue>454a6c89-f65f-4697-9b94-85569a625992</ontrue><onfalse>b8e82045-9ae6-4470-b2e2-b3fcfefb6dba</onfalse></stage><stage stageid="b8e82045-9ae6-4470-b2e2-b3fcfefb6dba" name="SE - To Review Folder does not exist" type="Exception"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="165" y="525" w="90" h="30" /><exception localized="yes" type="System Exception" detail="&quot;SE - To Review Folder does not exist: &quot; &amp; [Ch6 Example 2 To Review Folder Path]" /></stage><stage stageid="5e1ba49e-c205-4215-ae0f-6a7c63a2d240" name="SE - Completed Review Folder does not exist" type="Exception"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="165" y="435" w="90" h="30" /><exception localized="yes" type="System Exception" detail="&quot;SE - Completed Review Folder does not exist: &quot; &amp; [Ch6 Example 2 Completed Review Folder Path]" /></stage><stage stageid="24039d62-c2f9-4175-b140-16308c25f311" name="Create Completed Review Folder" type="Action"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="390" w="90" h="30" /><inputs><input type="text" name="Directory Path" friendlyname="Directory Path" narrative="The path in which to create the directory" expr="[Ch6 Example 2 Completed Review Folder Path]" /><input type="flag" name="Error If Already Exists" friendlyname="Error If Already Exists" narrative="True to generate an error if the directory already exists" expr="False" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>cdd49fcb-4079-4b15-9e26-0baf3fedefc3</onsuccess><resource object="Utility - File Management" action="Create Directory" /></stage><stage stageid="cdd49fcb-4079-4b15-9e26-0baf3fedefc3" name="Success?" type="Decision"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="15" y="435" w="90" h="30" /><decision expression="[Success]" /><ontrue>42a8b679-94d6-4dbb-870e-e78d92c65006</ontrue><onfalse>5e1ba49e-c205-4215-ae0f-6a7c63a2d240</onfalse></stage><stage stageid="42a8b679-94d6-4dbb-870e-e78d92c65006" name="Create To Review Folder" type="Action"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="480" w="90" h="30" /><inputs><input type="text" name="Directory Path" friendlyname="Directory Path" narrative="The path in which to create the directory" expr="[Ch6 Example 2 To Review Folder Path]" /><input type="flag" name="Error If Already Exists" friendlyname="Error If Already Exists" narrative="True to generate an error if the directory already exists" expr="False" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>35b56903-2b8b-4935-9a7e-1b35a712cc53</onsuccess><resource object="Utility - File Management" action="Create Directory" /></stage><stage stageid="c8af4392-5cc7-4181-acc6-f2cba890aa5e" name="Ch6 Example 2 Temporary Review Folder Path" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="405" w="150" h="30" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="4861b6f7-1f8b-4844-8164-e6fd41cfc898" name="Success?" type="Decision"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="15" y="615" w="90" h="30" /><decision expression="[Success]" /><ontrue>4d340ec5-7fd4-4b55-8171-ed587c84eaa4</ontrue><onfalse>702680be-a3f5-418a-9203-cd1c6e8d397d</onfalse></stage><stage stageid="702680be-a3f5-418a-9203-cd1c6e8d397d" name="SE - Temporary Review Folder does not exist" type="Exception"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><display x="165" y="615" w="90" h="30" /><exception localized="yes" type="System Exception" detail="&quot;SE - Temporary Review Folder does not exist: &quot; &amp; [Ch6 Example 2 Temporary Review Folder Path]" /></stage><stage stageid="454a6c89-f65f-4697-9b94-85569a625992" name="Create Temporary Review Folder" type="Action"><subsheetid>8f814e4a-ce3a-4fd2-8a04-5f2b890ceba7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="570" w="90" h="30" /><inputs><input type="text" name="Directory Path" friendlyname="Directory Path" narrative="The path in which to create the directory" expr="[Ch6 Example 2 Temporary Review Folder Path]" /><input type="flag" name="Error If Already Exists" friendlyname="Error If Already Exists" narrative="True to generate an error if the directory already exists" expr="False" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>4861b6f7-1f8b-4844-8164-e6fd41cfc898</onsuccess><resource object="Utility - File Management" action="Create Directory" /></stage><stage stageid="7efce76a-3f4a-4be7-9ad6-9dcdd21fa959" name="Set Tag" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><narrative>Adds a tag to a work queue item</narrative><display x="15" y="-30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the queue item to add the tag to" expr="[Item ID]" /><input type="text" name="Tag" friendlyname="Tag" narrative="The tag to add to the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;Manual Review Required&quot;" /></inputs><onsuccess>280c3d16-d170-43da-884e-c34b20c24419</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Tag Item" /></stage><stage stageid="5c6b0793-e0f0-4d3d-be9a-21d844ceca76" name="Utility - Strings::Generate New GUID" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="105" w="120" h="30" /><outputs><output type="text" name="GUID" friendlyname="GUID" narrative="The new guid" stage="age and job_id" /></outputs><onsuccess>947c9270-100d-43da-9855-72808fc81439</onsuccess><resource object="Utility - Strings" action="Generate New GUID" /></stage><stage stageid="7a0c31df-bcab-4aaf-bf0e-0835c076f988" name="Utility - Strings::Generate New GUID" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="195" w="120" h="30" /><outputs><output type="text" name="GUID" friendlyname="GUID" narrative="The new guid" stage="salary_range_id and rewards_club_points" /></outputs><onsuccess>c3ee0c3b-0a96-48d0-9abb-fe34586190ae</onsuccess><resource object="Utility - Strings" action="Generate New GUID" /></stage><stage stageid="947c9270-100d-43da-9855-72808fc81439" name="Utility - Strings::Delete Characters" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="150" w="120" h="30" /><inputs><input type="text" name="Text Sample" friendlyname="Text Sample" narrative="The piece of text to be operated on" expr="[age and job_id]" /><input type="text" name="Characters to Delete" friendlyname="Characters to Delete" narrative="A string of characters to be deleted from the Text Sample" expr="&quot;abcdefghijklmnopqrstuvwxyz-&quot;" /></inputs><outputs><output type="text" name="Amended Sample" friendlyname="Amended Sample" narrative="The amended sample, with the characters deleted" stage="age and job_id" /></outputs><onsuccess>7a0c31df-bcab-4aaf-bf0e-0835c076f988</onsuccess><resource object="Utility - Strings" action="Delete Characters" /></stage><stage stageid="5a849727-6ea7-4872-939b-7465865cb28f" name="Utility - Strings::Generate New GUID" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="285" w="120" h="30" /><outputs><output type="text" name="GUID" friendlyname="GUID" narrative="The new guid" stage="days_last_purchase and avg_purchase_size" /></outputs><onsuccess>ea23fcdd-4396-48e1-9051-a01f2e78fa02</onsuccess><resource object="Utility - Strings" action="Generate New GUID" /></stage><stage stageid="c3ee0c3b-0a96-48d0-9abb-fe34586190ae" name="Utility - Strings::Delete Characters" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="240" w="120" h="30" /><inputs><input type="text" name="Text Sample" friendlyname="Text Sample" narrative="The piece of text to be operated on" expr="[salary_range_id and rewards_club_points]" /><input type="text" name="Characters to Delete" friendlyname="Characters to Delete" narrative="A string of characters to be deleted from the Text Sample" expr="&quot;abcdefghijklmnopqrstuvwxyz-&quot;" /></inputs><outputs><output type="text" name="Amended Sample" friendlyname="Amended Sample" narrative="The amended sample, with the characters deleted" stage="salary_range_id and rewards_club_points" /></outputs><onsuccess>5a849727-6ea7-4872-939b-7465865cb28f</onsuccess><resource object="Utility - Strings" action="Delete Characters" /></stage><stage stageid="ea23fcdd-4396-48e1-9051-a01f2e78fa02" name="Utility - Strings::Delete Characters" type="Action"><subsheetid>b749d60a-bded-4d36-b099-3627ed699606</subsheetid><loginhibit onsuccess="true" /><display x="30" y="330" w="120" h="30" /><inputs><input type="text" name="Text Sample" friendlyname="Text Sample" narrative="The piece of text to be operated on" expr="[days_last_purchase and avg_purchase_size]" /><input type="text" name="Characters to Delete" friendlyname="Characters to Delete" narrative="A string of characters to be deleted from the Text Sample" expr="&quot;abcdefghijklmnopqrstuvwxyz-&quot;" /></inputs><outputs><output type="text" name="Amended Sample" friendlyname="Amended Sample" narrative="The amended sample, with the characters deleted" stage="days_last_purchase and avg_purchase_size" /></outputs><onsuccess>172d4798-cbe0-4e3d-b157-9f329487cc79</onsuccess><resource object="Utility - Strings" action="Delete Characters" /></stage><stage stageid="280c3d16-d170-43da-884e-c34b20c24419" name="Work Queues::Defer" type="Action"><subsheetid>aef794a5-348a-4de6-9810-f7f57b96166b</subsheetid><loginhibit onsuccess="true" /><narrative>Marks the item as deferred. It is unlocked, but it will not be made available for processing again until the specified time.

The attempts count for the item is reset to zero.</narrative><display x="15" y="15" /><inputs><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to defer" expr="[Item ID]" /><input type="datetime" name="Until" friendlyname="Until" narrative="When to resume processing the case" expr="Now() + MakeTimeSpan(0, 0, 0, 5)" /></inputs><onsuccess>b071d707-2613-4eb1-b5fc-de9a12ab0b29</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Defer" /></stage><stage stageid="e7a8f929-d185-4195-88ed-2dd1e11427f2" name="Anchor1" type="Anchor"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="135" y="-60" w="10" h="10" /><onsuccess>6381877c-5fa2-46ab-bc55-ad45071059db</onsuccess></stage></process></process>
        <process id="c264180c-0a38-47bc-b805-78f0aaa1dd24" name="Example 2B - Manual Review Logic" published="true" xmlns="http://www.blueprism.co.uk/product/process"><process name="Example 2B - Manual Review Logic" version="1.0" bpversion="7.1.2.3518" narrative="" byrefcollection="true"><view><camerax>65</camerax><cameray>234</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="cf13a1fa-a9be-4527-973b-e2f66f99d14b" type="Normal" published="False"><name>Close Down</name><view><camerax>0</camerax><cameray>-25</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="67e5431f-68ab-4a3c-98ca-9f7ac08d305a" type="Normal" published="False"><name>01 Write Shared Review Data</name><view><camerax>213</camerax><cameray>367</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="ef0659f6-bb8d-47b2-8192-3db5829a06fc" type="Normal" published="False"><name>01a Manage Existing Review Files</name><view><camerax>0</camerax><cameray>571</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="316831fa-0689-4cbd-9c71-69dc6fb0e523" type="Normal" published="False"><name>02 Check for Reviewed Predictions</name><view><camerax>259.8</camerax><cameray>36</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="3308900e-dd2f-4ab9-a926-b2d4af05ecb8" type="Normal" published="False"><name>Mark Item As Exception</name><view><camerax>-8</camerax><cameray>423</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="8b289a62-d917-4b76-99ff-1cc590a0b5f3" type="Normal" published="False"><name>Defer</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="5fd952f0-1be2-40e8-8afa-485524c5a5cd" type="Normal" published="False"><name>Reset Global Data</name><view><camerax>0</camerax><cameray>42</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="662bb400-cee8-49c6-8023-b0c34da4c426" type="Normal" published="False"><name>Move Temporary Files</name><view><camerax>0</camerax><cameray>97</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="30a66a72-d51e-464f-89e3-f40b54998601" name="Start" type="Start"><display x="15" y="-150" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>85fbb578-f410-4f72-8ca9-58513939bc51</onsuccess></stage><stage stageid="458762d9-7dd4-47c0-bbdc-55d193273d9c" name="End" type="End"><display x="375" y="-165" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="8b6eaa66-766c-4d2a-a0d1-cc6ab7e4f32d" name="Stage1" type="ProcessInfo"><display x="-180" y="-135" w="270" h="120" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="b49e249e-bbb1-427e-8bd1-902ce03e3a79" name="Recover" type="Recover"><display x="120" y="375" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>6fa1db8d-0510-4c35-8416-9a938e94c78d</onsuccess></stage><stage stageid="53762061-333e-4023-b99f-1de349dfc4a4" name="Resume" type="Resume"><display x="120" y="525" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>76bff135-6d04-4dca-9f06-bb941c290727</onsuccess></stage><stage stageid="10cdebf6-ced7-425b-91dd-2b0b764b5ee0" name="Got Item?" type="Decision"><display x="120" y="60" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Item ID]&lt;&gt;&quot;&quot;" /><ontrue>ddcca36f-4cf9-489e-abf7-6135db964332</ontrue><onfalse>7cfa842f-7ad3-4458-943f-6d7007300925</onfalse></stage><stage stageid="f52977fa-5395-47ee-a08b-35f92f89554c" name="02 Check for Reviewed Predictions" type="SubSheet"><display x="120" y="285" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>dcae72cf-52bf-481d-909b-533067729aff</onsuccess><processid>316831fa-0689-4cbd-9c71-69dc6fb0e523</processid></stage><stage stageid="58267ed1-deb3-498d-bdf8-42959ffc8bac" name="Close Down" type="SubSheetInfo"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><narrative>Closes down the applications and maintains the work queue.</narrative><display x="-210" y="-240" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="ebd3e811-a42f-4f89-b4da-5a793c6cd798" name="Start" type="Start"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="-15" y="-255" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>ae81f58b-83bf-44d0-b113-54eafc997c27</onsuccess></stage><stage stageid="22b42ab0-feae-42b2-a098-9871956bb826" name="Close Down" type="SubSheet"><display x="375" y="-90" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>458762d9-7dd4-47c0-bbdc-55d193273d9c</onsuccess><processid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</processid></stage><stage stageid="c820952e-9e6d-4733-8604-b1360d80ecde" name="Work" type="Block"><display x="45" y="105" w="135" h="375" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="1ef745eb-5713-4876-9937-47ac6d74b94b" name="anchor8" type="Anchor"><display x="375" y="285" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>bef8f1ff-727a-4e0a-b29e-ed73fb6f0147</onsuccess></stage><stage stageid="ddcca36f-4cf9-489e-abf7-6135db964332" name="01 Write Shared Review Data" type="SubSheet"><display x="120" y="165" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>f52977fa-5395-47ee-a08b-35f92f89554c</onsuccess><processid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</processid></stage><stage stageid="4fc18802-6f3f-497d-84f9-d4647d4fe33a" name="Reset Global Data" type="SubSheetInfo"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><narrative>This page is only used to reset global data items</narrative><display x="-165" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="077ec244-9c84-4210-b6a5-e54b1b6000f0" name="Start" type="Start"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><display x="15" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0dee5c1d-8e68-49ec-a0ae-94125067ae6a</onsuccess></stage><stage stageid="0dee5c1d-8e68-49ec-a0ae-94125067ae6a" name="End" type="End"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><display x="15" y="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="bef8f1ff-727a-4e0a-b29e-ed73fb6f0147" name="Reset Global Data" type="SubSheet"><display x="375" y="225" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0341efdc-206a-43f9-8369-583aa2642c07</onsuccess><processid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</processid></stage><stage stageid="46407e01-19d6-439f-b64b-e6a18e1ae3db" name="Stop?" type="Decision"><display x="375" y="60" w="90" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><decision expression="IsStopRequested() OR [Stop After Items]=0 OR LocalTime()&gt;[Stop After Time]" /><ontrue>22b42ab0-feae-42b2-a098-9871956bb826</ontrue><onfalse>b9deef81-8e13-43ef-b6e4-c7554776c97d</onfalse></stage><stage stageid="0341efdc-206a-43f9-8369-583aa2642c07" name="Count Items" type="Calculation"><display x="375" y="135" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>46407e01-19d6-439f-b64b-e6a18e1ae3db</onsuccess><calculation expression="[Stop After Items]-1" stage="Stop After Items" /></stage><stage stageid="131b5818-75e5-49ed-9fd5-4d8a51ce52f1" name="Item ID" type="Data"><display x="-165" y="270" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="2d0552e3-8ed7-4090-b123-2fbe46f2918e" name="Item Data" type="Collection"><display x="-165" y="225" w="150" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><alwaysinit /></stage><stage stageid="ab543cd9-eb36-48bb-869d-f0e87751767b" name="Item Status" type="Data"><display x="-165" y="300" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="3615f299-65d4-4b0b-ba12-72bd84993bf8" name="Item Attempts" type="Data"><display x="-165" y="330" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><alwaysinit /></stage><stage stageid="85fbb578-f410-4f72-8ca9-58513939bc51" name="Get Next Item" type="Action"><narrative>This action gets the next item to be worked from the queue, returning its details and locking it so no other case can work it.

Items with higher priorities (lower numerical value) are processed first. Where the priority is the same, the next item is the one that has been in the queue the longest,  is not already locked, and is not already completed.

The Item ID returned is used to make further calls to update the work status for that item. It may be empty, in which case there are no items available. This can mean either a) the queue is empty, or b) the queue is not running. This mechanism can be used to cleanly stop all processes working a particular queue at the end of the next case. Items that have a 'deferred' time set will not be returned unless that time has been reached.</narrative><display x="15" y="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Queue Name" narrative="The name of the queue" expr="[Queue Name]" /><input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" /><input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="&quot;Manual Review Required&quot;" /></inputs><outputs><output type="text" name="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" /><output type="collection" name="Data" narrative="The data associated with the item - a single collection row." stage="Item Data" /><output type="text" name="Status" narrative="The status of the item." stage="Item Status" /><output type="number" name="Attempts" narrative="The number of attempts already made to work this item." stage="Item Attempts" /></outputs><onsuccess>10cdebf6-ced7-425b-91dd-2b0b764b5ee0</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" /></stage><stage stageid="d08c5e70-1fd1-416b-9fdc-df51ccc54906" name="Exception Type" type="Data"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><display x="-165" y="-15" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="7ec266b2-b0c3-4dca-9e5b-f4cc61966dfa" name="Exception Detail" type="Data"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><display x="-165" y="15" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="b9deef81-8e13-43ef-b6e4-c7554776c97d" name="Get Next Item" type="Action"><narrative>This action gets the next item to be worked from the queue, returning its details and locking it so no other case can work it.

Items with higher priorities (lower numerical value) are processed first. Where the priority is the same, the next item is the one that has been in the queue the longest,  is not already locked, and is not already completed.

The Item ID returned is used to make further calls to update the work status for that item. It may be empty, in which case there are no items available. This can mean either a) the queue is empty, or b) the queue is not running. This mechanism can be used to cleanly stop all processes working a particular queue at the end of the next case. Items that have a 'deferred' time set will not be returned unless that time has been reached.</narrative><display x="225" y="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Queue Name" narrative="The name of the queue" expr="[Queue Name]" /><input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" /><input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="&quot;Manual Review Required&quot;" /></inputs><outputs><output type="text" name="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" /><output type="collection" name="Data" narrative="The data associated with the item - a single collection row." stage="Item Data" /><output type="text" name="Status" narrative="The status of the item." stage="Item Status" /><output type="number" name="Attempts" narrative="The number of attempts already made to work this item." stage="Item Attempts" /></outputs><onsuccess>10cdebf6-ced7-425b-91dd-2b0b764b5ee0</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" /></stage><stage stageid="8f17792f-057d-4155-804d-35098307f65b" name="anchor14" type="Anchor"><display x="375" y="525" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>1ef745eb-5713-4876-9937-47ac6d74b94b</onsuccess></stage><stage stageid="7cfa842f-7ad3-4458-943f-6d7007300925" name="Note9" type="Note"><narrative>No more items available</narrative><display x="120" y="-90" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>22b42ab0-feae-42b2-a098-9871956bb826</onsuccess></stage><stage stageid="d64ced1f-6499-41a5-b006-5b03a3bd4ed0" name="Stop After Time" type="Data"><narrative>Used by the process to decide whether to keep working or close itself down. This value can be modified from Control Room to bring a session to an early finish.</narrative><display x="-165" y="105" w="150" h="30" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><datatype>time</datatype><initialvalue>23:59:59</initialvalue><exposure>Session</exposure><private /><alwaysinit /></stage><stage stageid="aff8912c-98ae-4bb9-84d5-a2eab0253c71" name="Stop After Items" type="Data"><narrative>Used by the process to decide whether to keep working or close itself down. This value can be modified from Control Room to bring a session to an early finish.</narrative><display x="-165" y="135" w="150" h="30" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><datatype>number</datatype><initialvalue>9999999999</initialvalue><exposure>Session</exposure><private /><alwaysinit /></stage><stage stageid="eb957176-69ca-436f-b5b8-a0af1c12f549" name="Stopping Control Settings" type="Block"><display x="-255" y="75" w="180" h="90" /><font family="Tahoma" size="10" style="Regular" color="FF0000" /></stage><stage stageid="d303b2cb-0441-445a-8463-956e2863a1d4" name="Queue Name" type="Data"><display x="-165" y="30" w="150" h="30" /><font family="Tahoma" size="10" style="Bold" color="0000FF" /><datatype>text</datatype><initialvalue xml:space="preserve">Chapter 6 Example 2 Queue</initialvalue><alwaysinit /></stage><stage stageid="f9d7ca2d-a983-471c-bc79-408b2230269a" name="Process Settings" type="Block"><display x="-255" y="0" w="180" h="60" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="6fa1db8d-0510-4c35-8416-9a938e94c78d" name="Exception Data" type="MultipleCalculation"><display x="120" y="435" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>53762061-333e-4023-b99f-1de349dfc4a4</onsuccess><steps><calculation expression="ExceptionType()" stage="Exception Type" /><calculation expression="ExceptionDetail()" stage="Exception Detail" /></steps></stage><stage stageid="9092535a-fa8e-415b-bbf1-919c06b8f6e5" name="End4" type="End"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><display x="-15" y="-135" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="60ff9c2a-74c0-43ce-8d08-313ffc4fa0e8" name="Note4" type="Note"><subsheetid>5fd952f0-1be2-40e8-8afa-485524c5a5cd</subsheetid><narrative>You can take the opportunity when traversing this page to confirm that the target applications are on the correct screen ready for processing the next case.</narrative><display x="120" y="-45" w="150" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /></stage><stage stageid="6a2d12ed-c686-456e-9bed-9a0eb3f77d63" name="02 Check for Reviewed Predictions" type="SubSheetInfo"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="9bff0960-ff31-499c-ada0-a5d56d24dc60" name="Start" type="Start"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="30" y="-225" /><onsuccess>41c12b2b-a528-49de-9ed9-2f73c1695d97</onsuccess></stage><stage stageid="f1cf54fe-5c79-44ae-8bbb-3ec314bb3e21" name="End" type="End"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="30" y="1155" /></stage><stage stageid="9cde0353-47a8-4d7f-b0dc-0ad41eba8c89" name="Success" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="-195" y="120" w="150" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1705d827-8e36-4b63-921d-a661c62c2e70" name="Message" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="-195" y="150" w="150" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="dc72aa4b-6a19-48fa-8ea5-24203de1e747" name="Files" type="Collection"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="-195" y="90" w="150" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="41056d98-8645-47e8-8a5c-486b8c594439" name="Unworked Data" type="Collection"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="-195" y="195" w="150" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="age" type="text" /><field name="job_id" type="text" /><field name="salary_range_id" type="text" /><field name="days_last_purchase" type="text" /><field name="avg_purchase_size" type="text" /><field name="rewards_club_points" type="text" /><field name="gender" type="text" /><field name="customer_id" type="text" /><field name="label" type="text" /></collectioninfo></stage><stage stageid="c6c9da6e-41d2-41e3-ad6b-fb416812a0b5" name="Lock Token" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="-195" y="30" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f6bfc487-b782-472f-bea4-b057094552af" name="Lock Prefix" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="-195" y="0" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">Chapter 6 Example 2 Lock</initialvalue><private /><alwaysinit /></stage><stage stageid="3de5e500-89c7-4f69-b070-ba2796d0bd6d" name="Populate Queue Settings" type="Block"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="-270" y="-30" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="afccc5c2-e31d-4ccc-95c7-cbfaa4647828" name="Rewrite Excel Needed" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><narrative>Set to true we successfully update one Item ID's Status</narrative><display x="-195" y="255" w="150" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="6fc06705-63fb-4760-91ea-6dda4b780237" name="01 Write Shared Review Data" type="SubSheetInfo"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><narrative>Write out the excel files that need review</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="1d90d110-8636-408c-9e2f-6677e410df5a" name="Start" type="Start"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="15" y="0" /><onsuccess>4f81b9de-8352-47f2-9894-e78edfcb7553</onsuccess></stage><stage stageid="f0e0424d-135b-4e52-9030-fa2b166808fb" name="End" type="End"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="15" y="1305" /></stage><stage stageid="b01b0964-30a7-4b1e-9ce8-31a5e90d8e4a" name="Current Batch Count" type="Data"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="0" w="120" h="30" /><datatype>number</datatype><initialvalue>0</initialvalue><private /></stage><stage stageid="361d9719-17b3-49e0-a9a6-b7cfe8ed8b1a" name="Increment Batch Count" type="Calculation"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="15" y="900" w="90" h="30" /><onsuccess>c872c1ae-5454-4a29-a487-955fb5fc4d6f</onsuccess><calculation expression="[Current Batch Count]+1" stage="Current Batch Count" /></stage><stage stageid="8854ccdc-4a58-45a4-91be-8bffe5fbf9c9" name="MS Excel VBO::Create Instance" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="345" w="90" h="30" /><inputs><input type="flag" name="Enable Events" friendlyname="Enable Events" narrative="Flag to indicate that events should be enabled / disabled on the attached instance - defaulted to True" expr="" /></inputs><outputs><output type="number" name="handle" friendlyname="handle" narrative="An integer which can be used to identify the created instance in subsequent actions" stage="handle" /></outputs><onsuccess>86097caa-5d62-4b1d-95d6-36043531c57d</onsuccess><resource object="MS Excel VBO" action="Create Instance" /></stage><stage stageid="45eb8105-4429-4874-992e-ef345b1daf87" name="handle" type="Data"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="-195" y="165" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="815b7ad7-59ca-4aac-8d4f-c0d6ce526012" name="MS Excel VBO::Open Workbook" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="75" y="390" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the required workbook should be opened. The default of zero indicates the currently active instance." expr="[handle]" /><input type="text" name="File name" friendlyname="File name" narrative="The path and name of the file which should be opened." expr="[Ch6 Example 2 Temporary Review Folder Path] &amp; &quot;\&quot; &amp; [Excel File Name]" /></inputs><outputs><output type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name used by Excel to identify the workbook - usually this is the file name (without the path)." stage="Workbook Name" /></outputs><onsuccess>b67fc4d7-328e-4754-af24-b0af998bb752</onsuccess><resource object="MS Excel VBO" action="Open Workbook" /></stage><stage stageid="1082ca94-c3f2-457f-8bed-09d0d6d7f431" name="Excel File Name" type="Data"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="30" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /></stage><stage stageid="c872c1ae-5454-4a29-a487-955fb5fc4d6f" name="Start New Batch?" type="Decision"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="15" y="945" w="90" h="30" /><decision expression="[Current Batch Count] = [Ch6 Example 2 Review Batch Size]" /><ontrue>51b925b3-e5f3-4d1a-a04b-77df48efc8ea</ontrue><onfalse>aa019d2f-f581-4be4-adb0-4def655e9ef9</onfalse></stage><stage stageid="ae0593ce-f433-4732-84c7-a53662f09744" name="Set Excel Filename" type="Calculation"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="300" w="90" h="30" /><onsuccess>8854ccdc-4a58-45a4-91be-8bffe5fbf9c9</onsuccess><calculation expression="&quot;review_&quot; &amp; GetResourceName() &amp; &quot;_&quot; &amp; FormatDateTime(Now(), &quot;yyyy_MM_dd_HHmmss&quot;) &amp; &quot;.xlsx&quot;" stage="Excel File Name" /></stage><stage stageid="42a4aaaf-bd05-4f86-a2b9-2d822140a5ab" name="Create new Excel File?" type="Decision"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="15" y="255" w="90" h="30" /><decision expression="[Current Batch Count] = 0" /><ontrue>ae0593ce-f433-4732-84c7-a53662f09744</ontrue><onfalse>4fcaf55b-5c83-4c42-932e-470fd0f88d8e</onfalse></stage><stage stageid="0b8289bc-5ace-4f4c-932d-f9a6810f5073" name="MS Excel VBO::Write Collection" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="570" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the specified collection should be written. The default of zero indicates the currently active instance." expr="[handle]" /><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection containing the data which should be written to the worksheet." expr="[Row]" /><input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook within which the data should be written. The default empty value indicates the current workbook within the specified instance." expr="[Workbook Name]" /><input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the worksheet on which the given data should be written. The default empty value indicates the current sheet within the specified workbook." expr="" /><input type="text" name="Cell Reference" friendlyname="Cell Reference" narrative="The reference at which the collection should be written." expr="&quot;A1&quot;" /><input type="flag" name="Include Column Names" friendlyname="Include Column Names" narrative="True to indicate that the column names from the collection should be written out as the first row; False to ignore the column names and just write out the data." expr="True" /></inputs><onsuccess>e7ee9cf4-9bdb-4c9b-bd08-659cad3fcb9f</onsuccess><resource object="MS Excel VBO" action="Write Collection" /></stage><stage stageid="86097caa-5d62-4b1d-95d6-36043531c57d" name="MS Excel VBO::Create Workbook" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="390" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the workbook should be created. The default of zero indicates the currently active instance." expr="[handle]" /></inputs><outputs><output type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook that Excel has created - this can be changed using the &quot;Save Workbook As&quot; action" stage="Workbook Name" /></outputs><onsuccess>362a2b62-91d1-43a0-8290-a36f67482959</onsuccess><resource object="MS Excel VBO" action="Create Workbook" /></stage><stage stageid="86a1ca8f-4a7b-419e-8fb5-45283998f51b" name="Workbook Name" type="Data"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="-195" y="195" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="362a2b62-91d1-43a0-8290-a36f67482959" name="Set Collection" type="MultipleCalculation"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="525" w="90" h="30" /><onsuccess>0b8289bc-5ace-4f4c-932d-f9a6810f5073</onsuccess><steps><calculation expression="[Item Data.age]" stage="Row.age" /><calculation expression="[Item Data.avg_purchase_size]" stage="Row.avg_purchase_size" /><calculation expression="[Item Data.customer_id]" stage="Row.customer_id" /><calculation expression="[Item Data.days_last_purchase]" stage="Row.days_last_purchase" /><calculation expression="[Item Data.gender]" stage="Row.gender" /><calculation expression="[Item Data.job_id]" stage="Row.job_id" /><calculation expression="[Item Data.rewards_club_points]" stage="Row.rewards_club_points" /><calculation expression="[Item Data.salary_range_id]" stage="Row.salary_range_id" /><calculation expression="[Item Data.Label]" stage="Row.label" /></steps></stage><stage stageid="ef46922e-c046-42c9-829b-6cffc210dba5" name="Row" type="Collection"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="-195" y="135" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><singlerow /><field name="age" type="text" /><field name="job_id" type="text" /><field name="salary_range_id" type="text" /><field name="days_last_purchase" type="text" /><field name="avg_purchase_size" type="text" /><field name="rewards_club_points" type="text" /><field name="gender" type="text" /><field name="customer_id" type="text" /><field name="label" type="text" /></collectioninfo><initialvalue><singlerow /><row><field name="age" type="text" value="" /><field name="job_id" type="text" value="" /><field name="salary_range_id" type="text" value="" /><field name="days_last_purchase" type="text" value="" /><field name="avg_purchase_size" type="text" value="" /><field name="rewards_club_points" type="text" value="" /><field name="gender" type="text" value="" /><field name="customer_id" type="text" value="" /><field name="label" type="text" value="" /></row></initialvalue></stage><stage stageid="e7ee9cf4-9bdb-4c9b-bd08-659cad3fcb9f" name="MS Excel VBO::Save Current Workbook As" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="15" y="615" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance for which the current workbook which should be saved. The default of zero indicates the currently active instance." expr="[handle]" /><input type="text" name="File name" friendlyname="File name" narrative="The full path and file name to which the current workbook should be saved." expr="[Ch6 Example 2 Temporary Review Folder Path] &amp; &quot;\&quot; &amp; [Excel File Name]" /></inputs><outputs><output type="text" name="New Workbook Name" friendlyname="New Workbook Name" narrative="The new workbook name which Excel will use to identify the workbook." stage="" /></outputs><onsuccess>2b1dc3df-5171-4411-9e69-1f73e171a7c1</onsuccess><resource object="MS Excel VBO" action="Save Current Workbook As" /></stage><stage stageid="2b1dc3df-5171-4411-9e69-1f73e171a7c1" name="MS Excel VBO::Close Instance" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="15" y="660" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance to be closed. Zero indicates the currently active instance." expr="[handle]" /><input type="flag" name="Save Changes" friendlyname="Save Changes" narrative="True to save the changes to the open workbooks on the instance, False to discard any changes. Default is False." expr="" /></inputs><onsuccess>b1510343-877e-485c-a01a-b6c7245696a2</onsuccess><resource object="MS Excel VBO" action="Close Instance" /></stage><stage stageid="4fcaf55b-5c83-4c42-932e-470fd0f88d8e" name="MS Excel VBO::Create Instance" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="75" y="345" w="90" h="30" /><inputs><input type="flag" name="Enable Events" friendlyname="Enable Events" narrative="Flag to indicate that events should be enabled / disabled on the attached instance - defaulted to True" expr="" /></inputs><outputs><output type="number" name="handle" friendlyname="handle" narrative="An integer which can be used to identify the created instance in subsequent actions" stage="handle" /></outputs><onsuccess>815b7ad7-59ca-4aac-8d4f-c0d6ce526012</onsuccess><resource object="MS Excel VBO" action="Create Instance" /></stage><stage stageid="b67fc4d7-328e-4754-af24-b0af998bb752" name="MS Excel VBO::Get Worksheet As Collection" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="75" y="435" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the worksheet which should be retrieved resides. The default of zero indicates the currently active instance." expr="[handle]" /><input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook which contains the sheet required. The default empty text indicates the currently active workbook on the specified instance." expr="[Workbook Name]" /><input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the worksheet within the specified workbook which should be written to a collection. The default empty text indicates the currently active worksheet within the specified workbook." expr="" /><input type="text" name="Fetch Data With Method" friendlyname="Fetch Data With Method" narrative="The method used to fetch data from cells in the worksheet. Options include Text, Value, and Value2. The default indicates Value will be used." expr="" /></inputs><outputs><output type="collection" name="Data" friendlyname="Data" narrative="The collection containing the data from the specified worksheet - the column IDs will be gleaned from the first row on the sheet being retrieved." stage="Data" /></outputs><onsuccess>d6338126-d414-4372-96dd-8722f42b2995</onsuccess><resource object="MS Excel VBO" action="Get Worksheet As Collection" /></stage><stage stageid="d6338126-d414-4372-96dd-8722f42b2995" name="Collections::Add Row" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="75" y="480" w="90" h="30" /><inputs><input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Data&quot;" /></inputs><onsuccess>c0f7791a-8d3c-4066-9ee3-7bd517e76308</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" /></stage><stage stageid="ac1a715f-7c5e-404f-970a-90c1ff55a9d4" name="Data" type="Collection"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="-195" y="225" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="c0f7791a-8d3c-4066-9ee3-7bd517e76308" name="Set Collection" type="MultipleCalculation"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="75" y="525" w="90" h="30" /><onsuccess>cdf10e42-0a34-4239-a741-614433eb2b5b</onsuccess><steps><calculation expression="[Item Data.age]" stage="Data.age" /><calculation expression="[Item Data.avg_purchase_size]" stage="Data.avg_purchase_size" /><calculation expression="[Item Data.customer_id]" stage="Data.customer_id" /><calculation expression="[Item Data.days_last_purchase]" stage="Data.days_last_purchase" /><calculation expression="[Item Data.gender]" stage="Data.gender" /><calculation expression="[Item Data.job_id]" stage="Data.job_id" /><calculation expression="[Item Data.rewards_club_points]" stage="Data.rewards_club_points" /><calculation expression="[Item Data.salary_range_id]" stage="Data.salary_range_id" /><calculation expression="[Item Data.Label]" stage="Data.label" /></steps></stage><stage stageid="cdf10e42-0a34-4239-a741-614433eb2b5b" name="MS Excel VBO::Write Collection" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="75" y="570" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the specified collection should be written. The default of zero indicates the currently active instance." expr="[handle]" /><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection containing the data which should be written to the worksheet." expr="[Data]" /><input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook within which the data should be written. The default empty value indicates the current workbook within the specified instance." expr="[Workbook Name]" /><input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the worksheet on which the given data should be written. The default empty value indicates the current sheet within the specified workbook." expr="" /><input type="text" name="Cell Reference" friendlyname="Cell Reference" narrative="The reference at which the collection should be written." expr="&quot;A1&quot;" /><input type="flag" name="Include Column Names" friendlyname="Include Column Names" narrative="True to indicate that the column names from the collection should be written out as the first row; False to ignore the column names and just write out the data." expr="True" /></inputs><onsuccess>e7ee9cf4-9bdb-4c9b-bd08-659cad3fcb9f</onsuccess><resource object="MS Excel VBO" action="Write Collection" /></stage><stage stageid="51b925b3-e5f3-4d1a-a04b-77df48efc8ea" name="Reset Batch Count" type="Calculation"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="15" y="990" w="90" h="30" /><onsuccess>bab7a7e1-ac86-48ca-ab1c-7faa03c460a0</onsuccess><calculation expression="0" stage="Current Batch Count" /></stage><stage stageid="aa019d2f-f581-4be4-adb0-4def655e9ef9" name="Anchor13" type="Anchor"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="-90" y="945" w="10" h="10" /><onsuccess>a8b48ecf-3340-483e-ba61-46c32f54b00b</onsuccess></stage><stage stageid="a8b48ecf-3340-483e-ba61-46c32f54b00b" name="Anchor14" type="Anchor"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="-90" y="1305" w="10" h="10" /><onsuccess>f0e0424d-135b-4e52-9030-fa2b166808fb</onsuccess></stage><stage stageid="70ec634e-3eb5-4934-84a3-21892a4c71a8" name="Note10" type="Note"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><narrative>Move to temp folder, preferably inaccessible to reviewer</narrative><display x="-195" y="450" w="120" h="60" /><onsuccess>e7ee9cf4-9bdb-4c9b-bd08-659cad3fcb9f</onsuccess></stage><stage stageid="bab7a7e1-ac86-48ca-ab1c-7faa03c460a0" name="Utility - File Management::Move File" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="15" y="1035" w="90" h="30" /><inputs><input type="text" name="File Path" friendlyname="File Path" narrative="The full path to the file to move" expr="[Ch6 Example 2 Temporary Review Folder Path] &amp; &quot;\&quot; &amp; [Excel File Name]" /><input type="text" name="Destination Path" friendlyname="Destination Path" narrative="The path to the folder to move the file to" expr="[Ch6 Example 2 To Review Folder Path] &amp; &quot;\&quot; &amp; [Excel File Name]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>df9fb748-0a55-4156-ae74-f79d553c5c58</onsuccess><resource object="Utility - File Management" action="Move File" /></stage><stage stageid="588fdd14-f22b-4f76-adc3-8ba21b362118" name="Success" type="Data"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="240" y="1110" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e07f4d73-c98c-40a1-8286-5b50c81cc9ba" name="Message" type="Data"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="300" y="1110" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d03425aa-d4e4-4993-8d41-7aa388f41866" name="Note11" type="Note"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><narrative>Move from the Temporary path to the Path accessible by the reviewer</narrative><display x="150" y="990" w="90" h="60" /><onsuccess>bab7a7e1-ac86-48ca-ab1c-7faa03c460a0</onsuccess></stage><stage stageid="7dac5b6c-ad44-4769-8694-4cf3e32c7676" name="Note12" type="Note"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><narrative>Some sort of messaging or notification could be sent to the reviewers here, to let them know that there is an Excel file that is ready for review</narrative><display x="15" y="1230" w="120" h="90" /><onsuccess>f0e0424d-135b-4e52-9030-fa2b166808fb</onsuccess></stage><stage stageid="8bd0c7cd-98e8-4a9d-be21-af155d3acc65" name="Writing the Temporary Excel file" type="Block"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="-105" y="225" w="240" h="465" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="ac880006-7ef7-41a2-9830-5e4e509512e7" name="Do not Reset to Initial Value" type="Block"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="-270" y="-30" w="150" h="90" /><font family="Segoe UI" size="10" style="Regular" color="339966" /></stage><stage stageid="2add894d-ff96-4680-b293-c85c73e63322" name="Global Environment Variables" type="Block"><loginhibit onsuccess="true" /><display x="-255" y="375" w="180" h="165" /><font family="Segoe UI" size="10" style="Regular" color="FF9900" /></stage><stage stageid="a9296960-c265-4df7-8723-7b9cd5afce37" name="Ch6 Example 2 To Review Folder Path" type="Data"><loginhibit onsuccess="true" /><display x="-165" y="450" w="150" h="30" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="a48f94fb-eaa2-4778-a36e-7b932deef409" name="Ch6 Example 2 Completed Review Folder Path" type="Data"><loginhibit onsuccess="true" /><display x="-165" y="480" w="150" h="30" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="c9e5d838-4797-4ca6-a35f-cabb731c9421" name="Ch6 Example 2 Temporary Review Folder Path" type="Data"><loginhibit onsuccess="true" /><display x="-165" y="510" w="150" h="30" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="151f0b8e-5590-4627-ac82-5cda30170b75" name="Ch6 Example 2 Review Batch Size" type="Data"><loginhibit onsuccess="true" /><display x="-165" y="405" w="150" h="30" /><datatype>number</datatype><initialvalue>5</initialvalue><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="7f06a632-fe33-4983-8ed5-09675784e74b" name="Global Item Data" type="Block"><loginhibit onsuccess="true" /><display x="-255" y="180" w="180" h="180" /><font family="Segoe UI" size="10" style="Regular" color="FF99CC" /></stage><stage stageid="4f81b9de-8352-47f2-9894-e78edfcb7553" name="Item Data has Review Filepath Field?" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="15" y="45" w="90" h="30" /><inputs><input type="collection" name="Input Collection" friendlyname="Input Collection" narrative="The collection to check." expr="[Item Data]" /><input type="text" name="Field" friendlyname="Field" narrative="The field to see if the collection has." expr="&quot;Review Filepath&quot;" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if the collection contains the field." stage="Has Review Filepath Field" /><output type="text" name="Error Message" friendlyname="Error Message" narrative="Unused" stage="" /></outputs><onsuccess>0d6677a2-c490-4d15-8361-7c98ad0bf3e0</onsuccess><resource object="Utility - Collection Manipulation" action="Collection Contains Field" /></stage><stage stageid="0d6677a2-c490-4d15-8361-7c98ad0bf3e0" name="Yes?" type="Decision"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="15" y="90" /><decision expression="[Has Review Filepath Field]" /><ontrue>e790e4f6-da98-49a9-a56d-222e9cb66cc6</ontrue><onfalse>6f44d75e-256c-4592-b074-0c7ebe82fdd7</onfalse></stage><stage stageid="6f44d75e-256c-4592-b074-0c7ebe82fdd7" name="Anchor1" type="Anchor"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="15" y="150" w="10" h="10" /><onsuccess>42a4aaaf-bd05-4f86-a2b9-2d822140a5ab</onsuccess></stage><stage stageid="d2d86f8f-1c68-462c-8f32-567725f1bc77" name="Utility - Collection Manipulation::Append Field (Text)" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="135" y="750" w="90" h="30" /><inputs><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Item Data]" /><input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;Review Filepath&quot;" /><input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="" /></inputs><outputs><output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Item Data" /></outputs><onsuccess>81e9fea5-0b24-4fdd-918e-63605b8ec915</onsuccess><resource object="Utility - Collection Manipulation" action="Append Field (Text)" /></stage><stage stageid="b1510343-877e-485c-a01a-b6c7245696a2" name="Has Review Filepath Field?" type="Decision"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="15" y="750" w="90" h="30" /><decision expression="[Has Review Filepath Field]" /><ontrue>d9515c6b-e686-411e-9669-009fed921833</ontrue><onfalse>d2d86f8f-1c68-462c-8f32-567725f1bc77</onfalse></stage><stage stageid="419dacec-05ae-46e1-b9d0-ea97a46d829a" name="Has Review Filepath Field" type="Data"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="-195" y="105" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d9515c6b-e686-411e-9669-009fed921833" name="Add Temporary Review Filepath to Item Data" type="Calculation"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="15" y="795" w="90" h="30" /><onsuccess>aca513f4-e11c-44db-ba15-f69feb628485</onsuccess><calculation expression="[Ch6 Example 2 Temporary Review Folder Path] &amp; &quot;\&quot; &amp; [Excel File Name]" stage="Item Data.Review Filepath" /></stage><stage stageid="81e9fea5-0b24-4fdd-918e-63605b8ec915" name="Anchor3" type="Anchor"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="135" y="795" w="10" h="10" /><onsuccess>d9515c6b-e686-411e-9669-009fed921833</onsuccess></stage><stage stageid="92e37096-bd50-4db9-8f16-f49c4ca11e52" name="Add Temporary File Path to Item Data" type="Block"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="720" w="240" h="150" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="aca513f4-e11c-44db-ba15-f69feb628485" name="Work Queues::Set Data" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><narrative>Sets the data on the specified item to the given value. 
The collection must contain one row exactly, and the key field, if present, must match the key field of the item being updated.
Also, the item must currently be locked by the current session - ie. it must have been retrieved using the 'Get Next' action.</narrative><display x="15" y="840" /><inputs><input type="collection" name="Data" friendlyname="Data" narrative="A collection with one row containing the data to be set on the item. If the item has a key value and this collection has a key value, they should match exactly." expr="[Item Data]" /><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the work item to set the data on. This item should be locked by the calling session." expr="[Item ID]" /></inputs><onsuccess>361d9719-17b3-49e0-a9a6-b7cfe8ed8b1a</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Set Data" /></stage><stage stageid="df9fb748-0a55-4156-ae74-f79d553c5c58" name="Add To Review Filepath to Item Data" type="Calculation"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="15" y="1095" w="90" h="30" /><onsuccess>a98b1c91-c36f-4ddc-9ebb-64fb3432b439</onsuccess><calculation expression="[Ch6 Example 2 To Review Folder Path] &amp; &quot;\&quot; &amp; [Excel File Name]&#xA;" stage="Item Data.Review Filepath" /></stage><stage stageid="a98b1c91-c36f-4ddc-9ebb-64fb3432b439" name="Work Queues::Set Data" type="Action"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><narrative>Sets the data on the specified item to the given value. 
The collection must contain one row exactly, and the key field, if present, must match the key field of the item being updated.
Also, the item must currently be locked by the current session - ie. it must have been retrieved using the 'Get Next' action.</narrative><display x="15" y="1140" /><inputs><input type="collection" name="Data" friendlyname="Data" narrative="A collection with one row containing the data to be set on the item. If the item has a key value and this collection has a key value, they should match exactly." expr="[Item Data]" /><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the work item to set the data on. This item should be locked by the calling session." expr="[Item ID]" /></inputs><onsuccess>7dac5b6c-ad44-4769-8694-4cf3e32c7676</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Set Data" /></stage><stage stageid="de3ac6ab-2f34-4192-9c7b-10f68f5ac85d" name="Add To Review Filepath to Item Data" type="Block"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="1065" w="150" h="105" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="96eb6668-cd22-4f42-8550-4377c289e3c8" name="Defer" type="SubSheetInfo"><subsheetid>8b289a62-d917-4b76-99ff-1cc590a0b5f3</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="7bb8c7f8-ceff-4901-8370-70ec6cc38b61" name="Start" type="Start"><subsheetid>8b289a62-d917-4b76-99ff-1cc590a0b5f3</subsheetid><display x="15" y="-105" /><onsuccess>f8b4af47-cac8-48c2-9001-db14abebb481</onsuccess></stage><stage stageid="e1c341b7-50a1-430b-ac3c-e29af61297d0" name="End" type="End"><subsheetid>8b289a62-d917-4b76-99ff-1cc590a0b5f3</subsheetid><display x="15" y="90" /></stage><stage stageid="f8b4af47-cac8-48c2-9001-db14abebb481" name="Work Queues::Defer" type="Action"><subsheetid>8b289a62-d917-4b76-99ff-1cc590a0b5f3</subsheetid><loginhibit onsuccess="true" /><narrative>Marks the item as deferred. It is unlocked, but it will not be made available for processing again until the specified time.

The attempts count for the item is reset to zero.</narrative><display x="15" y="-30" /><inputs><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to defer" expr="[Item ID]" /><input type="datetime" name="Until" friendlyname="Until" narrative="When to resume processing the case" expr="Now() + MakeTimeSpan(0, 0, 1, 0)" /></inputs><onsuccess>e1c341b7-50a1-430b-ac3c-e29af61297d0</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Defer" /></stage><stage stageid="1b863515-c656-4fbf-8a8f-253ce2f61325" name="Note1" type="Note"><subsheetid>8b289a62-d917-4b76-99ff-1cc590a0b5f3</subsheetid><narrative>One minute. Set this to an appropriate value to prevent items from being picked up again</narrative><display x="150" y="-30" w="150" h="60" /><onsuccess>f8b4af47-cac8-48c2-9001-db14abebb481</onsuccess></stage><stage stageid="dcae72cf-52bf-481d-909b-533067729aff" name="Defer" type="SubSheet"><loginhibit onsuccess="true" /><display x="270" y="285" w="90" h="60" /><onsuccess>1ef745eb-5713-4876-9937-47ac6d74b94b</onsuccess><processid>8b289a62-d917-4b76-99ff-1cc590a0b5f3</processid></stage><stage stageid="a0722868-1c0d-438e-913c-9688de5b8de7" name="Set Completed Filepath" type="Calculation"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="-90" /><onsuccess>8866970e-b235-4123-8bc7-0da4cbede7a8</onsuccess><calculation expression="[Ch6 Example 2 Completed Review Folder Path] &amp; &quot;\&quot; &amp; [Filename]" stage="Completed Filepath" /></stage><stage stageid="7a9835c8-87e8-458d-830e-bc69be5f8879" name="Mark Item As Exception" type="SubSheetInfo"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><narrative>Marks the current work queue item as an exception</narrative><display x="-120" y="-195" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="34f8a777-0e70-4530-9ea9-57dce3a470fe" name="Start" type="Start"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="15" y="-120" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>6d63c990-63b3-4136-9990-3e62c06adff3</onsuccess></stage><stage stageid="21fc1a62-1f22-4148-9bdf-915d7aab687b" name="Retry Exception?" type="Decision"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="15" y="30" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="Lower([Exception Type])=&quot;system exception&quot; OR Lower([Exception Type])=&quot;internal&quot;" /><ontrue>962a9cee-31a4-49fa-ba7e-7a2c9f7603d8</ontrue><onfalse>129c3e00-a890-45d4-8c4f-830b79fcfbff</onfalse></stage><stage stageid="a4207bb0-c7c2-4ecd-8aee-348f12c854cf" name="Previous Exception?" type="Decision"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="15" y="225" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Previous Exception Detail]=[Exception Detail]" /><ontrue>ddfecd73-b4e3-4197-9c3c-758d367a0cc3</ontrue><onfalse>d100288d-3265-4689-bde7-88d5403c0309</onfalse></stage><stage stageid="45c50dd6-f34d-4415-94fd-d5be438eb2a8" name="Previous Exception Detail" type="Data"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="-225" y="165" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /></stage><stage stageid="ddfecd73-b4e3-4197-9c3c-758d367a0cc3" name="Count" type="Calculation"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="15" y="300" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>3a365e1f-28df-4147-9bbb-bf63aca76247</onsuccess><calculation expression="1+ [Consecutive Exception Count]" stage="Consecutive Exception Count" /></stage><stage stageid="2aeb24ac-cdb8-4e32-a27f-a0127a7fd5e2" name="Consecutive Exception Count" type="Data"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="-225" y="195" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue></stage><stage stageid="3a365e1f-28df-4147-9bbb-bf63aca76247" name="Limit?" type="Decision"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="15" y="375" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Consecutive Exception Count]&gt;=[Consecutive Exception Limit]" /><ontrue>2c5727c3-cb19-4e17-90d0-5bd331bb4d5b</ontrue><onfalse>91ebcae9-b474-45ff-956a-663e3478c898</onfalse></stage><stage stageid="00c8c5b1-73b6-4940-a42b-f2930b8c3e18" name="TERMINATE" type="Exception"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="15" y="570" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><exception type="" detail="[Consecutive Exception Limit] &amp; &quot; consecutive incidents of &quot; &amp; [Exception Type] &amp; &quot;: &quot; &amp; [Exception Detail]" /></stage><stage stageid="ea532bb0-cd92-4e01-9d9d-6227dc953136" name="Consecutive Exception Limit" type="Data"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="-225" y="225" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>3</initialvalue><private /><alwaysinit /></stage><stage stageid="ffd735be-f8b4-4c0a-ba80-f0877ae39ed6" name="End2" type="End"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="285" y="375" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="74485961-cf80-4f55-b3dc-74c49450090b" name="Reset Consecutive Exception Indicators" type="MultipleCalculation"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="285" y="225" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>ffd735be-f8b4-4c0a-ba80-f0877ae39ed6</onsuccess><steps><calculation expression="[Exception Detail]" stage="Previous Exception Detail" /><calculation expression="0" stage="Consecutive Exception Count" /></steps></stage><stage stageid="2c5727c3-cb19-4e17-90d0-5bd331bb4d5b" name="Stop the process because consecutive exceptions are occuring" type="Note"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><narrative>The consecutive exception limit has been reached, so throw a new exception to terminate the process.</narrative><display x="15" y="480" w="120" h="90" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>00c8c5b1-73b6-4940-a42b-f2930b8c3e18</onsuccess></stage><stage stageid="22fb8fd0-725b-41e2-baec-afb5f0d7ac70" name="New Item ID" type="Data"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="-225" y="105" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="129c3e00-a890-45d4-8c4f-830b79fcfbff" name="Tag Item" type="Action"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><narrative>Adds a tag to a work queue item</narrative><display x="105" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the queue item to add the tag to" expr="[Item ID]" /><input type="text" name="Tag" narrative="The tag to add to the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;Business Exception&quot;" /></inputs><onsuccess>0080c57c-86b0-41be-9915-3b63bcfb2a2a</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Tag Item" /></stage><stage stageid="e2ff432c-fc65-4d24-8483-b5be9da28a13" name="Reset Consecutive Exception Indicators" type="MultipleCalculation"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="450" y="30" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0226b085-0e9d-4c49-90ce-ab27b5bf49ab</onsuccess><steps><calculation expression="&quot;&quot;" stage="Previous Exception Detail" /><calculation expression="0" stage="Consecutive Exception Count" /></steps></stage><stage stageid="d100288d-3265-4689-bde7-88d5403c0309" name="Note5" type="Note"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><loginhibit /><narrative>This exception is different from the previous one.</narrative><display x="150" y="225" w="120" h="90" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>74485961-cf80-4f55-b3dc-74c49450090b</onsuccess></stage><stage stageid="91ebcae9-b474-45ff-956a-663e3478c898" name="Note5" type="Note"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><loginhibit /><narrative>This exception is the same as the previous one but the consecutive exception limit has not yet been reached.</narrative><display x="150" y="375" w="120" h="90" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>ffd735be-f8b4-4c0a-ba80-f0877ae39ed6</onsuccess></stage><stage stageid="0080c57c-86b0-41be-9915-3b63bcfb2a2a" name="Note5" type="Note"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><loginhibit /><narrative>Don't retry this type of exception, just mark the queue item and carry on.</narrative><display x="225" y="30" w="120" h="90" /><font family="Tahoma" size="10" style="Regular" color="0000FF" /><onsuccess>431ba879-3456-44bc-8f32-2756507c896f</onsuccess></stage><stage stageid="24681422-4380-4323-a732-36fc05bdacb7" name="Mark Exception" type="Action"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative><display x="15" y="150" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Exception Reason" narrative="A description of the reason for the exception" expr="[Exception Detail]" /><input type="flag" name="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="True" /><input type="flag" name="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="False" /></inputs><outputs><output type="text" name="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="New Item ID" /></outputs><onsuccess>a4207bb0-c7c2-4ecd-8aee-348f12c854cf</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" /></stage><stage stageid="431ba879-3456-44bc-8f32-2756507c896f" name="Mark Exception" type="Action"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative><display x="345" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Exception Reason" narrative="A description of the reason for the exception" expr="[Exception Detail]" /><input type="flag" name="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="False" /><input type="flag" name="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="False" /></inputs><outputs><output type="text" name="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="New Item ID" /></outputs><onsuccess>e2ff432c-fc65-4d24-8483-b5be9da28a13</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" /></stage><stage stageid="0226b085-0e9d-4c49-90ce-ab27b5bf49ab" name="End1" type="End"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="555" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="962a9cee-31a4-49fa-ba7e-7a2c9f7603d8" name="Tag Item" type="Action"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><narrative>Adds a tag to a work queue item</narrative><display x="15" y="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the queue item to add the tag to" expr="[Item ID]" /><input type="text" name="Tag" narrative="The tag to add to the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;System Exception&quot;" /></inputs><onsuccess>24681422-4380-4323-a732-36fc05bdacb7</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Tag Item" /></stage><stage stageid="6d63c990-63b3-4136-9990-3e62c06adff3" name="System Unavailable?" type="Decision"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="15" y="-45" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="Lower([Exception Type])=&quot;system unavailable exception&quot; OR Lower([Exception Type])=&quot;login system exception&quot;" /><ontrue>b4c3202d-8b4b-46bb-afe1-c188371bde11</ontrue><onfalse>21fc1a62-1f22-4148-9bdf-915d7aab687b</onfalse></stage><stage stageid="b4c3202d-8b4b-46bb-afe1-c188371bde11" name="Release Item" type="Action"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><narrative>Marks the item as deferred. It is unlocked, but it will not be made available for processing again until the specified time.

The attempts count for the item is reset to zero.</narrative><display x="-120" y="-45" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to defer" expr="[Item ID]" /><input type="datetime" name="Until" narrative="When to resume processing the case" expr="Now()" /></inputs><onsuccess>ed71e21d-1315-43b0-95a0-c77785ef7c04</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Defer" /></stage><stage stageid="ed71e21d-1315-43b0-95a0-c77785ef7c04" name="TERMINATE" type="Exception"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><display x="-120" y="30" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><exception type="" detail="[Consecutive Exception Limit] &amp; &quot; consecutive incidents of &quot; &amp; [Exception Type] &amp; &quot;: &quot; &amp; [Exception Detail]" /></stage><stage stageid="d0a8d4ec-306d-4446-9f7b-72a05fae1e57" name="Note4" type="Note"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><narrative>System not working or can not log in</narrative><display x="-105" y="-105" w="90" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /><onsuccess>6d63c990-63b3-4136-9990-3e62c06adff3</onsuccess></stage><stage stageid="f483a892-027a-4b0f-bc6a-c0b5fe1ebec0" name="Note4" type="Note"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><narrative>Check for concurrent exceptions, a system change may have occured</narrative><display x="150" y="135" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /><onsuccess>a4207bb0-c7c2-4ecd-8aee-348f12c854cf</onsuccess></stage><stage stageid="3f788823-737c-4a05-9a27-f959be9aaa94" name="Note4" type="Note"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><narrative>Tag exception category for Blue Prism Performance reports</narrative><display x="150" y="-60" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /><onsuccess>129c3e00-a890-45d4-8c4f-830b79fcfbff</onsuccess></stage><stage stageid="13770f2e-a5ae-4e13-aecc-39e47dff7e87" name="Note4" type="Note"><subsheetid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</subsheetid><narrative>The case will only retry if the WQ has been configured to enable retries.</narrative><display x="-90" y="120" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF00FF" /></stage><stage stageid="76bff135-6d04-4dca-9f06-bb941c290727" name="Mark Item As Exception" type="SubSheet"><loginhibit onsuccess="true" /><display x="270" y="525" w="90" h="60" /><onsuccess>8f17792f-057d-4155-804d-35098307f65b</onsuccess><processid>3308900e-dd2f-4ab9-a926-b2d4af05ecb8</processid></stage><stage stageid="7bd50a69-606a-40fb-87e6-de9b6349b4e8" name="Completed Filepath" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="120" y="-90" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8866970e-b235-4123-8bc7-0da4cbede7a8" name="Utility - File Management::File Exists" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="-45" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The name of the file to check" expr="[Completed Filepath]" /></inputs><outputs><output type="flag" name="Exists" friendlyname="Exists" narrative="True if the file exists" stage="Exists" /></outputs><onsuccess>7efed11c-ac45-46d9-bb1b-0172f4f65b52</onsuccess><resource object="Utility - File Management" action="File Exists" /></stage><stage stageid="38ea479b-206f-4c45-a359-a3f851752632" name="Exists" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="105" y="-45" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7efed11c-ac45-46d9-bb1b-0172f4f65b52" name="Exists?" type="Decision"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="30" y="0" /><decision expression="[Exists]" /><ontrue>cdd53de7-792b-48f6-ab96-27544586371c</ontrue><onfalse>28ff8e17-602e-4067-91aa-467a89703217</onfalse></stage><stage stageid="28ff8e17-602e-4067-91aa-467a89703217" name="End3" type="End"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="120" y="0" /></stage><stage stageid="3e630974-ebab-471b-a09b-48e1dc523928" name="MS Excel VBO::Open Workbook" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="210" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the required workbook should be opened. The default of zero indicates the currently active instance." expr="[handle]" /><input type="text" name="File name" friendlyname="File name" narrative="The path and name of the file which should be opened." expr="[Completed Filepath]" /></inputs><outputs><output type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name used by Excel to identify the workbook - usually this is the file name (without the path)." stage="Workbook Name" /></outputs><onsuccess>ffc51cbd-3539-42b0-9579-329f179ae82d</onsuccess><resource object="MS Excel VBO" action="Open Workbook" /></stage><stage stageid="e353092e-df35-4323-917b-64ca8dac802b" name="MS Excel VBO::Create Instance" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="165" w="90" h="30" /><inputs><input type="flag" name="Enable Events" friendlyname="Enable Events" narrative="Flag to indicate that events should be enabled / disabled on the attached instance - defaulted to True" expr="" /></inputs><outputs><output type="number" name="handle" friendlyname="handle" narrative="An integer which can be used to identify the created instance in subsequent actions" stage="handle" /></outputs><onsuccess>3e630974-ebab-471b-a09b-48e1dc523928</onsuccess><resource object="MS Excel VBO" action="Create Instance" /></stage><stage stageid="ffc51cbd-3539-42b0-9579-329f179ae82d" name="MS Excel VBO::Get Worksheet As Collection" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="255" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the worksheet which should be retrieved resides. The default of zero indicates the currently active instance." expr="[handle]" /><input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook which contains the sheet required. The default empty text indicates the currently active workbook on the specified instance." expr="[Workbook Name]" /><input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the worksheet within the specified workbook which should be written to a collection. The default empty text indicates the currently active worksheet within the specified workbook." expr="" /><input type="text" name="Fetch Data With Method" friendlyname="Fetch Data With Method" narrative="The method used to fetch data from cells in the worksheet. Options include Text, Value, and Value2. The default indicates Value will be used." expr="" /></inputs><outputs><output type="collection" name="Data" friendlyname="Data" narrative="The collection containing the data from the specified worksheet - the column IDs will be gleaned from the first row on the sheet being retrieved." stage="Data" /></outputs><onsuccess>0fd765b5-4990-483c-bab6-ca50d6ed66e3</onsuccess><resource object="MS Excel VBO" action="Get Worksheet As Collection" /></stage><stage stageid="c400770a-571c-4e8b-83d9-b75f0d5f768b" name="handle" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="120" y="165" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="27d5e8e8-b124-4d51-b156-f428bf085ad5" name="Workbook Name" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="120" y="210" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a7322586-0774-4d36-a61a-6094f750b75f" name="Data" type="Collection"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="120" y="255" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="cdd53de7-792b-48f6-ab96-27544586371c" name="Aquire Lock" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><narrative>Acquires the lock associated with the given name. If this session already holds the required lock, it will be re-acquired with a new token</narrative><display x="30" y="60" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Name" narrative="The name of the required lock. Mandatory parameter." expr="[Lock Prefix] &amp; [Completed Filepath]" /><input type="timespan" name="Timeout" narrative="The maximum amount of time to await the lock. Default is to wait forever" expr="MakeTimeSpan(0, 0, 0, 0)" /><input type="text" name="Preferred Token" narrative="The preferred token to use for the lock. Default behaviour is to generate a new unique token." expr="[Lock Token]" /><input type="text" name="Comment" narrative="The comments to set on the lock" expr="&quot;Acquire Lock&quot;" /></inputs><outputs><output type="text" name="Token" narrative="The token registered against the lock. This will be empty if the lock could not be acquired" stage="Lock Token" /></outputs><onsuccess>a18ec1e5-e019-44ff-9e85-9d8a9fcdc530</onsuccess><breakpoint type="0"><condition></condition></breakpoint><resource object="BluePrism.AutomateAppCore.clsEnvironmentLockingBusinessObject" action="Acquire Lock" /></stage><stage stageid="a18ec1e5-e019-44ff-9e85-9d8a9fcdc530" name="Got Lock?" type="Decision"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="30" y="120" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Lock Token] &lt;&gt; &quot;&quot;" /><ontrue>e353092e-df35-4323-917b-64ca8dac802b</ontrue><onfalse>e6f13410-ffac-4b44-b4eb-0c4a1408646b</onfalse></stage><stage stageid="3505114b-f2f3-4309-bce8-7c2c6f8815ba" name="Release Lock" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><narrative>Releases the lock(s) associated with the given name and token</narrative><display x="30" y="1095" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Name" narrative="The name of the specific lock to be released. Default behaviour is to release all locks with the given token." expr="[Lock Prefix] &amp; [Completed Filepath]" /><input type="text" name="Token" narrative="The token associated with the lock(s) to be released. Mandatory parameter." expr="[Lock Token]" /><input type="text" name="Comment" narrative="The comments to set on the lock(s)" expr="&quot;Release lock&quot;" /><input type="flag" name="All Sessions" narrative="True to release locks matching the specified constraints across all sessions; False to only release locks acquired in the current session. Default is False" expr="True" /><input type="flag" name="Keep Environment Lock" friendlyname="Keep Environment Lock" narrative="The environment lock will be kept after that lock is released. Default behaviour is to delete the lock." expr="" /></inputs><onsuccess>f1cf54fe-5c79-44ae-8bbb-3ec314bb3e21</onsuccess><resource object="BluePrism.AutomateAppCore.clsEnvironmentLockingBusinessObject" action="Release Lock" /></stage><stage stageid="46174920-d9d9-4187-bd18-60374cef4b67" name="Retry Count" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="300" w="150" h="30" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="5abfff8e-16a0-4519-aa78-dd9822731453" name="Max Retries" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="330" w="150" h="30" /><datatype>number</datatype><initialvalue>3</initialvalue><private /><alwaysinit /></stage><stage stageid="b007f6f7-08ed-480a-92dd-5b72388f93b0" name="Sleep Time (Seconds)" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="360" w="150" h="30" /><datatype>number</datatype><initialvalue>5</initialvalue><private /><alwaysinit /></stage><stage stageid="e6f13410-ffac-4b44-b4eb-0c4a1408646b" name="Retry?" type="Decision"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="225" y="120" /><decision expression="[Retry Count] &lt; [Max Retries]" /><ontrue>2cb9c1b0-6042-4798-be19-514f0353805b</ontrue><onfalse>8b8ea21a-ba68-49f0-9ca6-2dde72fddce8</onfalse></stage><stage stageid="2cb9c1b0-6042-4798-be19-514f0353805b" name="Increment" type="Calculation"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="225" y="60" /><onsuccess>8b8906e5-218e-4ae2-8dd2-b8c198c209e7</onsuccess><calculation expression="[Retry Count]+1" stage="Retry Count" /></stage><stage stageid="8b8906e5-218e-4ae2-8dd2-b8c198c209e7" name="Utility - General::Sleep" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="135" y="60" /><inputs><input type="number" name="Sleep Time (Seconds)" friendlyname="Sleep Time (Seconds)" narrative="The time (in seconds) for which to sleep" expr="[Sleep Time (Seconds)]" /></inputs><onsuccess>cdd53de7-792b-48f6-ab96-27544586371c</onsuccess><resource object="Utility - General" action="Sleep" /></stage><stage stageid="8b8ea21a-ba68-49f0-9ca6-2dde72fddce8" name="End5" type="End"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="315" y="120" /></stage><stage stageid="4c69dd1a-982a-481c-8eb6-b5dfd4448274" name="Loop Data" type="LoopStart"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="345" /><onsuccess>3c2fe6a5-0c97-45d3-b764-4931135bace5</onsuccess><groupid>ab23a318-d469-43c8-b73a-502775526b3d</groupid><looptype>ForEach</looptype><loopdata>Data</loopdata></stage><stage stageid="2dab6750-ac93-4011-9bc9-d94ee438905b" name="Loop Data" type="LoopEnd"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="645" /><onsuccess>d423aad0-5a97-4038-a218-742696320204</onsuccess><groupid>ab23a318-d469-43c8-b73a-502775526b3d</groupid></stage><stage stageid="3c2fe6a5-0c97-45d3-b764-4931135bace5" name="Full Match?" type="Decision"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="30" y="390" /><decision expression="[Item Data.age] = ToNumber([Data.age]) AND [Item Data.job_id] = ToNumber([Data.job_id]) AND [Item Data.salary_range_id] = ToNumber([Data.salary_range_id]) AND [Item Data.days_last_purchase] = ToNumber([Data.days_last_purchase]) AND [Item Data.avg_purchase_size] = ToNumber([Data.avg_purchase_size]) AND [Item Data.rewards_club_points] = ToNumber([Data.rewards_club_points]) AND [Item Data.gender] = ToNumber([Data.gender]) AND [Item Data.customer_id] = [Data.customer_id]" /><ontrue>244c5ce4-3b19-49e7-ae9d-34176fef91e5</ontrue><onfalse>09c2dd26-6d7b-45d6-879c-f1aab42f3c69</onfalse></stage><stage stageid="244c5ce4-3b19-49e7-ae9d-34176fef91e5" name="Work Queues::Update Status" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><narrative>Updates the status field for the item. The status field can be used to flag what has been done in a process so far. If a process encounters an exception, this information can be used to skip to the parts of the process not yet done for the item next time it is worked. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.

This action will also reset the Attempts column to zero, because if the status updated the process should have successfully done something.</narrative><display x="30" y="450" w="90" h="30" /><inputs><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Status" friendlyname="Status" narrative="The new status - 255 characters maximum." expr="&quot;Manual Review Complete&quot;" /></inputs><onsuccess>4ee07ee1-1c19-4407-9475-dc701d1ca68f</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Update Status" /></stage><stage stageid="4ee07ee1-1c19-4407-9475-dc701d1ca68f" name="Work Queues::Untag Item" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><narrative>Removes a tag from a work queue item</narrative><display x="30" y="495" w="90" h="30" /><inputs><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the queue item to remove the tag from" expr="[Item ID]" /><input type="text" name="Tag" friendlyname="Tag" narrative="The tag to remove from the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;Manual Review Required&quot;" /></inputs><onsuccess>8e34a347-5922-4039-80e1-292bfa644f30</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Untag Item" /></stage><stage stageid="a7952bb7-2273-4a4b-9c46-130eefe944cf" name="Update Item" type="Block"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="-30" y="420" w="120" h="195" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="de2ab084-41f0-4c00-9e7c-3dafea8e3225" name="Set Unworked Data Collection" type="MultipleCalculation"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="165" y="495" w="90" h="30" /><onsuccess>757b81d6-8399-4aa8-b84f-715516105f06</onsuccess><steps><calculation expression="[Data.age]" stage="Unworked Data.age" /><calculation expression="[Data.avg_purchase_size]" stage="Unworked Data.avg_purchase_size" /><calculation expression="[Data.customer_id]" stage="Unworked Data.customer_id" /><calculation expression="[Data.days_last_purchase]" stage="Unworked Data.days_last_purchase" /><calculation expression="[Data.gender]" stage="Unworked Data.gender" /><calculation expression="[Data.job_id]" stage="Unworked Data.job_id" /><calculation expression="[Data.rewards_club_points]" stage="Unworked Data.rewards_club_points" /><calculation expression="[Data.salary_range_id]" stage="Unworked Data.salary_range_id" /><calculation expression="[Data.label]" stage="Unworked Data.label" /></steps></stage><stage stageid="757b81d6-8399-4aa8-b84f-715516105f06" name="Anchor5" type="Anchor"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="165" y="645" w="10" h="10" /><onsuccess>2dab6750-ac93-4011-9bc9-d94ee438905b</onsuccess></stage><stage stageid="0fd765b5-4990-483c-bab6-ca50d6ed66e3" name="MS Excel VBO::Close Instance" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="300" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance to be closed. Zero indicates the currently active instance." expr="[handle]" /><input type="flag" name="Save Changes" friendlyname="Save Changes" narrative="True to save the changes to the open workbooks on the instance, False to discard any changes. Default is False." expr="" /></inputs><onsuccess>4c69dd1a-982a-481c-8eb6-b5dfd4448274</onsuccess><resource object="MS Excel VBO" action="Close Instance" /></stage><stage stageid="d423aad0-5a97-4038-a218-742696320204" name="Collections::Count Rows" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="690" w="90" h="30" /><inputs><input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Unworked Data&quot;" /></inputs><outputs><output type="number" name="Count" friendlyname="Count" narrative="The number of rows counted in the collection" stage="Unworked Data Count" /></outputs><onsuccess>04d3ff5b-b9c1-4b5e-ba8b-fba6d942a5b7</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Count Rows" /></stage><stage stageid="78e9c81f-f265-4da6-8aa8-c44af9104b62" name="Unworked Data Count" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="150" y="690" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="12c4889e-0586-43b5-9c87-0728db6dceb2" name="Unworked Data Empty" type="Decision"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="30" y="780" /><decision expression="[Unworked Data Count] = 0" /><ontrue>18bf5275-1ba5-4212-9777-aa576f5591b6</ontrue><onfalse>10ef6e28-f85e-4b2c-9f47-b0c6cd9dc58d</onfalse></stage><stage stageid="41fa3d59-2ce6-406f-b57e-ebd3e00cf924" name="MS Excel VBO::Save Current Workbook As" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="975" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance for which the current workbook which should be saved. The default of zero indicates the currently active instance." expr="[handle2]" /><input type="text" name="File name" friendlyname="File name" narrative="The full path and file name to which the current workbook should be saved." expr="[Completed Filepath]" /></inputs><outputs><output type="text" name="New Workbook Name" friendlyname="New Workbook Name" narrative="The new workbook name which Excel will use to identify the workbook." stage="" /></outputs><onsuccess>03b0625c-faa3-43f2-887c-1c37e04ed284</onsuccess><resource object="MS Excel VBO" action="Save Current Workbook As" /></stage><stage stageid="03b0625c-faa3-43f2-887c-1c37e04ed284" name="MS Excel VBO::Close Instance" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="1020" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance to be closed. Zero indicates the currently active instance." expr="[handle2]" /><input type="flag" name="Save Changes" friendlyname="Save Changes" narrative="True to save the changes to the open workbooks on the instance, False to discard any changes. Default is False." expr="" /></inputs><onsuccess>3505114b-f2f3-4309-bce8-7c2c6f8815ba</onsuccess><resource object="MS Excel VBO" action="Close Instance" /></stage><stage stageid="86c86f73-d4b6-4034-a059-92a7c26e115e" name="MS Excel VBO::Write Collection" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="930" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the specified collection should be written. The default of zero indicates the currently active instance." expr="[handle2]" /><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection containing the data which should be written to the worksheet." expr="[Unworked Data]" /><input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook within which the data should be written. The default empty value indicates the current workbook within the specified instance." expr="[Workbook Name2]" /><input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the worksheet on which the given data should be written. The default empty value indicates the current sheet within the specified workbook." expr="" /><input type="text" name="Cell Reference" friendlyname="Cell Reference" narrative="The reference at which the collection should be written." expr="&quot;A1&quot;" /><input type="flag" name="Include Column Names" friendlyname="Include Column Names" narrative="True to indicate that the column names from the collection should be written out as the first row; False to ignore the column names and just write out the data." expr="True" /></inputs><onsuccess>41fa3d59-2ce6-406f-b57e-ebd3e00cf924</onsuccess><resource object="MS Excel VBO" action="Write Collection" /></stage><stage stageid="10ef6e28-f85e-4b2c-9f47-b0c6cd9dc58d" name="MS Excel VBO::Create Instance" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="840" w="90" h="30" /><inputs><input type="flag" name="Enable Events" friendlyname="Enable Events" narrative="Flag to indicate that events should be enabled / disabled on the attached instance - defaulted to True" expr="" /></inputs><outputs><output type="number" name="handle" friendlyname="handle" narrative="An integer which can be used to identify the created instance in subsequent actions" stage="handle2" /></outputs><onsuccess>17a313ae-60ef-456a-9bd4-0d367348fc58</onsuccess><resource object="MS Excel VBO" action="Create Instance" /></stage><stage stageid="04d3ff5b-b9c1-4b5e-ba8b-fba6d942a5b7" name="Utility - File Management::Delete File" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="735" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The full path to the file to delete" expr="[Completed Filepath]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>12c4889e-0586-43b5-9c87-0728db6dceb2</onsuccess><resource object="Utility - File Management" action="Delete File" /></stage><stage stageid="17a313ae-60ef-456a-9bd4-0d367348fc58" name="MS Excel VBO::Create Workbook" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="885" w="90" h="30" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the workbook should be created. The default of zero indicates the currently active instance." expr="[handle2]" /></inputs><outputs><output type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook that Excel has created - this can be changed using the &quot;Save Workbook As&quot; action" stage="Workbook Name2" /></outputs><onsuccess>86c86f73-d4b6-4034-a059-92a7c26e115e</onsuccess><resource object="MS Excel VBO" action="Create Workbook" /></stage><stage stageid="2f4ceb27-9abf-42b6-ad07-c9e51f9b4a75" name="handle2" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="165" y="840" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b0333234-1c47-40e6-af19-0d03f2be1164" name="Workbook Name2" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="165" y="885" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="18bf5275-1ba5-4212-9777-aa576f5591b6" name="Anchor6" type="Anchor"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="-75" y="780" w="10" h="10" /><onsuccess>040cfc98-6d34-4285-b180-32475ffaa52d</onsuccess></stage><stage stageid="040cfc98-6d34-4285-b180-32475ffaa52d" name="Anchor7" type="Anchor"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="-75" y="1095" w="10" h="10" /><onsuccess>3505114b-f2f3-4309-bce8-7c2c6f8815ba</onsuccess></stage><stage stageid="4d6dc3c9-c9b5-4f22-91c3-aeeead9c06b3" name="Rewrite Excel File with Row Removed" type="Block"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="810" w="150" h="240" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="8e34a347-5922-4039-80e1-292bfa644f30" name="Empty out Item Data Review Filepath" type="Calculation"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="540" /><onsuccess>1a6d72bb-5935-403a-b2a1-97b4d3fda6f0</onsuccess><calculation expression="&quot;&quot;" stage="Item Data.Review Filepath" /></stage><stage stageid="1a6d72bb-5935-403a-b2a1-97b4d3fda6f0" name="Work Queues::Set Data" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><narrative>Sets the data on the specified item to the given value. 
The collection must contain one row exactly, and the key field, if present, must match the key field of the item being updated.
Also, the item must currently be locked by the current session - ie. it must have been retrieved using the 'Get Next' action.</narrative><display x="30" y="585" w="90" h="30" /><inputs><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the work item to set the data on. This item should be locked by the calling session." expr="[Item ID]" /><input type="collection" name="Data" friendlyname="Data" narrative="A collection with one row containing the data to be set on the item. If the item has a key value and this collection has a key value, they should match exactly." expr="[Item Data]" /></inputs><onsuccess>2dab6750-ac93-4011-9bc9-d94ee438905b</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Set Data" /></stage><stage stageid="66eb10ab-53c8-4a45-b8f5-2f77a44eab72" name="01a Manage Existing Review Files" type="SubSheetInfo"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><narrative>If the Review Filepath Item Data Field exists, it means that we *should have* wrote it out to a file. But there could be many reasons why this might have failed. This Page attempts to resolve those issues.</narrative><display x="-195" y="-30" w="150" h="90" /></stage><stage stageid="c12b0b75-2580-40b0-8420-26a15d2e0f7e" name="Start" type="Start"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="15" y="-45" /><onsuccess>e0cecda9-9a4c-42bd-a6c1-4f89061d1e6d</onsuccess></stage><stage stageid="f4fbd055-3716-454d-bbaf-270a11477a9a" name="End" type="End"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="-45" y="795" /><outputs><output type="flag" name="Continue File Creation?" stage="Continue File Creation?" /></outputs></stage><stage stageid="b654f35b-ef0d-461f-9689-27b57f884a72" name="In Temp Review?" type="Data"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="-165" y="60" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="6201d802-4cb4-487d-b964-f87b4fb30407" name="In To Review?" type="Data"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="-165" y="90" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="eb3cd680-bb45-4805-8110-7f40bc99c785" name="In Completed Review?" type="Data"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="-165" y="120" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="e0cecda9-9a4c-42bd-a6c1-4f89061d1e6d" name="Where is the Item Data Review File Referencing?" type="ChoiceStart"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="-60" y="15" w="90" h="30" /><groupid>626a75d5-3d56-499d-949d-66045d6fdfd4</groupid><choices><choice expression="StartsWith([Item Data.Review Filepath], [Ch6 Example 2 Temporary Review Folder Path])"><name>In Temporary Review</name><distance>45</distance><ontrue>6455aaa4-1e26-49bc-b080-4308bee5d2ad</ontrue></choice><choice expression="StartsWith([Item Data.Review Filepath], [Ch6 Example 2 To Review Folder Path])"><name>In To Review</name><distance>75</distance><ontrue>939ffbc7-12db-4541-905a-649907bd7206</ontrue></choice><choice expression="StartsWith([Item Data.Review Filepath], [Ch6 Example 2 Completed Review Folder Path])"><name>In Completed Review</name><distance>105</distance><ontrue>1a80f414-78eb-45d1-b7ae-b2931ed9819d</ontrue></choice></choices></stage><stage stageid="eb1c68e8-df0f-42a3-8141-1e529a413c14" name="Otherwise1" type="ChoiceEnd"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="-60" y="150" /><onsuccess>155109dd-dad3-4dd0-8b59-f1856d408c69</onsuccess><groupid>626a75d5-3d56-499d-949d-66045d6fdfd4</groupid></stage><stage stageid="6455aaa4-1e26-49bc-b080-4308bee5d2ad" name="Set Flag" type="Calculation"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="15" y="60" /><onsuccess>98bef66d-1704-4437-a9f7-3b5aa9e58b6c</onsuccess><calculation expression="True" stage="In Temp Review?" /></stage><stage stageid="939ffbc7-12db-4541-905a-649907bd7206" name="Set Flag" type="Calculation"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="15" y="90" /><onsuccess>94d1e5d3-64e0-427e-bdda-6186c62f4304</onsuccess><calculation expression="True" stage="In To Review?" /></stage><stage stageid="1a80f414-78eb-45d1-b7ae-b2931ed9819d" name="Set Flag" type="Calculation"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="15" y="120" /><onsuccess>7671b8ae-5a94-44b7-9582-952e1f433860</onsuccess><calculation expression="True" stage="In Completed Review?" /></stage><stage stageid="98bef66d-1704-4437-a9f7-3b5aa9e58b6c" name="Anchor8" type="Anchor"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="75" y="60" w="10" h="10" /><onsuccess>94d1e5d3-64e0-427e-bdda-6186c62f4304</onsuccess></stage><stage stageid="94d1e5d3-64e0-427e-bdda-6186c62f4304" name="Anchor9" type="Anchor"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="75" y="90" w="10" h="10" /><onsuccess>7671b8ae-5a94-44b7-9582-952e1f433860</onsuccess></stage><stage stageid="7671b8ae-5a94-44b7-9582-952e1f433860" name="Anchor10" type="Anchor"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="75" y="120" w="10" h="10" /><onsuccess>155109dd-dad3-4dd0-8b59-f1856d408c69</onsuccess></stage><stage stageid="155109dd-dad3-4dd0-8b59-f1856d408c69" name="Anchor11" type="Anchor"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="75" y="150" w="10" h="10" /><onsuccess>15191d28-954e-47c0-b26d-aaba866e12db</onsuccess></stage><stage stageid="15191d28-954e-47c0-b26d-aaba866e12db" name="Note3" type="Note"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><narrative>Find the actual file location, if it exists</narrative><display x="15" y="195" w="90" h="30" /><onsuccess>c907bd2f-80c0-4721-a3fa-3c19ac5b8423</onsuccess></stage><stage stageid="edda35cd-f27d-46fd-8629-5a45c111bbe2" name="Utility - File Management::File Exists" type="Action"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="15" y="330" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The name of the file to check" expr="[Ch6 Example 2 Temporary Review Folder Path] &amp; &quot;\&quot; &amp; [Filename]" /></inputs><outputs><output type="flag" name="Exists" friendlyname="Exists" narrative="True if the file exists" stage="Temporary File Exists?" /></outputs><onsuccess>d0de21c9-28cd-489c-ad17-d4079f23f579</onsuccess><resource object="Utility - File Management" action="File Exists" /></stage><stage stageid="73ee568d-1160-489c-9ba4-3fcffdceec03" name="Extract Filename" type="MultipleCalculation"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="15" y="285" /><onsuccess>edda35cd-f27d-46fd-8629-5a45c111bbe2</onsuccess><steps><calculation expression="Right([Item Data.Review Filepath], Len([Item Data.Review Filepath])-[Position])" stage="Filename" /></steps></stage><stage stageid="c907bd2f-80c0-4721-a3fa-3c19ac5b8423" name="Utility - Strings::InStrRev" type="Action"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="15" y="240" w="120" h="30" /><inputs><input type="text" name="Text" friendlyname="Text" narrative="Text to search in" expr="[Item Data.Review Filepath]" /><input type="text" name="Search String" friendlyname="Search String" narrative="The text to search for" expr="&quot;\&quot;" /><input type="number" name="Start Byte" friendlyname="Start Byte" narrative="Where in the string to search from" expr="" /><input type="number" name="Compare Method" friendlyname="Compare Method" narrative="1=text, 0=binary" expr="" /></inputs><outputs><output type="number" name="Position" friendlyname="Position" narrative="The index of the sub text within the text from the end or -1 if not found" stage="Position" /></outputs><onsuccess>73ee568d-1160-489c-9ba4-3fcffdceec03</onsuccess><resource object="Utility - Strings" action="InStrRev" /></stage><stage stageid="1879b679-6101-49ea-b8c1-d055f4fd6308" name="Position" type="Data"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="-165" y="240" w="90" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="444c3249-6b9b-43f5-abb7-72c05b490388" name="Filename" type="Data"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="-165" y="285" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7e99bca4-3c1d-477d-9a11-2793beaa1bae" name="Temporary File Exists?" type="Data"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="-165" y="330" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="d0de21c9-28cd-489c-ad17-d4079f23f579" name="Utility - File Management::File Exists" type="Action"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="15" y="375" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The name of the file to check" expr="[Ch6 Example 2 To Review Folder Path] &amp; &quot;\&quot; &amp; [Filename]" /></inputs><outputs><output type="flag" name="Exists" friendlyname="Exists" narrative="True if the file exists" stage="To File Exists?" /></outputs><onsuccess>a7b6279b-70bd-449a-ba2e-71c8101ee2db</onsuccess><resource object="Utility - File Management" action="File Exists" /></stage><stage stageid="a7b6279b-70bd-449a-ba2e-71c8101ee2db" name="Utility - File Management::File Exists" type="Action"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="15" y="420" w="90" h="30" /><inputs><input type="text" name="File Name" friendlyname="File Name" narrative="The name of the file to check" expr="[Ch6 Example 2 Completed Review Folder Path] &amp; &quot;\&quot; &amp; [Filename]" /></inputs><outputs><output type="flag" name="Exists" friendlyname="Exists" narrative="True if the file exists" stage="Completed File Exists?" /></outputs><onsuccess>855c548f-c28d-4746-bf28-371a464451d1</onsuccess><resource object="Utility - File Management" action="File Exists" /></stage><stage stageid="96da1704-ffff-4866-947a-88216d21f958" name="To File Exists?" type="Data"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="-165" y="375" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="79559077-4b43-4bd6-9e77-37d4ee64e01b" name="Completed File Exists?" type="Data"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="-165" y="420" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="855c548f-c28d-4746-bf28-371a464451d1" name="Completed File Exists?" type="Decision"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="15" y="465" w="90" h="30" /><decision expression="[Completed File Exists?]" /><ontrue>de30bc79-4f9b-4f10-966a-467bc42a245c</ontrue><onfalse>3240091f-30c4-4911-aa69-7b20d156f4b6</onfalse></stage><stage stageid="de30bc79-4f9b-4f10-966a-467bc42a245c" name="End8" type="End"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="120" y="465" /><outputs><output type="flag" name="Continue File Creation?" stage="Continue File Creation?" /></outputs></stage><stage stageid="4bcb4c76-f225-4aca-aeaf-3704168706a4" name="To File Exists but Record says it's in Temp Review" type="Decision"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="15" y="570" w="90" h="30" /><decision expression="[To File Exists?] AND [In Temp Review?]" /><ontrue>4e64ebf0-20b0-4a3e-8364-f45939be4f77</ontrue><onfalse>13c55db6-9317-4881-aa21-bf9dad216e54</onfalse></stage><stage stageid="4e64ebf0-20b0-4a3e-8364-f45939be4f77" name="Add To Review Filepath to Item Data" type="Calculation"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="120" y="570" w="90" h="30" /><onsuccess>9880ce4b-a358-4bef-aed4-40ea98a10d77</onsuccess><calculation expression="[Ch6 Example 2 To Review Folder Path] &amp; &quot;\&quot; &amp; [Filename]" stage="Item Data.Review Filepath" /></stage><stage stageid="9880ce4b-a358-4bef-aed4-40ea98a10d77" name="Work Queues::Set Data" type="Action"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><narrative>Sets the data on the specified item to the given value. 
The collection must contain one row exactly, and the key field, if present, must match the key field of the item being updated.
Also, the item must currently be locked by the current session - ie. it must have been retrieved using the 'Get Next' action.</narrative><display x="225" y="570" /><inputs><input type="collection" name="Data" friendlyname="Data" narrative="A collection with one row containing the data to be set on the item. If the item has a key value and this collection has a key value, they should match exactly." expr="[Item Data]" /><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the work item to set the data on. This item should be locked by the calling session." expr="[Item ID]" /></inputs><onsuccess>115d5ce6-8dd6-4ce8-afec-74fbd290ab33</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Set Data" /></stage><stage stageid="115d5ce6-8dd6-4ce8-afec-74fbd290ab33" name="End8" type="End"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="315" y="570" /><outputs><output type="flag" name="Continue File Creation?" stage="Continue File Creation?" /></outputs></stage><stage stageid="e790e4f6-da98-49a9-a56d-222e9cb66cc6" name="01a Manage Existing Review Files" type="SubSheet"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="135" y="90" w="90" h="60" /><outputs><output type="flag" name="Continue File Creation?" friendlyname="Continue File Creation?" stage="Continue File Creation?" /></outputs><onsuccess>e9829ba5-493e-4f85-a9e1-422ed9c049c8</onsuccess><processid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</processid></stage><stage stageid="b3a7d465-10d7-4c02-a8a7-73640f4620b0" name="Continue File Creation?" type="Data"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="-165" y="465" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="13c55db6-9317-4881-aa21-bf9dad216e54" name="Temporary File Exists and Record says it's in Temp Review" type="Decision"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="15" y="615" w="90" h="30" /><decision expression="[Temporary File Exists?] AND [In Temp Review?]" /><ontrue>fe16081f-17e8-4471-a933-59a73e5a1bd6</ontrue><onfalse>a046669a-f203-496f-b9c5-763e512b6bce</onfalse></stage><stage stageid="fe16081f-17e8-4471-a933-59a73e5a1bd6" name="Utility - File Management::Move File" type="Action"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="660" w="90" h="30" /><inputs><input type="text" name="File Path" friendlyname="File Path" narrative="The full path to the file to move" expr="[Ch6 Example 2 Temporary Review Folder Path] &amp; &quot;\&quot; &amp; [Filename]" /><input type="text" name="Destination Path" friendlyname="Destination Path" narrative="The path to the folder to move the file to" expr="[Ch6 Example 2 To Review Folder Path] &amp; &quot;\&quot; &amp; [Filename]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>94b21fbb-9691-4225-865e-69be9a10b890</onsuccess><resource object="Utility - File Management" action="Move File" /></stage><stage stageid="94b21fbb-9691-4225-865e-69be9a10b890" name="Add To Review Filepath to Item Data" type="Calculation"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="-45" y="705" w="90" h="30" /><onsuccess>adc2402b-d508-4e5f-8881-7b7221742e4c</onsuccess><calculation expression="[Ch6 Example 2 To Review Folder Path] &amp; &quot;\&quot; &amp; [Filename]&#xA;" stage="Item Data.Review Filepath" /></stage><stage stageid="adc2402b-d508-4e5f-8881-7b7221742e4c" name="Work Queues::Set Data" type="Action"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><narrative>Sets the data on the specified item to the given value. 
The collection must contain one row exactly, and the key field, if present, must match the key field of the item being updated.
Also, the item must currently be locked by the current session - ie. it must have been retrieved using the 'Get Next' action.</narrative><display x="-45" y="750" /><inputs><input type="collection" name="Data" friendlyname="Data" narrative="A collection with one row containing the data to be set on the item. If the item has a key value and this collection has a key value, they should match exactly." expr="[Item Data]" /><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the work item to set the data on. This item should be locked by the calling session." expr="[Item ID]" /></inputs><onsuccess>f4fbd055-3716-454d-bbaf-270a11477a9a</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Set Data" /></stage><stage stageid="a046669a-f203-496f-b9c5-763e512b6bce" name="Note2" type="Note"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><narrative>Something odd has happened, redo the file creation</narrative><display x="90" y="675" w="90" h="60" /><onsuccess>807fccd7-1080-4c49-85ac-169e0b880cc4</onsuccess></stage><stage stageid="807fccd7-1080-4c49-85ac-169e0b880cc4" name="Set Continue File Creation?" type="Calculation"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="90" y="750" /><onsuccess>9f1d5197-5253-4ca3-b1dc-d90a7e6fbe82</onsuccess><calculation expression="True" stage="Continue File Creation?" /></stage><stage stageid="9f1d5197-5253-4ca3-b1dc-d90a7e6fbe82" name="End" type="End"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="90" y="795" /><outputs><output type="flag" name="Continue File Creation?" stage="Continue File Creation?" /></outputs></stage><stage stageid="2f56cfa8-0182-47f5-8902-b143dc4add31" name="Continue File Creation?" type="Data"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="225" y="75" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e9829ba5-493e-4f85-a9e1-422ed9c049c8" name="Continue File Creation?" type="Decision"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><display x="135" y="150" /><decision expression="[Continue File Creation?]" /><ontrue>6f44d75e-256c-4592-b074-0c7ebe82fdd7</ontrue><onfalse>b426430e-38e0-4ab7-9251-dddbcde6983a</onfalse></stage><stage stageid="b426430e-38e0-4ab7-9251-dddbcde6983a" name="End6" type="End"><subsheetid>67e5431f-68ab-4a3c-98ca-9f7ac08d305a</subsheetid><loginhibit onsuccess="true" /><display x="225" y="150" /></stage><stage stageid="593186c1-fa5e-4efa-9be4-bfb8e21e3ada" name="Success" type="Data"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="-135" y="660" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="15f4a458-a8b0-41bd-9c1f-257f6ae9bea0" name="Message" type="Data"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="-195" y="660" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f410c62d-7691-4f6f-831b-28afdf66c1db" name="Extract Filename" type="MultipleCalculation"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="-135" /><onsuccess>a0722868-1c0d-438e-913c-9688de5b8de7</onsuccess><steps><calculation expression="Right([Item Data.Review Filepath], Len([Item Data.Review Filepath])-[Position])" stage="Filename" /></steps></stage><stage stageid="41c12b2b-a528-49de-9ed9-2f73c1695d97" name="Utility - Strings::InStrRev" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="30" y="-180" w="120" h="30" /><inputs><input type="text" name="Text" friendlyname="Text" narrative="Text to search in" expr="[Item Data.Review Filepath]" /><input type="text" name="Search String" friendlyname="Search String" narrative="The text to search for" expr="&quot;\&quot;" /><input type="number" name="Start Byte" friendlyname="Start Byte" narrative="Where in the string to search from" expr="" /><input type="number" name="Compare Method" friendlyname="Compare Method" narrative="1=text, 0=binary" expr="" /></inputs><outputs><output type="number" name="Position" friendlyname="Position" narrative="The index of the sub text within the text from the end or -1 if not found" stage="Position" /></outputs><onsuccess>f410c62d-7691-4f6f-831b-28afdf66c1db</onsuccess><resource object="Utility - Strings" action="InStrRev" /></stage><stage stageid="a9106065-d4e1-44af-a4b7-4d1ae158e22f" name="Position" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="150" y="-180" w="90" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0158b1a7-c7e9-4f50-b1f0-3cdb321b998e" name="Filename" type="Data"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="150" y="-135" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c98c8c63-ea12-4016-8fc0-ce0cb6083a9b" name="Recover1" type="Recover"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit /><display x="315" y="690" /><onsuccess>139d9c01-f148-4d06-ba37-825b48682295</onsuccess></stage><stage stageid="139d9c01-f148-4d06-ba37-825b48682295" name="Release Lock" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><narrative>Releases the lock(s) associated with the given name and token</narrative><display x="315" y="735" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Name" narrative="The name of the specific lock to be released. Default behaviour is to release all locks with the given token." expr="[Lock Prefix] &amp; [Completed Filepath]" /><input type="text" name="Token" narrative="The token associated with the lock(s) to be released. Mandatory parameter." expr="[Lock Token]" /><input type="text" name="Comment" narrative="The comments to set on the lock(s)" expr="&quot;Release lock&quot;" /><input type="flag" name="All Sessions" narrative="True to release locks matching the specified constraints across all sessions; False to only release locks acquired in the current session. Default is False" expr="True" /><input type="flag" name="Keep Environment Lock" friendlyname="Keep Environment Lock" narrative="The environment lock will be kept after that lock is released. Default behaviour is to delete the lock." expr="" /></inputs><onsuccess>33a3ee52-300f-4112-b662-70e0feca4500</onsuccess><resource object="BluePrism.AutomateAppCore.clsEnvironmentLockingBusinessObject" action="Release Lock" /></stage><stage stageid="33a3ee52-300f-4112-b662-70e0feca4500" name="Rethrow" type="Exception"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><display x="315" y="780" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="3240091f-30c4-4911-aa69-7b20d156f4b6" name="To File Exists and Record says it's in ToReview" type="Decision"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><display x="15" y="510" w="90" h="30" /><decision expression="[To File Exists?] AND [In To Review?]" /><ontrue>45a7f571-f125-46c6-b04d-69b90798c48c</ontrue><onfalse>4bcb4c76-f225-4aca-aeaf-3704168706a4</onfalse></stage><stage stageid="45a7f571-f125-46c6-b04d-69b90798c48c" name="End8" type="End"><subsheetid>ef0659f6-bb8d-47b2-8192-3db5829a06fc</subsheetid><loginhibit onsuccess="true" /><display x="120" y="510" /><outputs><output type="flag" name="Continue File Creation?" stage="Continue File Creation?" /></outputs></stage><stage stageid="09c2dd26-6d7b-45d6-879c-f1aab42f3c69" name="Collections::Add Row" type="Action"><subsheetid>316831fa-0689-4cbd-9c71-69dc6fb0e523</subsheetid><loginhibit onsuccess="true" /><display x="165" y="390" w="90" h="30" /><inputs><input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Unworked Data&quot;" /></inputs><onsuccess>de2ab084-41f0-4c00-9e7c-3dafea8e3225</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" /></stage><stage stageid="481ebbb3-76c2-4519-83df-9ffddc9ce7f5" name="Move Temporary Files" type="SubSheetInfo"><subsheetid>662bb400-cee8-49c6-8023-b0c34da4c426</subsheetid><narrative>If there are any files that haven't been moved to the "To Review" folder due to Exception, Stop Request or not meeting the batch file size limit, move the files here. Terminations won't result on files copied, but the next time the process runs, and ends for a non-termination reason, this should catch it.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="08081f15-b177-4545-b415-b50bdfb73065" name="Start" type="Start"><subsheetid>662bb400-cee8-49c6-8023-b0c34da4c426</subsheetid><display x="15" y="-120" /><onsuccess>da7026c6-122c-49eb-9a58-8e64e55b457d</onsuccess></stage><stage stageid="4740a762-f674-4cc5-b4a5-5b045ca4f6cb" name="End" type="End"><subsheetid>662bb400-cee8-49c6-8023-b0c34da4c426</subsheetid><display x="15" y="150" /></stage><stage stageid="da7026c6-122c-49eb-9a58-8e64e55b457d" name="Utility - File Management::Get Files" type="Action"><subsheetid>662bb400-cee8-49c6-8023-b0c34da4c426</subsheetid><loginhibit onsuccess="true" /><narrative>Slash needs to be added to the end</narrative><display x="15" y="-60" w="90" h="30" /><inputs><input type="text" name="Folder" friendlyname="Folder" narrative="The folder in which to look for files" expr="[Ch6 Example 2 Temporary Review Folder Path] &amp; &quot;\&quot;" /><input type="text" name="Patterns CSV" friendlyname="Patterns CSV" narrative="The comma seperated list of wildcard patterns" expr="&quot;review_&quot; &amp; GetResourceName() &amp; &quot;*.xlsx&quot;" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="A message if unsuccessful" stage="Message" /><output type="collection" name="Files" friendlyname="Files" narrative="The collection of files found" stage="Files" /></outputs><onsuccess>94b1ff6c-33f6-46f3-a7d3-4214585a6eed</onsuccess><resource object="Utility - File Management" action="Get Files" /></stage><stage stageid="bbbd9222-1a21-4a90-b167-80645047635e" name="Success" type="Data"><subsheetid>662bb400-cee8-49c6-8023-b0c34da4c426</subsheetid><display x="-195" y="0" w="150" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3e1aeed0-c8ab-4698-ac9d-4741f0388a7e" name="Message" type="Data"><subsheetid>662bb400-cee8-49c6-8023-b0c34da4c426</subsheetid><display x="-195" y="30" w="150" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bc037b84-b5bd-43c5-80df-b3032f9e3c2d" name="Files" type="Collection"><subsheetid>662bb400-cee8-49c6-8023-b0c34da4c426</subsheetid><display x="-195" y="-30" w="150" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="94b1ff6c-33f6-46f3-a7d3-4214585a6eed" name="Loop Files" type="LoopStart"><subsheetid>662bb400-cee8-49c6-8023-b0c34da4c426</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-15" w="120" h="30" /><onsuccess>8de7e5a6-7abc-4825-8c63-dffa9c012e62</onsuccess><groupid>a125757c-0e71-46a7-a788-56f76e62f443</groupid><looptype>ForEach</looptype><loopdata>Files</loopdata></stage><stage stageid="17889c18-2478-4611-80f9-27802490be44" name="Loop Files" type="LoopEnd"><subsheetid>662bb400-cee8-49c6-8023-b0c34da4c426</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="120" h="30" /><onsuccess>4740a762-f674-4cc5-b4a5-5b045ca4f6cb</onsuccess><groupid>a125757c-0e71-46a7-a788-56f76e62f443</groupid></stage><stage stageid="cc1c09a8-a084-43d1-bb2c-9ce7dbf112f9" name="Note16" type="Note"><subsheetid>662bb400-cee8-49c6-8023-b0c34da4c426</subsheetid><narrative>No lock is needed because we will filter files based on this Resource's name</narrative><display x="165" y="-120" w="120" h="60" /><onsuccess>da7026c6-122c-49eb-9a58-8e64e55b457d</onsuccess></stage><stage stageid="8de7e5a6-7abc-4825-8c63-dffa9c012e62" name="Utility - File Management::Move File" type="Action"><subsheetid>662bb400-cee8-49c6-8023-b0c34da4c426</subsheetid><loginhibit onsuccess="true" /><display x="15" y="30" w="90" h="30" /><inputs><input type="text" name="File Path" friendlyname="File Path" narrative="The full path to the file to move" expr="[Files.Path]" /><input type="text" name="Destination Path" friendlyname="Destination Path" narrative="The path to the folder to move the file to" expr="[Ch6 Example 2 To Review Folder Path]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>17889c18-2478-4611-80f9-27802490be44</onsuccess><resource object="Utility - File Management" action="Move File" /></stage><stage stageid="ae81f58b-83bf-44d0-b113-54eafc997c27" name="Move Temporary Files" type="SubSheet"><subsheetid>cf13a1fa-a9be-4527-973b-e2f66f99d14b</subsheetid><loginhibit onsuccess="true" /><display x="-15" y="-195" /><onsuccess>9092535a-fa8e-415b-bbf1-919c06b8f6e5</onsuccess><processid>662bb400-cee8-49c6-8023-b0c34da4c426</processid></stage><stage stageid="51a68c71-981c-43cf-a5de-4ea5a9ebae46" name="Move Temporary Files" type="Block"><subsheetid>662bb400-cee8-49c6-8023-b0c34da4c426</subsheetid><loginhibit onsuccess="true" /><display x="-75" y="-90" w="240" h="210" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="3c2610ab-1a02-4a97-aa05-1fcedc14d219" name="Recover2" type="Recover"><subsheetid>662bb400-cee8-49c6-8023-b0c34da4c426</subsheetid><loginhibit /><display x="120" y="75" /><onsuccess>c6a9bb64-41ac-491a-aeb8-984357808af9</onsuccess></stage><stage stageid="c6a9bb64-41ac-491a-aeb8-984357808af9" name="Resume1" type="Resume"><subsheetid>662bb400-cee8-49c6-8023-b0c34da4c426</subsheetid><loginhibit /><display x="120" y="150" /><onsuccess>4740a762-f674-4cc5-b4a5-5b045ca4f6cb</onsuccess></stage></process></process>
        <work-queue id="6" name="Chapter 6 Example 2 Queue" key-field="customer_id" xmlns="http://www.blueprism.co.uk/product/work-queue" />
        <environment-variable id="Ch6 Example 2 Completed Review Folder Path" name="Ch6 Example 2 Completed Review Folder Path" type="text" value="C:\Users\Public\Ch6_ex2\Completed_Review" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>The folder where items that have been reviewed are saved</description>
        </environment-variable>
        <environment-variable id="Ch6 Example 2 Random Sampling Target" name="Ch6 Example 2 Random Sampling Target" type="number" value="100.0" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>The percentage of ML predictions that should be manually reviewed</description>
        </environment-variable>
        <environment-variable id="Ch6 Example 2 Review Batch Size" name="Ch6 Example 2 Review Batch Size" type="number" value="5" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>How many reviews should be written into each Excel file</description>
        </environment-variable>
        <environment-variable id="Ch6 Example 2 Temporary Review Folder Path" name="Ch6 Example 2 Temporary Review Folder Path" type="text" value="C:\Users\Public\Ch6_ex2\Temporary_Review" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>The folder where temporary excel files are stored</description>
        </environment-variable>
        <environment-variable id="Ch6 Example 2 To Review Folder Path" name="Ch6 Example 2 To Review Folder Path" type="text" value="C:\Users\Public\Ch6_ex2\To_Review" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>The folder where items that need reviewing are saved</description>
        </environment-variable>
        <process-group id="44c66d56-951d-42b6-857f-43d4cff309ba" name="Ch6" isDefaultGroup="False" xmlns="http://www.blueprism.co.uk/product/process-group">
            <members>
                <process id="0b265c19-a58d-4278-81a0-f61ea018874b" />
                <process id="c264180c-0a38-47bc-b805-78f0aaa1dd24" />
            </members>
        </process-group>
    </bpr:contents>
</bpr:release>