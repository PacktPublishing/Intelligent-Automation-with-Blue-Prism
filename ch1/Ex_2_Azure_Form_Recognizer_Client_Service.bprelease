<?xml version="1.0" encoding="utf-8"?>
<bpr:release xmlns:bpr="http://www.blueprism.co.uk/product/release">
    <bpr:name>1.1</bpr:name>
    <bpr:release-notes />
    <bpr:created>2023-11-22 10:18:54Z</bpr:created>
    <bpr:package-id>11</bpr:package-id>
    <bpr:package-name>Ch1 - Example 2 Azure Form Recognizer Client Service</bpr:package-name>
    <bpr:user-created-by>admin</bpr:user-created-by>
    <bpr:contents count="4">
        <object id="c539f5ff-58d5-465a-b5c4-5064856a0d27" name="Form Recognizer Client Service" xmlns="http://www.blueprism.co.uk/product/process"><process name="Form Recognizer Client Service" version="1.0" bpversion="7.1.2.3518" narrative="Form Recognizer Client Service. Updated by James Man to work with version 2022-08-31 of the API.&#xD;&#xA;https://westus.dev.cognitive.microsoft.com/docs/services/form-recognizer-api-2022-08-31/operations/AnalyzeDocument" byrefcollection="true" type="object" runmode="Exclusive"><appdef><element name="Application Root"><id>07aa9b58-8d78-4d25-bfc0-8e7c28fe5085</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>71</camerax><cameray>-50</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="25a59034-23b1-4f8f-b7c5-cd347d45ebbc" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a015cab0-8db6-416c-9c72-3a9132519c41" type="Normal" published="True"><name>Analyze Layout Async</name><view><camerax>0</camerax><cameray>-76</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="4669712d-d9da-433b-838c-718f50fcdb24" type="Normal" published="True"><name>Analyze Receipt Async</name><view><camerax>0</camerax><cameray>18</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="39b59235-9b00-4516-bec3-13b86000e68d" type="Normal" published="True"><name>Analyze Business Card Async</name><view><camerax>8</camerax><cameray>19</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261" type="Normal" published="True"><name>Analyze Invoice Async</name><view><camerax>-26</camerax><cameray>84</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="cf3d4c84-16ac-4774-bf05-1e9ad404b14d" type="Normal" published="True"><name>Analyze With Custom Model</name><view><camerax>-38</camerax><cameray>-50</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="28240292-4eb5-4713-a7e0-cdd9d0941b50" type="Normal" published="True"><name>Get Analyze Layout Result</name><view><camerax>-23</camerax><cameray>404</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a954bb29-beee-4795-97db-d0908a1bb6e9" type="Normal" published="True"><name>Get Analyze Receipt Result</name><view><camerax>-154</camerax><cameray>312</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="bee61c46-946f-40ee-89fc-9dfb92499f1c" type="Normal" published="True"><name>Get Analyze Business Card Result</name><view><camerax>45</camerax><cameray>349</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="14efa442-31c1-4af3-9af8-6d7004f91701" type="Normal" published="True"><name>Get Analyze Invoice Result</name><view><camerax>0</camerax><cameray>240</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="ee057f0b-147e-4d1c-ba06-e7ba648dd78c" type="Normal" published="True"><name>Get Analyze Custom Model Result</name><view><camerax>0</camerax><cameray>-81</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="d7947423-0488-44fa-bcb3-12a7113b6399" type="Normal" published="True"><name>Delete Custom Model</name><view><camerax>0</camerax><cameray>19</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="15065b9d-c113-4686-a586-0378bfca8e9f" type="Normal" published="True"><name>Get Custom Model</name><view><camerax>-76</camerax><cameray>61</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="2f665482-f11d-4fed-bacf-dab63bf57357" type="Normal" published="True"><name>Get Custom Models</name><view><camerax>0</camerax><cameray>-7</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="8c3de159-a333-4755-b49f-551dc0ad8152" name="Start" type="Start"><loginhibit /><display x="15" y="-105" /><onsuccess>fb4a13b1-785a-4c7e-bce2-46089531afa2</onsuccess></stage><stage stageid="fb4a13b1-785a-4c7e-bce2-46089531afa2" name="End" type="End"><loginhibit /><display x="15" y="90" /></stage><stage stageid="a85b4237-4daa-4a3f-bb0a-0ab5f7bd2718" name="Stage1" type="ProcessInfo"><display x="-195" y="-105" w="150" h="90" /><references><reference>System.dll</reference><reference>System.Data.dll</reference><reference>System.Xml.dll</reference><reference>System.Drawing.dll</reference></references><imports><import>System</import><import>System.Drawing</import><import>System.Data</import></imports><language>visualbasic</language><globalcode><![CDATA[]]></globalcode><code><![CDATA[]]></code></stage><stage stageid="b63d5276-92bb-44b0-8340-40d91e5b72ae" name="Clean Up" type="SubSheetInfo"><subsheetid>25a59034-23b1-4f8f-b7c5-cd347d45ebbc</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="75371ed3-bdd5-4e77-99d6-c70582cf5831" name="Start" type="Start"><subsheetid>25a59034-23b1-4f8f-b7c5-cd347d45ebbc</subsheetid><loginhibit /><display x="15" y="-105" /><onsuccess>ca355be2-3755-4204-9766-13883f497d3b</onsuccess></stage><stage stageid="ca355be2-3755-4204-9766-13883f497d3b" name="End" type="End"><subsheetid>25a59034-23b1-4f8f-b7c5-cd347d45ebbc</subsheetid><loginhibit /><display x="15" y="90" /></stage><stage stageid="60ec1cc4-c17d-415a-ad0a-836c26eed22d" name="Analyze Layout Async" type="SubSheetInfo"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><narrative>Extract text and layout information from a given document. The input document must be of one of the supported content types - 'application/pdf', 'image/jpeg', 'image/png', 'image/tiff' or 'image/bmp'.</narrative><display x="-270" y="-135" w="150" h="90" /></stage><stage stageid="66d7578b-e045-42e3-b7ca-81a991955beb" name="" type="Note"><subsheetid>25a59034-23b1-4f8f-b7c5-cd347d45ebbc</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="0e7446e6-8908-44b2-a6c1-a7539cd1e3fe" name="" type="Note"><narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="0441ea2c-05ec-4961-9202-2b6eae98d562" name="Start" type="Start"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="FilePath" narrative="The path of the file" stage="FileMetadata.FilePath" /></inputs><onsuccess>379f2471-31ea-4446-b990-e091d76c5757</onsuccess></stage><stage stageid="9c1f2ac9-db23-4fa1-9a33-ea5a73c76c27" name="Local" type="Block"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><loginhibit /><display x="-420" y="135" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="fb681ce3-9c13-4201-b329-f684a00ac2dd" name="Output" type="Block"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><loginhibit /><display x="-420" y="30" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="a40edecf-0cf5-416e-b6ca-4d9765ef91ee" name="Input" type="Block"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><loginhibit /><display x="-420" y="-75" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="99CCFF" /></stage><stage stageid="48d436ac-3a1c-4a70-ae30-23532b7ed4d2" name="End" type="End"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><loginhibit /><display x="15" y="135" /><outputs><output type="flag" name="Success" narrative="A flag indicating the success or failure of the action." stage="Success" /><output type="text" name="Response Message" narrative="If an error is encountered, further details may be available here." stage="Response Message" /><output type="text" name="Result ID" narrative="Result ID used to query the status of the asynchronous operation and get the results." stage="Response Collection.apim-request-id" /></outputs></stage><stage stageid="379f2471-31ea-4446-b990-e091d76c5757" name="HTTP Request" type="Action"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" w="90" h="30" /><inputs><input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="[Base URL] &amp; &quot;/formrecognizer/documentModels/prebuilt-layout:analyze?api-version=2022-08-31&quot;" /><input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" /><input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" /><input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" /><input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" /><input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="[Access Token]" /><input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" narrative="OPTIONAL: If you need bearer token authorization set this to true." expr="" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you have a bearer token and need to use authorization" expr="" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="" /><input type="collection" name="FileMetadata" friendlyname="FileMetadata" narrative="Files to be sent in the multipart HTTP  request" expr="[FileMetadata]" /><input type="collection" name="FieldMetadata" friendlyname="FieldMetadata" narrative="Text data to be sent in the multipart HTTP  request" expr="" /></inputs><outputs><output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="Headers as Json" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="Status Code" /></outputs><onsuccess>0987b1c5-56b5-41dc-8de8-9fb773360d98</onsuccess><resource object="Utility - HTTP" action="HTTP Request Multipart" /></stage><stage stageid="02965c61-65a3-4cf8-98e9-fdd46f726bc8" name="Result" type="Data"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><display x="-345" y="195" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f0c653e4-1341-4a63-b45b-50dd2b5cd530" name="Headers as Json" type="Data"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><display x="-225" y="165" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="93d01977-3723-4381-b3ba-d19c17a4d9b5" name="Status Code" type="Data"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><display x="-345" y="165" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0987b1c5-56b5-41dc-8de8-9fb773360d98" name="202?" type="Decision"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><loginhibit /><display x="15" y="15" /><decision expression="[Status Code] = 202" /><ontrue>a2249e4f-6810-48b8-8dbb-6fd6f5dac474</ontrue><onfalse>2b34d3d1-c5c6-4752-8639-1387a8ecfd75</onfalse></stage><stage stageid="2b34d3d1-c5c6-4752-8639-1387a8ecfd75" name="Set Failed" type="MultipleCalculation"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><loginhibit /><display x="-75" y="15" /><onsuccess>dc2e02e3-704a-4b62-8116-58c0599c17fb</onsuccess><steps><calculation expression="False" stage="Success" /><calculation expression="&quot;Status Code: &quot; &amp; [Status Code] &amp; &quot; Result: &quot; &amp; [Result]" stage="Response Message" /></steps></stage><stage stageid="dc2e02e3-704a-4b62-8116-58c0599c17fb" name="Anchor5" type="Anchor"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><loginhibit /><display x="-75" y="135" w="10" h="10" /><onsuccess>48d436ac-3a1c-4a70-ae30-23532b7ed4d2</onsuccess></stage><stage stageid="3dcb0f54-c4fa-4012-9a2a-f593de375ab6" name="Access Token" type="Collection"><loginhibit /><display x="180" y="-90" w="120" h="30" /><datatype>collection</datatype><alwaysinit /><collectioninfo><singlerow /><field name="Ocp-Apim-Subscription-Key" type="password" /></collectioninfo><initialvalue><singlerow /><row><field name="Ocp-Apim-Subscription-Key" type="password" encvalue="aCpGKl8qTyp6KlgqQypZKkcqBCppKkUqRypHKkUqRCoEKnkqTypJKl8qWCpDKl4qUyoEKnkqQypHKloqRipPKmUqSCpMKl8qWSpJKksqXipFKlgq:" /></row></initialvalue></stage><stage stageid="4bcb5434-1623-4751-ab67-9cbaaeb75198" name="Note2" type="Note"><narrative>© 2022 Blue Prism Limited
Licensed under the Blue Prism Asset License and Support Terms
https://digitalexchange.blueprism.com/fileMedia/download/a9111324-3192-43ff-9166-566620ca1182</narrative><display x="240" y="-180" w="330" h="90" /><font family="Segoe UI" size="12" style="Regular" color="0000FF" /></stage><stage stageid="eaf83e4b-ca21-4040-8249-c91396ac79a8" name="Global" type="Block"><loginhibit /><display x="105" y="-120" w="270" h="240" /><font family="Segoe UI" size="10" style="Regular" color="808080" /></stage><stage stageid="626e820f-3def-485b-8097-3775fcc87223" name="Base URL" type="Data"><loginhibit /><display x="300" y="-90" w="120" h="30" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="0fde2267-ba6a-4248-9aed-80c0f53defee" name="FileMetadata" type="Collection"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><loginhibit /><narrative>Files to be sent in the multipart HTTP  request</narrative><display x="-345" y="-45" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><singlerow /><field name="FileName" type="text" description="Optional. Used to populate the filename header for this file's section in the multi-part form body. If a value is not specified, the filename is used from the provided filepath" /><field name="FieldName" type="text" description="Optional. Used to populate the name header for this file's section in the multi-part form body. If a value is not specified, the filename is set to 'file'" /><field name="ContentType" type="text" description="Optional. Used to populate the Content-Type header for this file's section in the multi-part form body. If a value is not specified, the mimetype of the document is used." /><field name="FilePath" type="text" description="The path of the file" /></collectioninfo><initialvalue><singlerow /><row><field name="FileName" type="text" value="" /><field name="FieldName" type="text" value="urlSource" /><field name="ContentType" type="text" value="" /><field name="FilePath" type="text" value="" /></row></initialvalue></stage><stage stageid="a2249e4f-6810-48b8-8dbb-6fd6f5dac474" name="Utility - JSON::JSON to Collection (skipping JArray)" type="Action"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="90" h="30" /><inputs><input type="text" name="json" friendlyname="json" expr="[Headers as Json]" /></inputs><outputs><output type="collection" name="Result" friendlyname="Result" stage="Response Collection" /></outputs><onsuccess>48d436ac-3a1c-4a70-ae30-23532b7ed4d2</onsuccess><resource object="Utility - JSON" action="JSON to Collection (skipping JArray)" /></stage><stage stageid="0c52b4c0-1341-4da3-8297-95e1d90dc07b" name="Response Collection" type="Collection"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><display x="-345" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="a5a56d98-bc30-49a2-a36c-7645994da89e" name="Analyze Receipt Async" type="SubSheetInfo"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><narrative>Extract field text and semantic values from a given receipt document. The input document must be of one of the supported content types - 'application/pdf', 'image/jpeg', 'image/png' or 'image/tiff'. </narrative><display x="-300" y="-135" w="150" h="90" /></stage><stage stageid="21f352a4-0308-448d-a8da-61b069344033" name="Start" type="Start"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="FilePath" narrative="The path of the file" stage="FileMetadata.FilePath" /></inputs><onsuccess>e629185e-50c7-42d4-8b43-a3307688d359</onsuccess></stage><stage stageid="00c95d0e-356e-4231-9f55-b4df5e2ca61a" name="Local" type="Block"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><loginhibit /><display x="-420" y="135" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="bb3020fb-4700-45ac-b6d0-3c450560ffa6" name="Output" type="Block"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><loginhibit /><display x="-420" y="30" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="c8beb58f-5565-4179-bb10-d79aa387bd83" name="Input" type="Block"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><loginhibit /><display x="-420" y="-75" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="99CCFF" /></stage><stage stageid="e3e324fc-3cc3-4b89-bfa2-20cf95bda225" name="End" type="End"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><loginhibit /><display x="15" y="135" /><outputs><output type="flag" name="Success" narrative="A flag indicating the success or failure of the action." stage="Success" /><output type="text" name="Response Message" narrative="If an error is encountered, further details may be available here." stage="Response Message" /><output type="text" name="Result ID" narrative="Result ID used to query the status of the asynchronous operation and get the results." stage="Response Collection.apim-request-id" /></outputs></stage><stage stageid="e629185e-50c7-42d4-8b43-a3307688d359" name="HTTP Request" type="Action"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" w="90" h="30" /><inputs><input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="[Base URL] &amp; &quot;/formrecognizer/documentModels/prebuilt-receipt:analyze?api-version=2022-08-31&quot;" /><input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" /><input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" /><input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" /><input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" /><input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="[Access Token]" /><input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" narrative="OPTIONAL: If you need bearer token authorization set this to true." expr="" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you have a bearer token and need to use authorization" expr="" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="" /><input type="collection" name="FileMetadata" friendlyname="FileMetadata" narrative="Files to be sent in the multipart HTTP  request" expr="[FileMetadata]" /><input type="collection" name="FieldMetadata" friendlyname="FieldMetadata" narrative="Text data to be sent in the multipart HTTP  request" expr="" /></inputs><outputs><output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="Headers as Json" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="Status Code" /></outputs><onsuccess>afc8066a-aa39-4dda-b44d-71f10f03677e</onsuccess><resource object="Utility - HTTP" action="HTTP Request Multipart" /></stage><stage stageid="ae2bd133-358c-4d02-8e69-69bc2422fd27" name="Result" type="Data"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><display x="-345" y="195" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="db42549a-7cd2-465f-9b3b-ba7de8da3f3c" name="Headers as Json" type="Data"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><display x="-225" y="165" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="414c746e-f4e7-4c9d-9ea2-89a2762aa641" name="Status Code" type="Data"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><display x="-345" y="165" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="afc8066a-aa39-4dda-b44d-71f10f03677e" name="202?" type="Decision"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><loginhibit /><display x="15" y="15" /><decision expression="[Status Code] = 202" /><ontrue>91c6cb53-2cac-413c-9630-23615ab11eb4</ontrue><onfalse>e428ac5b-fab6-4cea-b307-6252a57b4b58</onfalse></stage><stage stageid="e428ac5b-fab6-4cea-b307-6252a57b4b58" name="Set Failed" type="MultipleCalculation"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><loginhibit /><display x="-75" y="15" /><onsuccess>9ecd75fa-2b26-4f68-992f-dc17e91e261a</onsuccess><steps><calculation expression="False" stage="Success" /><calculation expression="&quot;Status Code: &quot; &amp; [Status Code] &amp; &quot; Result: &quot; &amp; [Result]" stage="Response Message" /></steps></stage><stage stageid="9ecd75fa-2b26-4f68-992f-dc17e91e261a" name="Anchor5" type="Anchor"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><loginhibit /><display x="-75" y="135" w="10" h="10" /><onsuccess>e3e324fc-3cc3-4b89-bfa2-20cf95bda225</onsuccess></stage><stage stageid="91c6cb53-2cac-413c-9630-23615ab11eb4" name="Utility - JSON::JSON to Collection (skipping JArray)" type="Action"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="90" h="30" /><inputs><input type="text" name="json" friendlyname="json" expr="[Headers as Json]" /></inputs><outputs><output type="collection" name="Result" friendlyname="Result" stage="Response Collection" /></outputs><onsuccess>e3e324fc-3cc3-4b89-bfa2-20cf95bda225</onsuccess><resource object="Utility - JSON" action="JSON to Collection (skipping JArray)" /></stage><stage stageid="e9ff2344-2dd2-4e28-b541-777cbc51928c" name="FileMetadata" type="Collection"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><loginhibit /><narrative>Files to be sent in the multipart HTTP  request</narrative><display x="-345" y="-30" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><singlerow /><field name="FileName" type="text" description="Optional. Used to populate the filename header for this file's section in the multi-part form body. If a value is not specified, the filename is used from the provided filepath" /><field name="FieldName" type="text" description="Optional. Used to populate the name header for this file's section in the multi-part form body. If a value is not specified, the filename is set to 'file'" /><field name="ContentType" type="text" description="Optional. Used to populate the Content-Type header for this file's section in the multi-part form body. If a value is not specified, the mimetype of the document is used." /><field name="FilePath" type="text" description="The path of the file" /></collectioninfo><initialvalue><singlerow /><row><field name="FileName" type="text" value="" /><field name="FieldName" type="text" value="urlSource" /><field name="ContentType" type="text" value="" /><field name="FilePath" type="text" value="" /></row></initialvalue></stage><stage stageid="e0b6694e-1a77-4e24-8c94-a31992dbc175" name="Analyze With Custom Model" type="SubSheetInfo"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><narrative>Extract key-value pairs, tables, and semantic values from a given document. The input document must be of one of the supported content types - 'application/pdf', 'image/jpeg', 'image/png' or 'image/tiff'.</narrative><display x="-285" y="-150" w="150" h="90" /></stage><stage stageid="d518605b-b7ed-4bdf-bdc6-1327f79bbc1a" name="Start" type="Start"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="FilePath" narrative="The path of the file" stage="FileMetadata.FilePath" /><input type="text" name="modelId" narrative="Model identifier" stage="modelId" /></inputs><onsuccess>93220a23-4ecc-4856-8f17-6e81a0d74b28</onsuccess></stage><stage stageid="aeb5207c-e78b-4eb6-9060-41f55b58f964" name="Local" type="Block"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><loginhibit /><display x="-420" y="135" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="37ffcac2-4c44-4802-be03-c77a1703cc39" name="Output" type="Block"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><loginhibit /><display x="-420" y="30" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="b4480548-e62d-481b-b2fd-66960db41eac" name="Input" type="Block"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><loginhibit /><display x="-420" y="-75" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="99CCFF" /></stage><stage stageid="f29c8712-a762-4373-9c64-8a197f2b54df" name="End" type="End"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><loginhibit /><display x="15" y="135" /><outputs><output type="flag" name="Success" narrative="A flag indicating the success or failure of the action." stage="Success" /><output type="text" name="Response Message" narrative="If an error is encountered, further details may be available here." stage="Response Message" /><output type="text" name="Result ID" narrative="Result ID used to query the status of the asynchronous operation and get the results." stage="Response Collection.apim-request-id" /></outputs></stage><stage stageid="93220a23-4ecc-4856-8f17-6e81a0d74b28" name="HTTP Request" type="Action"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" w="90" h="30" /><inputs><input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="[Base URL] &amp; &quot;/formrecognizer/documentModels/&quot; &amp; [modelId] &amp; &quot;:analyze&quot;" /><input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" /><input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" /><input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" /><input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" /><input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="[Access Token]" /><input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" narrative="OPTIONAL: If you need bearer token authorization set this to true." expr="" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you have a bearer token and need to use authorization" expr="" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="" /><input type="collection" name="FileMetadata" friendlyname="FileMetadata" narrative="Files to be sent in the multipart HTTP  request" expr="[FileMetadata]" /><input type="collection" name="FieldMetadata" friendlyname="FieldMetadata" narrative="Text data to be sent in the multipart HTTP  request" expr="" /></inputs><outputs><output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="Headers as Json" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="Status Code" /></outputs><onsuccess>af5ddf64-d785-429a-9bc9-94601ff117a0</onsuccess><resource object="Utility - HTTP" action="HTTP Request Multipart" /></stage><stage stageid="1818e2d5-15f6-4c1e-993f-da8b1b516def" name="Result" type="Data"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><display x="-345" y="195" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="27837a12-cddb-48b7-a5a4-f8290760dfe6" name="Headers as Json" type="Data"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><display x="-225" y="165" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="21845c8b-0981-42eb-a5df-1efb2dc7e8ed" name="Status Code" type="Data"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><display x="-345" y="165" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="af5ddf64-d785-429a-9bc9-94601ff117a0" name="202?" type="Decision"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><loginhibit /><display x="15" y="15" /><decision expression="[Status Code] = 202" /><ontrue>07c6ddba-1658-4fb2-9b7e-d84041120c8a</ontrue><onfalse>c7f579de-d797-4289-ac78-a0bafd582cf3</onfalse></stage><stage stageid="c7f579de-d797-4289-ac78-a0bafd582cf3" name="Set Failed" type="MultipleCalculation"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><loginhibit /><display x="-75" y="15" /><onsuccess>edaee5ef-b7a4-4c24-a2eb-1e31d5d518d3</onsuccess><steps><calculation expression="False" stage="Success" /><calculation expression="&quot;Status Code: &quot; &amp; [Status Code] &amp; &quot; Result: &quot; &amp; [Result]" stage="Response Message" /></steps></stage><stage stageid="edaee5ef-b7a4-4c24-a2eb-1e31d5d518d3" name="Anchor5" type="Anchor"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><loginhibit /><display x="-75" y="135" w="10" h="10" /><onsuccess>f29c8712-a762-4373-9c64-8a197f2b54df</onsuccess></stage><stage stageid="07c6ddba-1658-4fb2-9b7e-d84041120c8a" name="Utility - JSON::JSON to Collection (skipping JArray)" type="Action"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="90" h="30" /><inputs><input type="text" name="json" friendlyname="json" expr="[Headers as Json]" /></inputs><outputs><output type="collection" name="Result" friendlyname="Result" stage="Response Collection" /></outputs><onsuccess>f29c8712-a762-4373-9c64-8a197f2b54df</onsuccess><resource object="Utility - JSON" action="JSON to Collection (skipping JArray)" /></stage><stage stageid="3605e5c7-2722-4ead-b8e4-5d7ff08b432f" name="FileMetadata" type="Collection"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><loginhibit /><narrative>Files to be sent in the multipart HTTP  request</narrative><display x="-345" y="-30" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><singlerow /><field name="FileName" type="text" description="Optional. Used to populate the filename header for this file's section in the multi-part form body. If a value is not specified, the filename is used from the provided filepath" /><field name="FieldName" type="text" description="Optional. Used to populate the name header for this file's section in the multi-part form body. If a value is not specified, the filename is set to 'file'" /><field name="ContentType" type="text" description="Optional. Used to populate the Content-Type header for this file's section in the multi-part form body. If a value is not specified, the mimetype of the document is used." /><field name="FilePath" type="text" description="The path of the file" /></collectioninfo><initialvalue><singlerow /><row><field name="FileName" type="text" value="" /><field name="FieldName" type="text" value="urlSource" /><field name="ContentType" type="text" value="" /><field name="FilePath" type="text" value="" /></row></initialvalue></stage><stage stageid="7846290a-49fa-412a-b86a-5d519733cc5b" name="modelId" type="Data"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><display x="-225" y="-30" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c7afaf36-63c6-4082-8fdf-04b08528000b" name="Delete Custom Model" type="SubSheetInfo"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><narrative>Mark model for deletion. Model artifacts will be permanently removed within a predetermined period.</narrative><display x="-285" y="-135" w="150" h="90" /></stage><stage stageid="b970ada4-867d-4229-8538-d5a0f5c01e3b" name="Start" type="Start"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="modelId" narrative="Model identifier" stage="modelId" /></inputs><onsuccess>0011c007-8127-4ef7-8e1a-d9c79304009e</onsuccess></stage><stage stageid="9938d70e-c1e6-4847-be3d-303251f3a397" name="Local" type="Block"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><loginhibit /><display x="-420" y="135" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="f947eb21-49ae-438f-a539-882ec3b76c29" name="Output" type="Block"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><loginhibit /><display x="-420" y="30" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="2462a8c1-3d3c-4f4c-b07d-8348bdfe3e4a" name="Input" type="Block"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><loginhibit /><display x="-420" y="-75" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="99CCFF" /></stage><stage stageid="c92f00cd-2427-40e4-9cf8-16bb7813982c" name="End" type="End"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><loginhibit /><display x="15" y="75" /><outputs><output type="flag" name="Success" narrative="A flag indicating the success or failure of the action." stage="Success" /><output type="text" name="Response Message" narrative="If an error is encountered, further details may be available here." stage="Response Message" /></outputs></stage><stage stageid="0011c007-8127-4ef7-8e1a-d9c79304009e" name="HTTP Request" type="Action"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" w="90" h="30" /><inputs><input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="[Base URL] &amp; &quot;/formrecognizer/documentModels/&quot; &amp; [modelId] &amp; &quot;api-version=2022-08-31&quot;" /><input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" /><input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" /><input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" /><input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" /><input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="[Access Token]" /><input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the 'Authorization' header for HTTP Basic." expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" expr="" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you 'Use Bearer Token' is set to True, this must be set to the value of the actual Bearer Token." expr="" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="" /><input type="text" name="Body" friendlyname="Body" narrative="The body text of the HTTP request" expr="" /><input type="text" name="Content Type" friendlyname="Content Type" narrative="The content type of the HTTP request." expr="" /><input type="text" name="Method" friendlyname="Method" narrative="The method of the HTTP request." expr="&quot;DELETE&quot;" /><input type="flag" name="File URL" friendlyname="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" /></inputs><outputs><output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="Headers as Json" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="Status Code" /></outputs><onsuccess>e8fa023a-f68d-41ce-89bb-6a389bb45ab8</onsuccess><resource object="Utility - HTTP" action="HTTP Request" /></stage><stage stageid="9c4c9031-3259-4196-b526-34bf1e348ca8" name="Result" type="Data"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><display x="-345" y="195" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="86ab0805-23c5-406f-b151-8f7933e68bf0" name="Headers as Json" type="Data"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><display x="-225" y="165" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="66fd3b98-8b2e-4c03-899c-dc86d680c426" name="Status Code" type="Data"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><display x="-345" y="165" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e8fa023a-f68d-41ce-89bb-6a389bb45ab8" name="204?" type="Decision"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><loginhibit /><display x="15" y="15" /><decision expression="[Status Code] = 204" /><ontrue>c92f00cd-2427-40e4-9cf8-16bb7813982c</ontrue><onfalse>8c0594d7-9992-4764-aa9c-fceeac0351a9</onfalse></stage><stage stageid="8c0594d7-9992-4764-aa9c-fceeac0351a9" name="Set Failed" type="MultipleCalculation"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><loginhibit /><display x="-75" y="15" /><onsuccess>3502d6dc-6783-42f2-884b-df7f32cbe52f</onsuccess><steps><calculation expression="False" stage="Success" /><calculation expression="&quot;Status Code: &quot; &amp; [Status Code] &amp; &quot; Result: &quot; &amp; [Result]" stage="Response Message" /></steps></stage><stage stageid="3502d6dc-6783-42f2-884b-df7f32cbe52f" name="Anchor5" type="Anchor"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><loginhibit /><display x="-75" y="75" w="10" h="10" /><onsuccess>c92f00cd-2427-40e4-9cf8-16bb7813982c</onsuccess></stage><stage stageid="d9a1d9ca-246b-4eae-b5cd-5643b56dd487" name="modelId" type="Data"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><display x="-345" y="-30" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="107893a1-df5d-41dd-a86b-50bd45aa4ccc" name="Success" type="Data"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><display x="-345" y="60" w="120" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="95882976-1b9e-45e4-b8dc-85c0963003bb" name="Response Message" type="Data"><subsheetid>a015cab0-8db6-416c-9c72-3a9132519c41</subsheetid><display x="-225" y="60" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1cb848b8-a6c3-4543-adda-48a05632c64f" name="Response Collection" type="Collection"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><display x="-345" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="eb1dc4bd-c4ae-474e-bf8b-949d60a00211" name="Success" type="Data"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><display x="-345" y="60" w="120" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="ec97ab73-3461-41e0-838d-2bf591401b72" name="Response Message" type="Data"><subsheetid>4669712d-d9da-433b-838c-718f50fcdb24</subsheetid><display x="-225" y="60" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c27f27d3-2249-4d9c-97a1-773dde761b71" name="Response Collection" type="Collection"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><display x="-345" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="bf83750b-5673-4112-9a07-aa579f89373c" name="Success" type="Data"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><display x="-345" y="60" w="120" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="9d56170a-4491-45c3-806e-e60cc67375ff" name="Response Message" type="Data"><subsheetid>cf3d4c84-16ac-4774-bf05-1e9ad404b14d</subsheetid><display x="-225" y="60" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6b527245-c043-4a98-9be8-2fbd06965788" name="Success" type="Data"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><display x="-345" y="60" w="120" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="3a36d62d-f7aa-4f59-81ee-4694a6e7a575" name="Response Message" type="Data"><subsheetid>d7947423-0488-44fa-bcb3-12a7113b6399</subsheetid><display x="-225" y="60" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="941f848c-c848-4316-b8a1-3601d9d98eb3" name="Get Analyze Layout Result" type="SubSheetInfo"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><narrative>Track the progress and obtain the result of the analyze layout operation</narrative><display x="-300" y="-150" w="150" h="90" /></stage><stage stageid="9953b1de-a317-436c-b3fa-9806ffc6c396" name="Start" type="Start"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="resultId" narrative="Analyze operation result identifier." stage="resultId" /></inputs><onsuccess>f058aaf3-b7a3-46e3-af1b-000f379c0340</onsuccess></stage><stage stageid="e889b69f-3bb0-4134-a395-efa327bb9ac6" name="Local" type="Block"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-420" y="165" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="1200e845-3b8e-458d-b98e-e361e71bc4a7" name="Output" type="Block"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-420" y="0" w="270" h="150" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="dcf931ff-53cd-4a0a-8b88-ed8945ee64a4" name="Input" type="Block"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-420" y="-75" w="270" h="60" /><font family="Segoe UI" size="10" style="Regular" color="99CCFF" /></stage><stage stageid="90a40db2-a5a7-4191-b49f-8323ade61ba6" name="End" type="End"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="15" y="630" /><outputs><output type="flag" name="Success" narrative="A flag indicating the success or failure of the action." stage="Success" /><output type="text" name="Response Message" narrative="If an error is encountered, further details may be available here." stage="Response Message" /><output type="text" name="Operation status" narrative="Operation status" stage="Operation status" /><output type="collection" name="pages" narrative=" " stage="pages" /><output type="collection" name="paragraphs" narrative=" " stage="paragraphs" /><output type="collection" name="styles" narrative=" " stage="styles" /><output type="collection" name="tables" narrative=" " stage="tables" /><output type="text" name="content" narrative="The text content" stage="content" /></outputs></stage><stage stageid="f058aaf3-b7a3-46e3-af1b-000f379c0340" name="HTTP Request" type="Action"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" w="90" h="30" /><inputs><input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="[Base URL] &amp; &quot;/formrecognizer/documentModels/prebuilt-layout/analyzeResults/&quot; &amp; [resultId] &amp; &quot;?api-version=2022-08-31&quot;&#xA;" /><input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" /><input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" /><input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" /><input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" /><input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="[Access Token]" /><input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the 'Authorization' header for HTTP Basic." expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" expr="" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you 'Use Bearer Token' is set to True, this must be set to the value of the actual Bearer Token." expr="" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="" /><input type="text" name="Body" friendlyname="Body" narrative="The body text of the HTTP request" expr="" /><input type="text" name="Content Type" friendlyname="Content Type" narrative="The content type of the HTTP request." expr="" /><input type="text" name="Method" friendlyname="Method" narrative="The method of the HTTP request." expr="&quot;GET&quot;" /><input type="flag" name="File URL" friendlyname="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" /></inputs><outputs><output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="Headers as Json" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="Status Code" /></outputs><onsuccess>d85bd26e-d0d8-43ff-a306-078af931617d</onsuccess><resource object="Utility - HTTP" action="HTTP Request" /></stage><stage stageid="c3a1c840-d02a-4d14-9688-07b009776a29" name="Result" type="Data"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><display x="-345" y="225" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d7d7ded1-f6d0-4b04-8980-49c36420af0f" name="Headers as Json" type="Data"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><display x="-225" y="195" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="deb732fd-6920-46d7-aa0c-d58d1fe7b5b6" name="Status Code" type="Data"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><display x="-345" y="195" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d85bd26e-d0d8-43ff-a306-078af931617d" name="200?" type="Decision"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="15" y="15" /><decision expression="[Status Code] = 200" /><ontrue>09433196-4c97-465d-ad1e-1684b1af6ab1</ontrue><onfalse>ae9ba413-60da-47d6-ae45-8281179c8d9c</onfalse></stage><stage stageid="ae9ba413-60da-47d6-ae45-8281179c8d9c" name="Set Failed" type="MultipleCalculation"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-75" y="15" /><onsuccess>21822ea8-0a76-4ee0-9467-2a1e7f0ef9ff</onsuccess><steps><calculation expression="False" stage="Success" /><calculation expression="&quot;Status Code: &quot; &amp; [Status Code] &amp; &quot; Result: &quot; &amp; [Result]" stage="Response Message" /></steps></stage><stage stageid="09433196-4c97-465d-ad1e-1684b1af6ab1" name="Utility - JSON::JSON to Collection (skipping JArray)" type="Action"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="90" h="30" /><inputs><input type="text" name="json" friendlyname="json" expr="[Result]" /></inputs><outputs><output type="collection" name="Result" friendlyname="Result" stage="Response Collection" /></outputs><onsuccess>807926de-36df-4ff0-91a6-8a2754bb66a8</onsuccess><resource object="Utility - JSON" action="JSON to Collection (skipping JArray)" /></stage><stage stageid="af7e548b-832e-438e-af30-4047d6923bce" name="resultId" type="Data"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><narrative>Analyze operation result identifier.</narrative><display x="-345" y="-45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="46a1c5be-50fe-4a7d-a85a-79ad189b5057" name="Response Collection" type="Collection"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><display x="-225" y="225" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="f5b3bb70-cb31-4ae0-9645-c3dc837cebbb" name="Success" type="Data"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><display x="-345" y="30" w="120" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="c4881bfa-c1ea-4c3e-8d89-b09c0766267b" name="Response Message" type="Data"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><display x="-225" y="30" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="07ab4a20-8cb3-4cd6-97ab-6a1c29cf2389" name="Set pages" type="Calculation"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit onsuccess="true" /><display x="15" y="180" w="90" h="30" /><onsuccess>ccf77d62-6b9c-4bd6-8f0d-7c7484b1ea1d</onsuccess><calculation expression="[Response Collection.analyzeResult.pages]&#xA;" stage="pages" /></stage><stage stageid="7c4f194e-0bb1-4ab1-a94d-936dcef1af1f" name="styles" type="Collection"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-345" y="120" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="2da1091f-b051-42d7-a7cb-dfb1b3d77057" name="paragraphs" type="Collection"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-225" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="f9ccdcac-d8a3-4fdb-ab50-f16087a1da07" name="pages" type="Block"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-45" y="150" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e797abc7-408c-4b1f-84fd-96c77924e742" name="Recover1" type="Recover"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="105" y="180" /><onsuccess>6024fb5e-1d91-4617-8b9c-2c8c901cadc0</onsuccess></stage><stage stageid="6024fb5e-1d91-4617-8b9c-2c8c901cadc0" name="Resume1" type="Resume"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="195" y="180" /><onsuccess>74e92237-8dde-4b0c-ae46-eba7563b6249</onsuccess></stage><stage stageid="bd657225-f832-4ed2-ac41-62c06d866648" name="Set tables" type="Calculation"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit onsuccess="true" /><display x="15" y="270" w="90" h="30" /><onsuccess>dd3c3c3a-7481-4d3e-8b94-f136e916557f</onsuccess><calculation expression="[Response Collection.analyzeResult.tables]" stage="tables" /></stage><stage stageid="d40da606-30d1-45ea-ba06-116452005b5c" name="tables" type="Block"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-45" y="240" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="6a867d8c-485c-4139-8791-1f6065a1ccd7" name="Recover1" type="Recover"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="105" y="270" /><onsuccess>07631588-3bda-4b7c-9c0d-63bcb7826015</onsuccess></stage><stage stageid="07631588-3bda-4b7c-9c0d-63bcb7826015" name="Resume1" type="Resume"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="195" y="270" /><onsuccess>a68b16af-d9a2-44e1-b5bb-532184ebc15b</onsuccess></stage><stage stageid="b309cb03-3bc5-42d3-a8c9-b2c4695b0232" name="Set paragraphs" type="Calculation"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit onsuccess="true" /><display x="15" y="360" w="90" h="30" /><onsuccess>e911ab9e-94ee-48d3-ae24-64c4e598065f</onsuccess><calculation expression="[Response Collection.analyzeResult.paragraphs]" stage="paragraphs" /></stage><stage stageid="915995a8-342e-448a-a1e1-39906122918d" name="paragraphs" type="Block"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-45" y="330" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="d7c04ce7-73e3-4b89-ada2-036c2d28e14d" name="Recover1" type="Recover"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="105" y="360" /><onsuccess>c809a95f-8943-4005-910e-58066cd0a19e</onsuccess></stage><stage stageid="c809a95f-8943-4005-910e-58066cd0a19e" name="Resume1" type="Resume"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="195" y="360" /><onsuccess>e604271c-eeb4-4f18-88c4-7fb358dcbe0b</onsuccess></stage><stage stageid="74e92237-8dde-4b0c-ae46-eba7563b6249" name="Anchor1" type="Anchor"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="195" y="225" w="10" h="10" /><onsuccess>ccf77d62-6b9c-4bd6-8f0d-7c7484b1ea1d</onsuccess></stage><stage stageid="ccf77d62-6b9c-4bd6-8f0d-7c7484b1ea1d" name="Anchor2" type="Anchor"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="15" y="225" w="10" h="10" /><onsuccess>bd657225-f832-4ed2-ac41-62c06d866648</onsuccess></stage><stage stageid="a68b16af-d9a2-44e1-b5bb-532184ebc15b" name="Anchor1" type="Anchor"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="195" y="315" w="10" h="10" /><onsuccess>dd3c3c3a-7481-4d3e-8b94-f136e916557f</onsuccess></stage><stage stageid="dd3c3c3a-7481-4d3e-8b94-f136e916557f" name="Anchor2" type="Anchor"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="15" y="315" w="10" h="10" /><onsuccess>b309cb03-3bc5-42d3-a8c9-b2c4695b0232</onsuccess></stage><stage stageid="e604271c-eeb4-4f18-88c4-7fb358dcbe0b" name="Anchor3" type="Anchor"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="195" y="405" w="10" h="10" /><onsuccess>e911ab9e-94ee-48d3-ae24-64c4e598065f</onsuccess></stage><stage stageid="21822ea8-0a76-4ee0-9467-2a1e7f0ef9ff" name="Anchor6" type="Anchor"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-75" y="585" w="10" h="10" /><onsuccess>cc1046df-d7a1-4cd2-a219-6a155b9d1be8</onsuccess></stage><stage stageid="f0c1485b-efd4-4ad5-aebb-f4baf7d051a0" name="Get Analyze Custom Model Result" type="SubSheetInfo"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><narrative>Obtain current status and the result of the analyze custom model operation.</narrative><display x="-270" y="-150" w="150" h="90" /></stage><stage stageid="f27ca8bc-8d5d-41d1-998c-b407fec87c0f" name="Get Analyze Receipt Result" type="SubSheetInfo"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><narrative>Track the progress and obtain the result of the analyze receipt operation.</narrative><display x="-270" y="-135" w="150" h="90" /></stage><stage stageid="72438b06-e1b7-46d1-85e2-c4679e9c2943" name="Operation status" type="Data"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-345" y="60" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a8e74201-155d-4454-8984-e9ce1d512d7e" name="pages" type="Collection"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-225" y="60" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="043d4899-e475-41a2-91e1-315f276bb083" name="tables" type="Collection"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-345" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="cc1046df-d7a1-4cd2-a219-6a155b9d1be8" name="Anchor7" type="Anchor"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="15" y="585" w="10" h="10" /><onsuccess>90a40db2-a5a7-4191-b49f-8323ade61ba6</onsuccess></stage><stage stageid="807926de-36df-4ff0-91a6-8a2754bb66a8" name="Set Operation Status" type="Calculation"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="15" y="120" w="90" h="30" /><onsuccess>07ab4a20-8cb3-4cd6-97ab-6a1c29cf2389</onsuccess><calculation expression="[Response Collection.status]" stage="Operation status" /></stage><stage stageid="229825db-8bff-4321-ae25-36ccefc5f8c3" name="Set styles" type="Calculation"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit onsuccess="true" /><display x="15" y="450" w="90" h="30" /><onsuccess>ed12dea6-0caa-44d1-9e98-7a25dd66b2e3</onsuccess><calculation expression="[Response Collection.analyzeResult.styles]" stage="styles" /></stage><stage stageid="c6be8143-ecd5-4e50-8e99-57db17d266b4" name="styles" type="Block"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-45" y="420" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="fc530da5-da1c-47b4-a34c-728a08741b9b" name="Recover1" type="Recover"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="105" y="450" /><onsuccess>242cc0af-b1d7-4a8f-b310-1cab0580d5cf</onsuccess></stage><stage stageid="242cc0af-b1d7-4a8f-b310-1cab0580d5cf" name="Resume1" type="Resume"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="195" y="450" /><onsuccess>86a20d8e-439e-47e4-9c0d-a2b1fa56929e</onsuccess></stage><stage stageid="7a698768-fc78-49b1-843f-06ca9e6be273" name="Anchor3" type="Anchor"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="195" y="585" w="10" h="10" /><onsuccess>cc1046df-d7a1-4cd2-a219-6a155b9d1be8</onsuccess></stage><stage stageid="e911ab9e-94ee-48d3-ae24-64c4e598065f" name="Anchor8" type="Anchor"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="15" y="405" w="10" h="10" /><onsuccess>229825db-8bff-4321-ae25-36ccefc5f8c3</onsuccess></stage><stage stageid="86ceb03d-42db-41d1-ae5a-601a2fd7ad69" name="Start" type="Start"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="resultId" narrative="Analyze operation result identifier." stage="resultId" /><input type="text" name="modelId" narrative="Model identifier." stage="modelId" /></inputs><onsuccess>ee7e3143-75fb-488e-864f-ac9390c91e7a</onsuccess></stage><stage stageid="32f740d3-d1e6-4f9f-853c-4490c35459f2" name="Local" type="Block"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-420" y="195" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="febf1866-3c32-4c23-b8fc-fcdeff4c58ba" name="Output" type="Block"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-420" y="0" w="270" h="180" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="d5a98030-bcc3-46c1-9380-86ae940446fe" name="Input" type="Block"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-420" y="-75" w="270" h="60" /><font family="Segoe UI" size="10" style="Regular" color="99CCFF" /></stage><stage stageid="b1381566-5877-4466-87d3-53c701fd56c2" name="End" type="End"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="15" y="720" /><outputs><output type="flag" name="Success" narrative="A flag indicating the success or failure of the action." stage="Success" /><output type="text" name="Response Message" narrative="If an error is encountered, further details may be available here." stage="Response Message" /><output type="text" name="Operation status" narrative="Operation status" stage="Operation status" /><output type="collection" name="documents" narrative=" " stage="documents" /><output type="collection" name="paragraphs" narrative=" " stage="paragraphs" /><output type="collection" name="pages" narrative=" " stage="pages" /><output type="collection" name="tables" narrative=" " stage="tables" /><output type="collection" name="styles" stage="styles" /><output type="text" name="content" narrative="The text content" stage="content" /></outputs></stage><stage stageid="ee7e3143-75fb-488e-864f-ac9390c91e7a" name="HTTP Request" type="Action"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" w="90" h="30" /><inputs><input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="[Base URL] &amp; &quot;/custom/models/&quot; &amp; [modelId] &amp; &quot;/analyzeResults/&quot; &amp; [resultId]&#xA;" /><input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" /><input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" /><input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" /><input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" /><input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="[Access Token]" /><input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the 'Authorization' header for HTTP Basic." expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" expr="" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you 'Use Bearer Token' is set to True, this must be set to the value of the actual Bearer Token." expr="" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="" /><input type="text" name="Body" friendlyname="Body" narrative="The body text of the HTTP request" expr="" /><input type="text" name="Content Type" friendlyname="Content Type" narrative="The content type of the HTTP request." expr="" /><input type="text" name="Method" friendlyname="Method" narrative="The method of the HTTP request." expr="&quot;GET&quot;" /><input type="flag" name="File URL" friendlyname="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" /></inputs><outputs><output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="Headers as Json" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="Status Code" /></outputs><onsuccess>4739731c-ecc4-4e7c-a0f2-b6a330f33164</onsuccess><resource object="Utility - HTTP" action="HTTP Request" /></stage><stage stageid="919a9f12-90dd-46c9-bc7d-f2fd70fce9f1" name="Result" type="Data"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><display x="-345" y="255" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0564d480-17ba-454b-a828-90906b53b311" name="Headers as Json" type="Data"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><display x="-225" y="225" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d3280f1a-bcb3-4fb5-b686-90e1ab44b3e7" name="Status Code" type="Data"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><display x="-345" y="225" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4739731c-ecc4-4e7c-a0f2-b6a330f33164" name="200?" type="Decision"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="15" y="15" /><decision expression="[Status Code] = 200" /><ontrue>a74ef4d2-0eff-4bd8-bef4-7cd045f8685b</ontrue><onfalse>633a50d7-228f-45b5-9153-50e5919e9c33</onfalse></stage><stage stageid="633a50d7-228f-45b5-9153-50e5919e9c33" name="Set Failed" type="MultipleCalculation"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-75" y="15" /><onsuccess>29da46a1-c122-462f-aae7-6b3fb8c4285a</onsuccess><steps><calculation expression="False" stage="Success" /><calculation expression="&quot;Status Code: &quot; &amp; [Status Code] &amp; &quot; Result: &quot; &amp; [Result]" stage="Response Message" /></steps></stage><stage stageid="a74ef4d2-0eff-4bd8-bef4-7cd045f8685b" name="Utility - JSON::JSON to Collection (skipping JArray)" type="Action"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="90" h="30" /><inputs><input type="text" name="json" friendlyname="json" expr="[Result]" /></inputs><outputs><output type="collection" name="Result" friendlyname="Result" stage="Response Collection" /></outputs><onsuccess>5ed3e5fa-fe26-4500-9474-0d32cc156843</onsuccess><resource object="Utility - JSON" action="JSON to Collection (skipping JArray)" /></stage><stage stageid="20992603-ae45-4bbc-9514-7c323bd6bff5" name="resultId" type="Data"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><narrative>Analyze operation result identifier.</narrative><display x="-345" y="-45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f36bf135-908c-4682-aa5e-1aecb43a0ac9" name="Response Collection" type="Collection"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><display x="-225" y="255" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="a775f6c1-ab71-4333-9f7c-e9d00d026c4a" name="Success" type="Data"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><display x="-345" y="30" w="120" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="40ebc6cc-4328-4217-a890-ad34593542d8" name="Response Message" type="Data"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><display x="-225" y="30" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2246fa40-c6c0-4b76-bfb3-97f1443cbadc" name="Set documents" type="Calculation"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="180" w="90" h="30" /><onsuccess>0bf3bc8d-7667-40b3-8b47-4b1334b4a4bb</onsuccess><calculation expression="[Response Collection.analyzeResult.documents]&#xA;" stage="documents" /></stage><stage stageid="29c52f64-9c1d-43b2-b7b9-2277d9c9d42f" name="tables" type="Collection"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-345" y="120" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="33fa9c20-8f47-427d-9e9b-97cdd049ca09" name="pages" type="Collection"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-225" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="e29ded01-6644-42c8-aade-42a2f83693f4" name="documents" type="Block"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-45" y="150" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="31693d55-3f5a-4b07-ae8e-ffb51abb274b" name="Recover1" type="Recover"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="105" y="180" /><onsuccess>0e14910b-baa5-4b1b-bc9a-671a11ef1f8c</onsuccess></stage><stage stageid="0e14910b-baa5-4b1b-bc9a-671a11ef1f8c" name="Resume1" type="Resume"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="195" y="180" /><onsuccess>c886d958-9ba9-4fee-9194-6bdf5da51323</onsuccess></stage><stage stageid="605d01c8-ebb7-417b-81b4-49086991fd95" name="Set paragraphs" type="Calculation"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="270" w="90" h="30" /><onsuccess>d46274a9-401f-47df-a649-6dae2a180cac</onsuccess><calculation expression="[Response Collection.analyzeResult.paragraphs]" stage="paragraphs" /></stage><stage stageid="fa81b827-f43e-43ec-a075-4db92c5b6be0" name="paragraphs" type="Block"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-45" y="240" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="a58e1945-93d0-43a4-9edb-c7be59f17265" name="Recover1" type="Recover"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="105" y="270" /><onsuccess>52702acd-a925-40dc-bb63-3631b386f7e3</onsuccess></stage><stage stageid="52702acd-a925-40dc-bb63-3631b386f7e3" name="Resume1" type="Resume"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="195" y="270" /><onsuccess>66979ad4-f1a4-41dc-8ca7-fc6a2bfe855f</onsuccess></stage><stage stageid="9df9eecd-4dab-4435-a0b3-06a40127b908" name="Set pages" type="Calculation"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="360" w="90" h="30" /><onsuccess>7be21d72-138c-41e0-b0fb-c56113b54007</onsuccess><calculation expression="[Response Collection.analyzeResult.pages]" stage="pages" /></stage><stage stageid="cf295d32-5677-4bf1-b278-691003f65e3d" name="pages" type="Block"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-45" y="330" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="1f08bcaa-d263-4aa0-b2eb-aef43340e628" name="Recover1" type="Recover"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="105" y="360" /><onsuccess>9cf279a6-6d7b-45ee-a285-e3fdeb46d64d</onsuccess></stage><stage stageid="9cf279a6-6d7b-45ee-a285-e3fdeb46d64d" name="Resume1" type="Resume"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="195" y="360" /><onsuccess>fbe9ee7c-6743-43a5-b907-da2d207bcb85</onsuccess></stage><stage stageid="c886d958-9ba9-4fee-9194-6bdf5da51323" name="Anchor1" type="Anchor"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="195" y="225" w="10" h="10" /><onsuccess>0bf3bc8d-7667-40b3-8b47-4b1334b4a4bb</onsuccess></stage><stage stageid="0bf3bc8d-7667-40b3-8b47-4b1334b4a4bb" name="Anchor2" type="Anchor"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="15" y="225" w="10" h="10" /><onsuccess>605d01c8-ebb7-417b-81b4-49086991fd95</onsuccess></stage><stage stageid="66979ad4-f1a4-41dc-8ca7-fc6a2bfe855f" name="Anchor1" type="Anchor"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="195" y="315" w="10" h="10" /><onsuccess>d46274a9-401f-47df-a649-6dae2a180cac</onsuccess></stage><stage stageid="d46274a9-401f-47df-a649-6dae2a180cac" name="Anchor2" type="Anchor"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="15" y="315" w="10" h="10" /><onsuccess>9df9eecd-4dab-4435-a0b3-06a40127b908</onsuccess></stage><stage stageid="fbe9ee7c-6743-43a5-b907-da2d207bcb85" name="Anchor3" type="Anchor"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="195" y="405" w="10" h="10" /><onsuccess>7be21d72-138c-41e0-b0fb-c56113b54007</onsuccess></stage><stage stageid="29da46a1-c122-462f-aae7-6b3fb8c4285a" name="Anchor6" type="Anchor"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-75" y="675" w="10" h="10" /><onsuccess>dc06f467-9129-4adf-836c-6330e2ceb0a3</onsuccess></stage><stage stageid="c4a5f693-c132-4823-bf59-2ee81c7848e5" name="Operation status" type="Data"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-345" y="60" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e08561df-215c-48bf-8e87-17eb9ef49515" name="documents" type="Collection"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-225" y="60" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="44f385d4-5429-499b-b5de-b92f43cb2449" name="paragraphs" type="Collection"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-345" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="dc06f467-9129-4adf-836c-6330e2ceb0a3" name="Anchor7" type="Anchor"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="15" y="675" w="10" h="10" /><onsuccess>b1381566-5877-4466-87d3-53c701fd56c2</onsuccess></stage><stage stageid="5ed3e5fa-fe26-4500-9474-0d32cc156843" name="Set Operation Status" type="Calculation"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="15" y="120" w="90" h="30" /><onsuccess>2246fa40-c6c0-4b76-bfb3-97f1443cbadc</onsuccess><calculation expression="[Response Collection.status]" stage="Operation status" /></stage><stage stageid="38114ea3-d807-480f-a653-59eb96ee467c" name="Set tables" type="Calculation"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="450" w="90" h="30" /><onsuccess>6c8f2c8c-087b-42bf-a8b1-9d5db71e4ef2</onsuccess><calculation expression="[Response Collection.analyzeResult.tables]" stage="tables" /></stage><stage stageid="e5b3cb30-63c2-4529-b528-d395c44b108c" name="tables" type="Block"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-45" y="420" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="7308152b-3cb0-4d87-88fb-a40a47a14a69" name="Recover1" type="Recover"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="105" y="450" /><onsuccess>7f310c5c-7ef2-49fe-aeaf-6fad93023b2c</onsuccess></stage><stage stageid="7f310c5c-7ef2-49fe-aeaf-6fad93023b2c" name="Resume1" type="Resume"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="195" y="450" /><onsuccess>1a319473-29b4-484a-b452-da55e5274313</onsuccess></stage><stage stageid="972821d6-7769-4a57-8ccd-cb72d8e380b0" name="Anchor3" type="Anchor"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="195" y="675" w="10" h="10" /><onsuccess>dc06f467-9129-4adf-836c-6330e2ceb0a3</onsuccess></stage><stage stageid="7be21d72-138c-41e0-b0fb-c56113b54007" name="Anchor8" type="Anchor"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="15" y="405" w="10" h="10" /><onsuccess>38114ea3-d807-480f-a653-59eb96ee467c</onsuccess></stage><stage stageid="08caddbb-5274-4dd0-8832-362f66331a6a" name="modelId" type="Data"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><narrative>Model identifier.</narrative><display x="-225" y="-45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e16d605b-0903-4cc8-ae88-3460527cf39d" name="Start" type="Start"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="resultId" narrative="Analyze operation result identifier." stage="resultId" /></inputs><onsuccess>582dfc5a-e81e-4edc-b763-b700cd6384f4</onsuccess></stage><stage stageid="721287c9-9077-4441-9d57-a14697741f8b" name="Local" type="Block"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-420" y="165" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="9f8acdcb-0dc4-4443-b5a4-97faf8af1081" name="Output" type="Block"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-420" y="0" w="270" h="150" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="f7e471fa-49bb-458b-845a-1bd4fa4a1077" name="Input" type="Block"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-420" y="-75" w="270" h="60" /><font family="Segoe UI" size="10" style="Regular" color="99CCFF" /></stage><stage stageid="3638e640-eb0f-4204-b6e4-572b8dd6c732" name="End" type="End"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="15" y="630" /><outputs><output type="flag" name="Success" narrative="A flag indicating the success or failure of the action." stage="Success" /><output type="text" name="Response Message" narrative="If an error is encountered, further details may be available here." stage="Response Message" /><output type="text" name="Operation status" narrative="Operation status" stage="Operation status" /><output type="collection" name="pages" narrative=" " stage="pages" /><output type="collection" name="paragraphs" narrative=" " stage="paragraphs" /><output type="collection" name="styles" narrative=" " stage="styles" /><output type="collection" name="documents" narrative=" " stage="documents" /><output type="text" name="content" narrative="The text content" stage="content" /></outputs></stage><stage stageid="582dfc5a-e81e-4edc-b763-b700cd6384f4" name="HTTP Request" type="Action"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" w="90" h="30" /><inputs><input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="[Base URL] &amp; &quot;/formrecognizer/documentModels/prebuilt-receipt/analyzeResults/&quot; &amp; [resultId] &amp; &quot;?api-version=2022-08-31&quot;&#xA;&#xA;" /><input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" /><input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" /><input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" /><input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" /><input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="[Access Token]" /><input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the 'Authorization' header for HTTP Basic." expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" expr="" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you 'Use Bearer Token' is set to True, this must be set to the value of the actual Bearer Token." expr="" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="" /><input type="text" name="Body" friendlyname="Body" narrative="The body text of the HTTP request" expr="" /><input type="text" name="Content Type" friendlyname="Content Type" narrative="The content type of the HTTP request." expr="" /><input type="text" name="Method" friendlyname="Method" narrative="The method of the HTTP request." expr="&quot;GET&quot;" /><input type="flag" name="File URL" friendlyname="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" /></inputs><outputs><output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="Headers as Json" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="Status Code" /></outputs><onsuccess>bd77282d-15b3-49ef-a107-19704a2819cf</onsuccess><resource object="Utility - HTTP" action="HTTP Request" /></stage><stage stageid="becf6f56-4b06-4aa4-8216-7a0a7712b469" name="Result" type="Data"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><display x="-345" y="225" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f2a227e7-e6c6-4c22-8435-5eb1c6ddf8e1" name="Headers as Json" type="Data"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><display x="-225" y="195" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e0e00171-0a66-40a0-99b3-13c00e3cfcdd" name="Status Code" type="Data"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><display x="-345" y="195" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bd77282d-15b3-49ef-a107-19704a2819cf" name="200?" type="Decision"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="15" y="15" /><decision expression="[Status Code] = 200" /><ontrue>1c3cb322-828f-45fa-b32c-4c5fba7b7722</ontrue><onfalse>455e7071-87ed-4b5d-b8a6-94dfc8e2f98f</onfalse></stage><stage stageid="455e7071-87ed-4b5d-b8a6-94dfc8e2f98f" name="Set Failed" type="MultipleCalculation"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-75" y="15" /><onsuccess>2e5f165b-0a45-467b-8638-fbf00f415f72</onsuccess><steps><calculation expression="False" stage="Success" /><calculation expression="&quot;Status Code: &quot; &amp; [Status Code] &amp; &quot; Result: &quot; &amp; [Result]" stage="Response Message" /></steps></stage><stage stageid="1c3cb322-828f-45fa-b32c-4c5fba7b7722" name="Utility - JSON::JSON to Collection (skipping JArray)" type="Action"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="90" h="30" /><inputs><input type="text" name="json" friendlyname="json" expr="[Result]" /></inputs><outputs><output type="collection" name="Result" friendlyname="Result" stage="Response Collection" /></outputs><onsuccess>18547037-0a31-4603-a3ba-fe16524a3236</onsuccess><resource object="Utility - JSON" action="JSON to Collection (skipping JArray)" /></stage><stage stageid="3b4cc07c-aca4-496f-be1e-a790bb035448" name="resultId" type="Data"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><narrative>Analyze operation result identifier.</narrative><display x="-345" y="-45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bf8b2b71-42b3-4be8-b81e-9c26f9845c06" name="Response Collection" type="Collection"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><display x="-225" y="225" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="089c583c-c29e-4bce-acec-fcc8455c00bc" name="Success" type="Data"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><display x="-345" y="30" w="120" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="547aefe6-0f01-48f9-9a18-70ff1442ad4d" name="Response Message" type="Data"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><display x="-225" y="30" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="446921c9-2808-4e5a-864a-6be947a3e0fa" name="Set pages" type="Calculation"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit onsuccess="true" /><display x="15" y="180" w="90" h="30" /><onsuccess>ecb82ea0-30af-4735-8d6a-94bf735c65b8</onsuccess><calculation expression="[Response Collection.analyzeResult.pages]&#xA;" stage="pages" /></stage><stage stageid="07ded0a9-f9f7-4bff-a49c-193e8c659de1" name="documents" type="Collection"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-345" y="120" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="f5490326-af8d-45b8-bed0-7d9b869594cc" name="styles" type="Collection"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-225" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="d622ffc2-82f1-4e23-88ff-77a49a00907f" name="pages" type="Block"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-45" y="150" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="77915cbe-7232-45a5-b2bf-915f57f57b7b" name="Recover1" type="Recover"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="105" y="180" /><onsuccess>7a062945-c0f0-4fc4-84e8-4268dc1f02e3</onsuccess></stage><stage stageid="7a062945-c0f0-4fc4-84e8-4268dc1f02e3" name="Resume1" type="Resume"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="195" y="180" /><onsuccess>1eb35b6a-8220-41b1-9e91-61fef43a76bb</onsuccess></stage><stage stageid="907de9ae-d4f2-49e5-86b0-e0404eaad71d" name="Set paragraphs" type="Calculation"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit onsuccess="true" /><display x="15" y="270" w="90" h="30" /><onsuccess>9f47f449-b457-42a9-98f1-3fb1a5e43524</onsuccess><calculation expression="[Response Collection.analyzeResult.paragraphs]" stage="paragraphs" /></stage><stage stageid="61cf6d0b-9d71-4bff-ae47-a4b3f01eb7ba" name="paragraphs" type="Block"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-45" y="240" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="1f68772c-7c8d-48de-906c-34c42e4c9427" name="Recover1" type="Recover"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="105" y="270" /><onsuccess>59da9122-d0f6-4e73-aac0-11d8827399d5</onsuccess></stage><stage stageid="59da9122-d0f6-4e73-aac0-11d8827399d5" name="Resume1" type="Resume"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="195" y="270" /><onsuccess>ac65c642-8ed9-4df7-85e6-a6ac8925c185</onsuccess></stage><stage stageid="087fcedb-5661-418c-97b6-224e9e293f11" name="Set styles" type="Calculation"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit onsuccess="true" /><display x="15" y="360" w="90" h="30" /><onsuccess>6e880ba0-2507-454d-b53f-c02aab33d75a</onsuccess><calculation expression="[Response Collection.analyzeResult.styles]" stage="styles" /></stage><stage stageid="4f390d76-752f-4115-8b4c-a5105b025674" name="styles" type="Block"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-45" y="330" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="c3a38857-9818-4ed9-83b8-ba445e3630d7" name="Recover1" type="Recover"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="105" y="360" /><onsuccess>2500bea1-f1db-4de8-aef8-9d2e7e8ab3f9</onsuccess></stage><stage stageid="2500bea1-f1db-4de8-aef8-9d2e7e8ab3f9" name="Resume1" type="Resume"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="195" y="360" /><onsuccess>b8e0b98e-be39-4d74-9ed6-155703ca68b4</onsuccess></stage><stage stageid="1eb35b6a-8220-41b1-9e91-61fef43a76bb" name="Anchor1" type="Anchor"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="195" y="225" w="10" h="10" /><onsuccess>ecb82ea0-30af-4735-8d6a-94bf735c65b8</onsuccess></stage><stage stageid="ecb82ea0-30af-4735-8d6a-94bf735c65b8" name="Anchor2" type="Anchor"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="15" y="225" w="10" h="10" /><onsuccess>907de9ae-d4f2-49e5-86b0-e0404eaad71d</onsuccess></stage><stage stageid="ac65c642-8ed9-4df7-85e6-a6ac8925c185" name="Anchor1" type="Anchor"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="195" y="315" w="10" h="10" /><onsuccess>9f47f449-b457-42a9-98f1-3fb1a5e43524</onsuccess></stage><stage stageid="9f47f449-b457-42a9-98f1-3fb1a5e43524" name="Anchor2" type="Anchor"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="15" y="315" w="10" h="10" /><onsuccess>087fcedb-5661-418c-97b6-224e9e293f11</onsuccess></stage><stage stageid="b8e0b98e-be39-4d74-9ed6-155703ca68b4" name="Anchor3" type="Anchor"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="195" y="405" w="10" h="10" /><onsuccess>6e880ba0-2507-454d-b53f-c02aab33d75a</onsuccess></stage><stage stageid="2e5f165b-0a45-467b-8638-fbf00f415f72" name="Anchor6" type="Anchor"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-75" y="585" w="10" h="10" /><onsuccess>2cf3f28e-3c05-49dd-aa05-2d2490665638</onsuccess></stage><stage stageid="aec3a654-de9c-45c1-bac3-c1b4fc559e35" name="Operation status" type="Data"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-345" y="60" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="feb40bc6-35a3-44e1-a97f-3ebaf503304c" name="pages" type="Collection"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-225" y="60" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="e3988287-bec6-4aec-ae80-8ff464a7882a" name="paragraphs" type="Collection"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-345" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="2cf3f28e-3c05-49dd-aa05-2d2490665638" name="Anchor7" type="Anchor"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="15" y="585" w="10" h="10" /><onsuccess>3638e640-eb0f-4204-b6e4-572b8dd6c732</onsuccess></stage><stage stageid="18547037-0a31-4603-a3ba-fe16524a3236" name="Set Operation Status" type="Calculation"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="15" y="120" w="90" h="30" /><onsuccess>446921c9-2808-4e5a-864a-6be947a3e0fa</onsuccess><calculation expression="[Response Collection.status]" stage="Operation status" /></stage><stage stageid="9b78a5ba-42c0-440c-98fc-2c398d4ca519" name="Set documents" type="Calculation"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit onsuccess="true" /><display x="15" y="450" w="90" h="30" /><onsuccess>e54a0ccc-382c-4786-b5a8-22885a6ef5b4</onsuccess><calculation expression="[Response Collection.analyzeResult.documents]" stage="documents" /></stage><stage stageid="048629ff-116e-4027-b236-d63631aef3fc" name="documents" type="Block"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-45" y="420" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="23c47a25-f38f-4270-b6d9-ae31af697d30" name="Recover1" type="Recover"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="105" y="450" /><onsuccess>c6ba3597-3005-4a29-9068-38c1e0b5d174</onsuccess></stage><stage stageid="c6ba3597-3005-4a29-9068-38c1e0b5d174" name="Resume1" type="Resume"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="195" y="450" /><onsuccess>0ff28ac4-655c-4f50-b64d-5d423edbc983</onsuccess></stage><stage stageid="5a71458b-c613-4fe3-95d6-5de22ed8a4d2" name="Anchor3" type="Anchor"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="195" y="585" w="10" h="10" /><onsuccess>2cf3f28e-3c05-49dd-aa05-2d2490665638</onsuccess></stage><stage stageid="6e880ba0-2507-454d-b53f-c02aab33d75a" name="Anchor8" type="Anchor"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="15" y="405" w="10" h="10" /><onsuccess>9b78a5ba-42c0-440c-98fc-2c398d4ca519</onsuccess></stage><stage stageid="af8aa1ea-9e3a-4224-a9e3-07c23be93d18" name="Get Custom Model" type="SubSheetInfo"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><narrative>Get detailed information about a custom model.</narrative><display x="-285" y="-135" w="150" h="90" /></stage><stage stageid="0a7de652-572e-4b7e-b567-87cb80606c28" name="Start" type="Start"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><loginhibit /><display x="15" y="-90" /><inputs><input type="text" name="modelId" narrative="Model identifier." stage="modelId" /></inputs><onsuccess>ca5e850d-7751-483f-a858-e560a6570715</onsuccess></stage><stage stageid="7f6e8e91-0b3b-4d8c-a58e-e345157dd02b" name="Local" type="Block"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><loginhibit /><display x="-420" y="120" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="1adea7c9-a762-44c3-8b88-d9bd3fb51439" name="Output" type="Block"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><loginhibit /><display x="-420" y="0" w="270" h="105" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="1aa4f4bb-0880-49c2-b354-f285302d8874" name="Input" type="Block"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><loginhibit /><display x="-420" y="-75" w="270" h="60" /><font family="Segoe UI" size="10" style="Regular" color="99CCFF" /></stage><stage stageid="610d944e-98a2-443c-ac71-a0c485588646" name="End" type="End"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><loginhibit /><display x="15" y="120" /><outputs><output type="flag" name="Success" narrative="A flag indicating the success or failure of the action." stage="Success" /><output type="text" name="Response Message" narrative="If an error is encountered, further details may be available here." stage="Response Message" /><output type="collection" name="Model Information" narrative="Information pertaining to the model" stage="Model Information" /></outputs></stage><stage stageid="ca5e850d-7751-483f-a858-e560a6570715" name="HTTP Request" type="Action"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" w="90" h="30" /><inputs><input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="[Base URL] &amp; &quot;/formrecognizer/documentModels/&quot; &amp; [modelId] &amp; &quot;api-version=2022-08-31&quot;" /><input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" /><input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" /><input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" /><input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" /><input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="[Access Token]" /><input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the 'Authorization' header for HTTP Basic." expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" expr="" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you 'Use Bearer Token' is set to True, this must be set to the value of the actual Bearer Token." expr="" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="" /><input type="text" name="Body" friendlyname="Body" narrative="The body text of the HTTP request" expr="" /><input type="text" name="Content Type" friendlyname="Content Type" narrative="The content type of the HTTP request." expr="" /><input type="text" name="Method" friendlyname="Method" narrative="The method of the HTTP request." expr="&quot;GET&quot;" /><input type="flag" name="File URL" friendlyname="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" /></inputs><outputs><output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="Headers as Json" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="Status Code" /></outputs><onsuccess>f9ebdc7e-cf9a-4472-b2ac-128dfecedead</onsuccess><resource object="Utility - HTTP" action="HTTP Request" /></stage><stage stageid="35c89411-e07a-4a4a-9f26-38aa8c350f4b" name="Result" type="Data"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><display x="-345" y="180" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1f160489-3a12-4198-9798-41e37f567f54" name="Headers as Json" type="Data"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><display x="-225" y="150" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ce76037e-0518-4d0e-a50e-82e5f76b4432" name="Status Code" type="Data"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><display x="-345" y="150" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f9ebdc7e-cf9a-4472-b2ac-128dfecedead" name="200?" type="Decision"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><loginhibit /><display x="15" y="15" /><decision expression="[Status Code] = 200" /><ontrue>cbe4c67e-7388-45bc-aed4-fd99e81e2dd4</ontrue><onfalse>5f274adf-3887-470c-8049-e86d27682319</onfalse></stage><stage stageid="5f274adf-3887-470c-8049-e86d27682319" name="Set Failed" type="MultipleCalculation"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><loginhibit /><display x="-75" y="15" /><onsuccess>4bbd37be-63d0-40be-8b88-b2236032726f</onsuccess><steps><calculation expression="False" stage="Success" /><calculation expression="&quot;Status Code: &quot; &amp; [Status Code] &amp; &quot; Result: &quot; &amp; [Result]" stage="Response Message" /></steps></stage><stage stageid="cbe4c67e-7388-45bc-aed4-fd99e81e2dd4" name="Utility - JSON::JSON to Collection (skipping JArray)" type="Action"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="90" h="30" /><inputs><input type="text" name="json" friendlyname="json" expr="[Result]" /></inputs><outputs><output type="collection" name="Result" friendlyname="Result" stage="Model Information" /></outputs><onsuccess>610d944e-98a2-443c-ac71-a0c485588646</onsuccess><resource object="Utility - JSON" action="JSON to Collection (skipping JArray)" /></stage><stage stageid="022ab5ae-044f-4359-b363-494927b6f6eb" name="Model Information" type="Collection"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><display x="-345" y="75" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="fa0f4efa-51a2-42b7-bb8f-3bffc95ca617" name="Success" type="Data"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><display x="-345" y="30" w="120" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="c5d1ef7d-4e2f-4a0d-9df6-493bc3b4199e" name="Response Message" type="Data"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><display x="-225" y="30" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4bbd37be-63d0-40be-8b88-b2236032726f" name="Anchor6" type="Anchor"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><loginhibit /><display x="-75" y="120" w="10" h="10" /><onsuccess>610d944e-98a2-443c-ac71-a0c485588646</onsuccess></stage><stage stageid="298c4557-be0b-464a-9034-ccafb7bd17d8" name="modelId" type="Data"><subsheetid>15065b9d-c113-4686-a586-0378bfca8e9f</subsheetid><loginhibit /><narrative>Model identifier.</narrative><display x="-345" y="-45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="59180426-867c-4431-8fdc-737f0997fb30" name="Get Custom Models" type="SubSheetInfo"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><narrative>Get information about all custom models</narrative><display x="-300" y="-135" w="150" h="90" /></stage><stage stageid="98f46171-7a1b-463e-b7d0-e363273bd874" name="Start" type="Start"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><loginhibit /><display x="15" y="-105" /><onsuccess>bb5b2653-b95b-4bb1-aa68-1748563566e7</onsuccess></stage><stage stageid="d86132e8-596f-417a-9ba2-ba286326669d" name="Local" type="Block"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><loginhibit /><display x="-420" y="120" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="c4e6f80b-a444-4e94-a862-0517d1337c77" name="Output" type="Block"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><loginhibit /><display x="-420" y="0" w="270" h="105" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="a6b22552-f142-460b-b181-a11b8192f40f" name="Input" type="Block"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><loginhibit /><display x="-420" y="-75" w="270" h="60" /><font family="Segoe UI" size="10" style="Regular" color="99CCFF" /></stage><stage stageid="de731ce0-4a06-4f1b-852b-d75079908339" name="End" type="End"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><loginhibit /><display x="15" y="120" /><outputs><output type="flag" name="Success" narrative="A flag indicating the success or failure of the action." stage="Success" /><output type="text" name="Response Message" narrative="If an error is encountered, further details may be available here." stage="Response Message" /><output type="collection" name="Model Information" narrative="Information pertaining to the models" stage="Model Information" /></outputs></stage><stage stageid="bb5b2653-b95b-4bb1-aa68-1748563566e7" name="HTTP Request" type="Action"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" w="90" h="30" /><inputs><input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="[Base URL] &amp; &quot;/formrecognizer/documentModels?api-version=2022-08-31&quot;" /><input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" /><input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" /><input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" /><input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" /><input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="[Access Token]" /><input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the 'Authorization' header for HTTP Basic." expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" expr="" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you 'Use Bearer Token' is set to True, this must be set to the value of the actual Bearer Token." expr="" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="" /><input type="text" name="Body" friendlyname="Body" narrative="The body text of the HTTP request" expr="" /><input type="text" name="Content Type" friendlyname="Content Type" narrative="The content type of the HTTP request." expr="" /><input type="text" name="Method" friendlyname="Method" narrative="The method of the HTTP request." expr="&quot;GET&quot;" /><input type="flag" name="File URL" friendlyname="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" /></inputs><outputs><output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="Headers as Json" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="Status Code" /></outputs><onsuccess>9723d0d8-d1c3-469f-992e-49238cbb418e</onsuccess><resource object="Utility - HTTP" action="HTTP Request" /></stage><stage stageid="a65ddd7f-f162-4c5a-99b9-9f126ad10417" name="Result" type="Data"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><display x="-345" y="180" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="fc6ba0a3-f45a-447e-aef2-06ed781c4b6f" name="Headers as Json" type="Data"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><display x="-225" y="150" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0dc07567-9beb-4f8f-ab29-5433e12d5a8d" name="Status Code" type="Data"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><display x="-345" y="150" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9723d0d8-d1c3-469f-992e-49238cbb418e" name="200?" type="Decision"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><loginhibit /><display x="15" y="15" /><decision expression="[Status Code] = 200" /><ontrue>708d72b2-ef33-49b7-b6d1-d833e6b889bd</ontrue><onfalse>f66d4b95-64e2-4ef2-b29d-0e0913dcd115</onfalse></stage><stage stageid="f66d4b95-64e2-4ef2-b29d-0e0913dcd115" name="Set Failed" type="MultipleCalculation"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><loginhibit /><display x="-75" y="15" /><onsuccess>de5a26d1-e21c-42fe-817d-3a2b5b00471c</onsuccess><steps><calculation expression="False" stage="Success" /><calculation expression="&quot;Status Code: &quot; &amp; [Status Code] &amp; &quot; Result: &quot; &amp; [Result]" stage="Response Message" /></steps></stage><stage stageid="9c0f4f82-198d-419b-a411-e66d5594c12f" name="Model Information" type="Collection"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><display x="-345" y="75" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="2bd48e90-724a-4a71-9601-12044cac05c5" name="Success" type="Data"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><display x="-345" y="30" w="120" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="52fda453-a3cb-463d-8f5a-08937ab4b76e" name="Response Message" type="Data"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><display x="-225" y="30" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="de5a26d1-e21c-42fe-817d-3a2b5b00471c" name="Anchor6" type="Anchor"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><loginhibit /><display x="-75" y="120" w="10" h="10" /><onsuccess>de731ce0-4a06-4f1b-852b-d75079908339</onsuccess></stage><stage stageid="35e71163-3f64-4c91-bf2e-810d247b12ee" name="Analyze Business Card Async" type="SubSheetInfo"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><narrative>Extract field text and semantic values from a given business card document. The input document must be of one of the supported content types - 'application/pdf', 'image/jpeg', 'image/png' or 'image/tiff'.</narrative><display x="-285" y="-135" w="150" h="90" /></stage><stage stageid="708d72b2-ef33-49b7-b6d1-d833e6b889bd" name="Utility - JSON::JSON to Collection (skipping JArray)" type="Action"><subsheetid>2f665482-f11d-4fed-bacf-dab63bf57357</subsheetid><loginhibit onsuccess="true" /><display x="15" y="60" w="90" h="30" /><inputs><input type="text" name="json" friendlyname="json" expr="[Result]" /></inputs><outputs><output type="collection" name="Result" friendlyname="Result" stage="Model Information" /></outputs><onsuccess>de731ce0-4a06-4f1b-852b-d75079908339</onsuccess><resource object="Utility - JSON" action="JSON to Collection (skipping JArray)" /></stage><stage stageid="a18a07b8-3465-47ae-b070-8f47c585f01d" name="Start" type="Start"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="FilePath" narrative="The path of the file" stage="FileMetadata.FilePath" /></inputs><onsuccess>e044c86b-b5f5-4a8a-9492-a71d523e2478</onsuccess></stage><stage stageid="6f44a0ae-5c75-4f90-9543-a241d650d957" name="Local" type="Block"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><loginhibit /><display x="-420" y="135" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="327e1cf7-d351-4b1f-9d6e-5a2068e033d9" name="Output" type="Block"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><loginhibit /><display x="-420" y="30" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="023c4ce5-ec59-409b-bd98-f906d9213f7b" name="Input" type="Block"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><loginhibit /><display x="-420" y="-75" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="99CCFF" /></stage><stage stageid="3eb05938-ea39-4e0b-9f3a-ab8b7b03ed5f" name="End" type="End"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><loginhibit /><display x="15" y="135" /><outputs><output type="flag" name="Success" narrative="A flag indicating the success or failure of the action." stage="Success" /><output type="text" name="Response Message" narrative="If an error is encountered, further details may be available here." stage="Response Message" /><output type="text" name="Result ID" narrative="Result ID used to query the status of the asynchronous operation and get the results." stage="Response Collection.apim-request-id" /></outputs></stage><stage stageid="e044c86b-b5f5-4a8a-9492-a71d523e2478" name="HTTP Request" type="Action"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" w="90" h="30" /><inputs><input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="[Base URL] &amp; &quot;/formrecognizer/documentModels/prebuilt-businessCard:analyze?api-version=2022-08-31&quot;" /><input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" /><input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" /><input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" /><input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" /><input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="[Access Token]" /><input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" narrative="OPTIONAL: If you need bearer token authorization set this to true." expr="" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you have a bearer token and need to use authorization" expr="" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="" /><input type="collection" name="FileMetadata" friendlyname="FileMetadata" narrative="Files to be sent in the multipart HTTP  request" expr="[FileMetadata]" /><input type="collection" name="FieldMetadata" friendlyname="FieldMetadata" narrative="Text data to be sent in the multipart HTTP  request" expr="" /></inputs><outputs><output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="Headers as Json" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="Status Code" /></outputs><onsuccess>01bdcadd-3519-4478-812f-e6ed82db4434</onsuccess><resource object="Utility - HTTP" action="HTTP Request Multipart" /></stage><stage stageid="98f035e9-f32a-4f3b-9641-f756f215d056" name="Result" type="Data"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><display x="-345" y="195" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="fb2eabdd-7f19-4aef-952f-6ac70a16f46f" name="Headers as Json" type="Data"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><display x="-225" y="165" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="edc4ecd5-5ed1-4da6-a662-3bb228af3036" name="Status Code" type="Data"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><display x="-345" y="165" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="01bdcadd-3519-4478-812f-e6ed82db4434" name="202?" type="Decision"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><loginhibit /><display x="15" y="15" /><decision expression="[Status Code] = 202" /><ontrue>0b809ed4-6122-499b-9ecf-56c90995780a</ontrue><onfalse>a484094d-99e7-4a69-a21e-05d87698d241</onfalse></stage><stage stageid="a484094d-99e7-4a69-a21e-05d87698d241" name="Set Failed" type="MultipleCalculation"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><loginhibit /><display x="-75" y="15" /><onsuccess>19f68055-7ea8-449b-97dd-7405d4235607</onsuccess><steps><calculation expression="False" stage="Success" /><calculation expression="&quot;Status Code: &quot; &amp; [Status Code] &amp; &quot; Result: &quot; &amp; [Result]" stage="Response Message" /></steps></stage><stage stageid="19f68055-7ea8-449b-97dd-7405d4235607" name="Anchor5" type="Anchor"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><loginhibit /><display x="-75" y="135" w="10" h="10" /><onsuccess>3eb05938-ea39-4e0b-9f3a-ab8b7b03ed5f</onsuccess></stage><stage stageid="c9430e38-6968-47f2-81f5-494653d30a0c" name="FileMetadata" type="Collection"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><loginhibit /><narrative>Files to be sent in the multipart HTTP  request</narrative><display x="-345" y="-30" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><singlerow /><field name="FileName" type="text" description="Optional. Used to populate the filename header for this file's section in the multi-part form body. If a value is not specified, the filename is used from the provided filepath" /><field name="FieldName" type="text" description="Optional. Used to populate the name header for this file's section in the multi-part form body. If a value is not specified, the filename is set to 'file'" /><field name="ContentType" type="text" description="Optional. Used to populate the Content-Type header for this file's section in the multi-part form body. If a value is not specified, the mimetype of the document is used." /><field name="FilePath" type="text" description="The path of the file" /></collectioninfo><initialvalue><singlerow /><row><field name="FileName" type="text" value="" /><field name="FieldName" type="text" value="source" /><field name="ContentType" type="text" value="" /><field name="FilePath" type="text" value="" /></row></initialvalue></stage><stage stageid="0b809ed4-6122-499b-9ecf-56c90995780a" name="Utility - JSON::JSON to Collection (skipping JArray)" type="Action"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="90" h="30" /><inputs><input type="text" name="json" friendlyname="json" expr="[Headers as Json]" /></inputs><outputs><output type="collection" name="Result" friendlyname="Result" stage="Response Collection" /></outputs><onsuccess>3eb05938-ea39-4e0b-9f3a-ab8b7b03ed5f</onsuccess><resource object="Utility - JSON" action="JSON to Collection (skipping JArray)" /></stage><stage stageid="9af33fdb-c030-45d5-bc3f-1ba16c4feb5c" name="Response Collection" type="Collection"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><display x="-345" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="b5544816-6e9c-42a8-a2be-e4005a71ba61" name="Success" type="Data"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><display x="-345" y="60" w="120" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="779053e9-de1d-4f46-9421-0dd46d648456" name="Response Message" type="Data"><subsheetid>39b59235-9b00-4516-bec3-13b86000e68d</subsheetid><display x="-225" y="60" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="035b066a-a16b-49c0-a4bc-c342a4007d63" name="Analyze Invoice Async" type="SubSheetInfo"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><narrative>Extract field text and semantic values from a given invoice document. The input document must be of one of the supported content types - 'application/pdf', 'image/jpeg', 'image/png' or 'image/tiff'. </narrative><display x="-255" y="-135" w="150" h="90" /></stage><stage stageid="717f08ab-b590-4d97-bba1-b9c92ddf209d" name="Start" type="Start"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="FilePath" narrative="The path of the file" stage="FileMetadata.FilePath" /></inputs><onsuccess>4a6c7fa3-94bb-4281-8097-f78d5fe5cd07</onsuccess></stage><stage stageid="e08a2ac8-3040-4a39-bc09-3748e6b77d57" name="Local" type="Block"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><loginhibit /><display x="-420" y="135" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="e4ad4637-adf2-4b8a-b458-c9dccb9f1bca" name="Output" type="Block"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><loginhibit /><display x="-420" y="30" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="16cd9a49-5822-4c4a-90c2-b0333b01c9bd" name="Input" type="Block"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><loginhibit /><display x="-420" y="-75" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="99CCFF" /></stage><stage stageid="51d6f5cf-9b87-42a8-9f55-ab22c0c714ae" name="End" type="End"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><loginhibit /><display x="15" y="135" /><outputs><output type="flag" name="Success" narrative="A flag indicating the success or failure of the action." stage="Success" /><output type="text" name="Response Message" narrative="If an error is encountered, further details may be available here." stage="Response Message" /><output type="text" name="Result ID" narrative="Result ID used to query the status of the asynchronous operation and get the results." stage="Response Collection.apim-request-id" /></outputs></stage><stage stageid="4a6c7fa3-94bb-4281-8097-f78d5fe5cd07" name="HTTP Request" type="Action"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" w="90" h="30" /><inputs><input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="[Base URL] &amp; &quot;/formrecognizer/documentModels/prebuilt-invoice:analyze?api-version=2022-08-31&quot;" /><input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" /><input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" /><input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" /><input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" /><input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="[Access Token]" /><input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" narrative="OPTIONAL: If you need bearer token authorization set this to true." expr="" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you have a bearer token and need to use authorization" expr="" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="" /><input type="collection" name="FileMetadata" friendlyname="FileMetadata" narrative="Files to be sent in the multipart HTTP  request" expr="[FileMetadata]" /><input type="collection" name="FieldMetadata" friendlyname="FieldMetadata" narrative="Text data to be sent in the multipart HTTP  request" expr="" /></inputs><outputs><output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="Headers as Json" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="Status Code" /></outputs><onsuccess>0d7bf734-1fe2-4e74-a723-19affa6e55fd</onsuccess><resource object="Utility - HTTP" action="HTTP Request Multipart" /></stage><stage stageid="9d79b6f1-77ac-4103-853b-499308093de0" name="Result" type="Data"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><display x="-345" y="195" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d5ab3de7-f866-4023-9ebe-03d2099f34af" name="Headers as Json" type="Data"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><display x="-225" y="165" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="fac336e9-eaaa-49e8-88b6-6d933b863866" name="Status Code" type="Data"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><display x="-345" y="165" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0d7bf734-1fe2-4e74-a723-19affa6e55fd" name="202?" type="Decision"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><loginhibit /><display x="15" y="15" /><decision expression="[Status Code] = 202" /><ontrue>c36eca39-61a6-47fb-8d26-932d2f9e80e5</ontrue><onfalse>b6a6790f-4334-4f1a-8eea-1015f59648b6</onfalse></stage><stage stageid="b6a6790f-4334-4f1a-8eea-1015f59648b6" name="Set Failed" type="MultipleCalculation"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><loginhibit /><display x="-75" y="15" /><onsuccess>63d8e7ad-7e9b-44e5-acda-9c03d43068a8</onsuccess><steps><calculation expression="False" stage="Success" /><calculation expression="&quot;Status Code: &quot; &amp; [Status Code] &amp; &quot; Result: &quot; &amp; [Result]" stage="Response Message" /></steps></stage><stage stageid="63d8e7ad-7e9b-44e5-acda-9c03d43068a8" name="Anchor5" type="Anchor"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><loginhibit /><display x="-75" y="135" w="10" h="10" /><onsuccess>51d6f5cf-9b87-42a8-9f55-ab22c0c714ae</onsuccess></stage><stage stageid="1656d295-155f-4c44-898e-fd1137e8eebc" name="FileMetadata" type="Collection"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><loginhibit /><narrative>Files to be sent in the multipart HTTP  request</narrative><display x="-345" y="-30" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><singlerow /><field name="FileName" type="text" description="Optional. Used to populate the filename header for this file's section in the multi-part form body. If a value is not specified, the filename is used from the provided filepath" /><field name="FieldName" type="text" description="Optional. Used to populate the name header for this file's section in the multi-part form body. If a value is not specified, the filename is set to 'file'" /><field name="ContentType" type="text" description="Optional. Used to populate the Content-Type header for this file's section in the multi-part form body. If a value is not specified, the mimetype of the document is used." /><field name="FilePath" type="text" description="The path of the file" /></collectioninfo><initialvalue><singlerow /><row><field name="FileName" type="text" value="" /><field name="FieldName" type="text" value="source" /><field name="ContentType" type="text" value="" /><field name="FilePath" type="text" value="" /></row></initialvalue></stage><stage stageid="c36eca39-61a6-47fb-8d26-932d2f9e80e5" name="Utility - JSON::JSON to Collection (skipping JArray)" type="Action"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="90" h="30" /><inputs><input type="text" name="json" friendlyname="json" expr="[Headers as Json]" /></inputs><outputs><output type="collection" name="Result" friendlyname="Result" stage="Response Collection" /></outputs><onsuccess>51d6f5cf-9b87-42a8-9f55-ab22c0c714ae</onsuccess><resource object="Utility - JSON" action="JSON to Collection (skipping JArray)" /></stage><stage stageid="eb5d8f00-cff3-417f-ad76-719dd6d265c3" name="Response Collection" type="Collection"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><display x="-345" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="906c53d2-562f-4f9d-a900-57eb97827d28" name="Success" type="Data"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><display x="-345" y="60" w="120" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="a13530f4-df0d-4e1c-af35-29b02fc79650" name="Response Message" type="Data"><subsheetid>8cd84e7f-9c5e-46c9-9aa1-ae006e7b0261</subsheetid><display x="-225" y="60" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6a5f11a0-20de-400a-a8be-8fab665e7c59" name="Get Analyze Business Card Result" type="SubSheetInfo"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><narrative>Track the progress and obtain the result of the analyze business card operation.</narrative><display x="-270" y="-135" w="150" h="90" /></stage><stage stageid="aebdd801-ce38-4041-988b-372c77a78033" name="Start" type="Start"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="resultId" narrative="Analyze operation result identifier." stage="resultId" /></inputs><onsuccess>5c2dd79d-26c1-4867-ae51-95289366a1f7</onsuccess></stage><stage stageid="885d4af0-337e-4851-ace3-416084eea059" name="Local" type="Block"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-420" y="165" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="1de05b6c-e5ed-47bf-870c-8b4ba68add0c" name="Output" type="Block"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-420" y="0" w="270" h="150" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="eda9b08a-a82e-4fa0-9d49-e2dc63f2b5e4" name="Input" type="Block"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-420" y="-75" w="270" h="60" /><font family="Segoe UI" size="10" style="Regular" color="99CCFF" /></stage><stage stageid="6b1b3107-17e8-424c-ac1c-7ba5e456c0b4" name="End" type="End"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="15" y="630" /><outputs><output type="flag" name="Success" narrative="A flag indicating the success or failure of the action." stage="Success" /><output type="text" name="Response Message" narrative="If an error is encountered, further details may be available here." stage="Response Message" /><output type="text" name="Operation status" narrative="Operation status" stage="Operation status" /><output type="collection" name="pages" narrative=" " stage="pages" /><output type="collection" name="paragraphs" narrative=" " stage="paragraphs" /><output type="collection" name="styles" narrative=" " stage="styles" /><output type="collection" name="documents" narrative=" " stage="documents" /><output type="text" name="content" narrative="The text content" stage="content" /></outputs></stage><stage stageid="5c2dd79d-26c1-4867-ae51-95289366a1f7" name="HTTP Request" type="Action"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" w="90" h="30" /><inputs><input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="[Base URL] &amp; &quot;/formrecognizer/documentModels/prebuilt-businessCard/analyzeResults/&quot; &amp; [resultId] &amp; &quot;?api-version=2022-08-31&quot;&#xA;&#xA;" /><input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" /><input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" /><input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" /><input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" /><input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="[Access Token]" /><input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the 'Authorization' header for HTTP Basic." expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" expr="" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you 'Use Bearer Token' is set to True, this must be set to the value of the actual Bearer Token." expr="" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="" /><input type="text" name="Body" friendlyname="Body" narrative="The body text of the HTTP request" expr="" /><input type="text" name="Content Type" friendlyname="Content Type" narrative="The content type of the HTTP request." expr="" /><input type="text" name="Method" friendlyname="Method" narrative="The method of the HTTP request." expr="&quot;GET&quot;" /><input type="flag" name="File URL" friendlyname="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" /></inputs><outputs><output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="Headers as Json" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="Status Code" /></outputs><onsuccess>1c5cdcd2-b681-4db9-a473-c64206b4ec01</onsuccess><resource object="Utility - HTTP" action="HTTP Request" /></stage><stage stageid="999bed6d-bece-4dc8-8634-677c3ed7ef68" name="Result" type="Data"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><display x="-345" y="225" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f0f9e5c7-2898-4199-8d4e-698ed71e2306" name="Headers as Json" type="Data"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><display x="-225" y="195" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0a4adfd7-169c-4dea-bcdf-9b44868e8ac5" name="Status Code" type="Data"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><display x="-345" y="195" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1c5cdcd2-b681-4db9-a473-c64206b4ec01" name="200?" type="Decision"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="15" y="15" /><decision expression="[Status Code] = 200" /><ontrue>1fa95ff9-7977-45f3-9729-5d5f27c20fb6</ontrue><onfalse>2cb6eae4-34f8-4cfe-898c-9d714ab588ad</onfalse></stage><stage stageid="2cb6eae4-34f8-4cfe-898c-9d714ab588ad" name="Set Failed" type="MultipleCalculation"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-75" y="15" /><onsuccess>1a906441-0788-418a-b456-c0b2a38719f6</onsuccess><steps><calculation expression="False" stage="Success" /><calculation expression="&quot;Status Code: &quot; &amp; [Status Code] &amp; &quot; Result: &quot; &amp; [Result]" stage="Response Message" /></steps></stage><stage stageid="1fa95ff9-7977-45f3-9729-5d5f27c20fb6" name="Utility - JSON::JSON to Collection (skipping JArray)" type="Action"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="90" h="30" /><inputs><input type="text" name="json" friendlyname="json" expr="[Result]" /></inputs><outputs><output type="collection" name="Result" friendlyname="Result" stage="Response Collection" /></outputs><onsuccess>86194da7-7b8b-4210-9ea8-b3486ce7064c</onsuccess><resource object="Utility - JSON" action="JSON to Collection (skipping JArray)" /></stage><stage stageid="ace7665d-cbb5-4e19-bfed-a75ad6d80335" name="resultId" type="Data"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><narrative>Analyze operation result identifier.</narrative><display x="-345" y="-45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a0d5a2f0-3551-4c60-860b-cc22e82e9c46" name="Response Collection" type="Collection"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><display x="-225" y="225" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="302a3235-0316-4153-a1ff-2a5b45050b8e" name="Success" type="Data"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><display x="-345" y="30" w="120" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="784f1a10-1e45-46b8-a9b0-013fdbe7ce2e" name="Response Message" type="Data"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><display x="-225" y="30" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2df6a0e7-0899-4367-8cde-218dfaa60583" name="Set pages" type="Calculation"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="180" w="90" h="30" /><onsuccess>9e1e420d-e381-4b16-b6ae-2f2d5b688591</onsuccess><calculation expression="[Response Collection.analyzeResult.pages]&#xA;" stage="pages" /></stage><stage stageid="e73bf7c2-241a-49af-aec4-263ba2dc41e0" name="documents" type="Collection"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-345" y="120" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="09b81672-cba2-465a-b96f-9c498c6f93ae" name="styles" type="Collection"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-225" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="da2401b0-045e-4580-bc04-9fb9b7aee44e" name="pages" type="Block"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-45" y="150" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="297d311e-3bcb-41f9-a728-fafa4bc69fd6" name="Recover1" type="Recover"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="105" y="180" /><onsuccess>0a33af04-404e-41b2-9d6b-8a59983f54e9</onsuccess></stage><stage stageid="0a33af04-404e-41b2-9d6b-8a59983f54e9" name="Resume1" type="Resume"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="195" y="180" /><onsuccess>6db00694-5ae6-4814-84b8-2744596dabed</onsuccess></stage><stage stageid="fa0b982a-1cac-4ab6-a9c7-5706249810db" name="Set paragraphs" type="Calculation"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="270" w="90" h="30" /><onsuccess>ddca2be1-cd29-45c9-b10b-07fa3472bedf</onsuccess><calculation expression="[Response Collection.analyzeResult.paragraphs]" stage="paragraphs" /></stage><stage stageid="093b951a-29ce-4c97-9d88-650af59e4ceb" name="paragraphs" type="Block"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-45" y="240" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="75029e26-6ace-4872-b894-713e107e17a8" name="Recover1" type="Recover"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="105" y="270" /><onsuccess>59be8721-0d1b-419e-8775-542ebdabe060</onsuccess></stage><stage stageid="59be8721-0d1b-419e-8775-542ebdabe060" name="Resume1" type="Resume"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="195" y="270" /><onsuccess>320a6139-a968-49f7-8969-7014bccbdbc5</onsuccess></stage><stage stageid="2c334f22-12aa-4b69-b80e-4bc0c5a65313" name="Set styles" type="Calculation"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="360" w="90" h="30" /><onsuccess>1c1da60c-40fc-434d-8901-9983f20a5d47</onsuccess><calculation expression="[Response Collection.analyzeResult.styles]" stage="styles" /></stage><stage stageid="c78ccda1-543f-483d-b8e9-c77f62aa9575" name="styles" type="Block"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-45" y="330" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="9fd0e7e9-dccd-4117-84a1-e96673df7e9d" name="Recover1" type="Recover"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="105" y="360" /><onsuccess>eb2a18bd-5555-408c-8061-587c146a6b16</onsuccess></stage><stage stageid="eb2a18bd-5555-408c-8061-587c146a6b16" name="Resume1" type="Resume"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="195" y="360" /><onsuccess>246167c3-a279-4165-9217-5e825d50868e</onsuccess></stage><stage stageid="6db00694-5ae6-4814-84b8-2744596dabed" name="Anchor1" type="Anchor"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="195" y="225" w="10" h="10" /><onsuccess>9e1e420d-e381-4b16-b6ae-2f2d5b688591</onsuccess></stage><stage stageid="9e1e420d-e381-4b16-b6ae-2f2d5b688591" name="Anchor2" type="Anchor"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="15" y="225" w="10" h="10" /><onsuccess>fa0b982a-1cac-4ab6-a9c7-5706249810db</onsuccess></stage><stage stageid="320a6139-a968-49f7-8969-7014bccbdbc5" name="Anchor1" type="Anchor"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="195" y="315" w="10" h="10" /><onsuccess>ddca2be1-cd29-45c9-b10b-07fa3472bedf</onsuccess></stage><stage stageid="ddca2be1-cd29-45c9-b10b-07fa3472bedf" name="Anchor2" type="Anchor"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="15" y="315" w="10" h="10" /><onsuccess>2c334f22-12aa-4b69-b80e-4bc0c5a65313</onsuccess></stage><stage stageid="246167c3-a279-4165-9217-5e825d50868e" name="Anchor3" type="Anchor"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="195" y="405" w="10" h="10" /><onsuccess>1c1da60c-40fc-434d-8901-9983f20a5d47</onsuccess></stage><stage stageid="1a906441-0788-418a-b456-c0b2a38719f6" name="Anchor6" type="Anchor"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-75" y="585" w="10" h="10" /><onsuccess>2efbbb11-eb0a-42de-8beb-44a79d405fca</onsuccess></stage><stage stageid="bd0674bb-8ca0-4783-9d46-8074fd150ea1" name="Operation status" type="Data"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-345" y="60" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4434a938-adca-4537-8f61-ee82acd9c770" name="pages" type="Collection"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-225" y="60" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="e345bd97-02ed-4be7-9038-1848498b838e" name="paragraphs" type="Collection"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-345" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="2efbbb11-eb0a-42de-8beb-44a79d405fca" name="Anchor7" type="Anchor"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="15" y="585" w="10" h="10" /><onsuccess>6b1b3107-17e8-424c-ac1c-7ba5e456c0b4</onsuccess></stage><stage stageid="86194da7-7b8b-4210-9ea8-b3486ce7064c" name="Set Operation Status" type="Calculation"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="15" y="120" w="90" h="30" /><onsuccess>2df6a0e7-0899-4367-8cde-218dfaa60583</onsuccess><calculation expression="[Response Collection.status]" stage="Operation status" /></stage><stage stageid="28210526-20a6-4fca-bb6f-82c8ccba0691" name="Set documents" type="Calculation"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="450" w="90" h="30" /><onsuccess>5c901450-7ff0-409e-9fd0-09a4e9597292</onsuccess><calculation expression="[Response Collection.analyzeResult.documents]" stage="documents" /></stage><stage stageid="52b83a96-c998-4913-9e97-5ada48a4fa20" name="documents" type="Block"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-45" y="420" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="15a50352-3064-4f2c-be11-b869fe5b2757" name="Recover1" type="Recover"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="105" y="450" /><onsuccess>586b790d-d11a-4a46-a84f-380207485a32</onsuccess></stage><stage stageid="586b790d-d11a-4a46-a84f-380207485a32" name="Resume1" type="Resume"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="195" y="450" /><onsuccess>3e63577f-f514-4317-90bf-80ed4e09a568</onsuccess></stage><stage stageid="d4980bfc-5346-4016-b4ea-6013b26d55c5" name="Anchor3" type="Anchor"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="195" y="585" w="10" h="10" /><onsuccess>2efbbb11-eb0a-42de-8beb-44a79d405fca</onsuccess></stage><stage stageid="1c1da60c-40fc-434d-8901-9983f20a5d47" name="Anchor8" type="Anchor"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="15" y="405" w="10" h="10" /><onsuccess>28210526-20a6-4fca-bb6f-82c8ccba0691</onsuccess></stage><stage stageid="f824d1d7-1899-459b-a0bc-84ea6c2a2654" name="Get Analyze Invoice Result" type="SubSheetInfo"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><narrative>Track the progress and obtain the result of the analyze invoice operation.</narrative><display x="-285" y="-135" w="150" h="90" /></stage><stage stageid="b96b9cfe-b910-4117-841a-3f6cdb2a6b96" name="Start" type="Start"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="resultId" narrative="Analyze operation result identifier." stage="resultId" /></inputs><onsuccess>d752b60b-c455-4516-80ee-fb10a49e8db5</onsuccess></stage><stage stageid="c400eb16-92b5-4e1c-97ee-97b4775d5bbe" name="Local" type="Block"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-420" y="195" w="270" h="90" /><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="1239b500-1954-47c2-a03b-7edeac91ba03" name="Output" type="Block"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-420" y="0" w="270" h="180" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="1aedd5d1-fba6-4443-b252-d860745e8a93" name="Input" type="Block"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-420" y="-75" w="270" h="60" /><font family="Segoe UI" size="10" style="Regular" color="99CCFF" /></stage><stage stageid="1a3d7c56-3ca7-49ec-afaf-905cfaaca837" name="End" type="End"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="15" y="810" /><outputs><output type="flag" name="Success" narrative="A flag indicating the success or failure of the action." stage="Success" /><output type="text" name="Response Message" narrative="If an error is encountered, further details may be available here." stage="Response Message" /><output type="text" name="Operation status" narrative="Operation status" stage="Operation status" /><output type="collection" name="documents" narrative=" " stage="documents" /><output type="collection" name="styles" narrative=" " stage="styles" /><output type="collection" name="tables" narrative=" " stage="tables" /><output type="collection" name="paragraphs" narrative=" " stage="paragraphs" /><output type="collection" name="keyValuePairs" stage="keyValuePairs" /><output type="collection" name="pages" stage="pages" /><output type="text" name="content" narrative="The text content" stage="content" /></outputs></stage><stage stageid="d752b60b-c455-4516-80ee-fb10a49e8db5" name="HTTP Request" type="Action"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" w="90" h="30" /><inputs><input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="[Base URL] &amp; &quot;/formrecognizer/documentModels/prebuilt-invoice/analyzeResults/&quot; &amp; [resultId] &amp; &quot;?api-version=2022-08-31&quot;" /><input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" /><input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" /><input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" /><input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" /><input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="[Access Token]" /><input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the 'Authorization' header for HTTP Basic." expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" expr="" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you 'Use Bearer Token' is set to True, this must be set to the value of the actual Bearer Token." expr="" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="" /><input type="text" name="Body" friendlyname="Body" narrative="The body text of the HTTP request" expr="" /><input type="text" name="Content Type" friendlyname="Content Type" narrative="The content type of the HTTP request." expr="" /><input type="text" name="Method" friendlyname="Method" narrative="The method of the HTTP request." expr="&quot;GET&quot;" /><input type="flag" name="File URL" friendlyname="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" /></inputs><outputs><output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="Headers as Json" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="Status Code" /></outputs><onsuccess>704616d3-5e2e-42c7-82b4-0f12f07d81b7</onsuccess><resource object="Utility - HTTP" action="HTTP Request" /></stage><stage stageid="8c72809f-4757-4fb5-9ec5-ef117176da96" name="Result" type="Data"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><display x="-345" y="255" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="493c0512-b41d-421b-82c7-900abd39a073" name="Headers as Json" type="Data"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><display x="-225" y="225" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5a886fa3-3a05-48d9-8288-b9d9cf5bf252" name="Status Code" type="Data"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><display x="-345" y="225" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="704616d3-5e2e-42c7-82b4-0f12f07d81b7" name="200?" type="Decision"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="15" y="15" /><decision expression="[Status Code] = 200" /><ontrue>fdcffc38-e52e-4994-b120-4c180a2d154e</ontrue><onfalse>ba9f5fb2-f134-4268-bdb0-61355c21b97c</onfalse></stage><stage stageid="ba9f5fb2-f134-4268-bdb0-61355c21b97c" name="Set Failed" type="MultipleCalculation"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-75" y="15" /><onsuccess>5c98cf91-227b-4cca-8719-9969d705cb69</onsuccess><steps><calculation expression="False" stage="Success" /><calculation expression="&quot;Status Code: &quot; &amp; [Status Code] &amp; &quot; Result: &quot; &amp; [Result]" stage="Response Message" /></steps></stage><stage stageid="fdcffc38-e52e-4994-b120-4c180a2d154e" name="Utility - JSON::JSON to Collection (skipping JArray)" type="Action"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="90" h="30" /><inputs><input type="text" name="json" friendlyname="json" expr="[Result]" /></inputs><outputs><output type="collection" name="Result" friendlyname="Result" stage="Response Collection" /></outputs><onsuccess>97e30edf-e2b6-491c-a29c-1c93fa53064d</onsuccess><resource object="Utility - JSON" action="JSON to Collection (skipping JArray)" /></stage><stage stageid="de4f3cc2-9e3f-4d21-9f76-cc4d61be50e7" name="resultId" type="Data"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><narrative>Analyze operation result identifier.</narrative><display x="-345" y="-45" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4f6b6c27-45e2-4549-920c-d3ffb7631a1d" name="Response Collection" type="Collection"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><display x="-225" y="255" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="4bbcf044-3ab4-4cc3-b44b-be9b59607d0e" name="Success" type="Data"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><display x="-345" y="30" w="120" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="bc2aa021-1125-4069-9653-48e4f3582b43" name="Response Message" type="Data"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><display x="-225" y="30" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4f69bbec-43dd-47ca-aa7d-5675b3ac69e3" name="documents" type="Calculation"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit onsuccess="true" /><display x="15" y="180" w="90" h="30" /><onsuccess>b79ff1ed-42fc-4eaa-9514-578f46ba21f4</onsuccess><calculation expression="[Response Collection.analyzeResult.documents]&#xA;" stage="documents" /></stage><stage stageid="57a059ef-e344-4431-b9c8-f77ecb185005" name="keyValuePairs" type="Collection"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-345" y="120" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="9f869d94-02da-46e9-80ea-89e97ee2a3f5" name="pages" type="Collection"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><narrative>The "pageResults" collection includes the tables extracted. For each table, the text, row, and column index, row and column spanning, bounding box, and more are extracted.</narrative><display x="-225" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="0ef72d5d-9b01-47e0-96e9-e63eb6ba46a6" name="documents" type="Block"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-45" y="150" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="7bb9a7c7-983b-4a12-8bb3-fd5ef1926956" name="Recover1" type="Recover"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="105" y="180" /><onsuccess>e4df57d1-e826-4c63-ae01-1fb281c2947d</onsuccess></stage><stage stageid="e4df57d1-e826-4c63-ae01-1fb281c2947d" name="Resume1" type="Resume"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="195" y="180" /><onsuccess>982f1f51-0937-4924-9922-6d62f8fe981d</onsuccess></stage><stage stageid="3da6d2da-5009-4f6e-af21-f04cd2de2706" name="Set tables" type="Calculation"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit onsuccess="true" /><display x="15" y="270" w="90" h="30" /><onsuccess>79cd3333-9fb7-429f-82fb-77a8be5bf166</onsuccess><calculation expression="[Response Collection.analyzeResult.tables]" stage="tables" /></stage><stage stageid="d3e9f0a2-fb0c-457d-819e-5c877e077773" name="tables" type="Block"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-45" y="240" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e3cc0d30-f9f9-43e9-af14-10a55277667b" name="Recover1" type="Recover"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="105" y="270" /><onsuccess>c78849ca-4b05-4e01-8f4d-7548ba93e98c</onsuccess></stage><stage stageid="c78849ca-4b05-4e01-8f4d-7548ba93e98c" name="Resume1" type="Resume"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="195" y="270" /><onsuccess>ec7bf505-f78c-4595-92df-970cbedce197</onsuccess></stage><stage stageid="e58d8f73-1eb1-4bd2-b2e0-f14bb32d1a4b" name="Set pages" type="Calculation"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit onsuccess="true" /><display x="15" y="450" w="90" h="30" /><onsuccess>f6882442-19d4-4c2f-a768-4a5c9113c50f</onsuccess><calculation expression="[Response Collection.analyzeResult.pages]" stage="pages" /></stage><stage stageid="4733b9f3-1237-486d-a9d9-4aad8cf8a321" name="pages" type="Block"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-45" y="420" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="cdf8492d-19d9-4d1f-9517-79dbb8711c18" name="Recover1" type="Recover"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="105" y="450" /><onsuccess>42cd16dd-bba5-4224-853c-f75af83239c8</onsuccess></stage><stage stageid="42cd16dd-bba5-4224-853c-f75af83239c8" name="Resume1" type="Resume"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="195" y="450" /><onsuccess>c20b5005-ec4f-4608-a0e2-37cc631ab4ca</onsuccess></stage><stage stageid="982f1f51-0937-4924-9922-6d62f8fe981d" name="Anchor1" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="195" y="225" w="10" h="10" /><onsuccess>b79ff1ed-42fc-4eaa-9514-578f46ba21f4</onsuccess></stage><stage stageid="b79ff1ed-42fc-4eaa-9514-578f46ba21f4" name="Anchor2" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="15" y="225" w="10" h="10" /><onsuccess>3da6d2da-5009-4f6e-af21-f04cd2de2706</onsuccess></stage><stage stageid="ec7bf505-f78c-4595-92df-970cbedce197" name="Anchor1" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="195" y="315" w="10" h="10" /><onsuccess>79cd3333-9fb7-429f-82fb-77a8be5bf166</onsuccess></stage><stage stageid="79cd3333-9fb7-429f-82fb-77a8be5bf166" name="Anchor2" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="15" y="315" w="10" h="10" /><onsuccess>0bde0e73-8c0f-4a23-ad7d-9dcd4f4ba143</onsuccess></stage><stage stageid="c20b5005-ec4f-4608-a0e2-37cc631ab4ca" name="Anchor3" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="195" y="495" w="10" h="10" /><onsuccess>f6882442-19d4-4c2f-a768-4a5c9113c50f</onsuccess></stage><stage stageid="5c98cf91-227b-4cca-8719-9969d705cb69" name="Anchor6" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-75" y="765" w="10" h="10" /><onsuccess>23445f65-393c-4a69-8772-728e1efb053e</onsuccess></stage><stage stageid="1ebcd0ad-21fc-4295-b450-aaea35d7c0d5" name="Operation status" type="Data"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-345" y="60" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4f4ccacd-5379-439b-9b3c-835eea68d38a" name="documents" type="Collection"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><narrative>Document-level information extracted from the input.</narrative><display x="-225" y="60" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="62d0df8e-fffb-413d-9885-d3f2aa2c797f" name="tables" type="Collection"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-345" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="23445f65-393c-4a69-8772-728e1efb053e" name="Anchor7" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="15" y="765" w="10" h="10" /><onsuccess>1a3d7c56-3ca7-49ec-afaf-905cfaaca837</onsuccess></stage><stage stageid="97e30edf-e2b6-491c-a29c-1c93fa53064d" name="Set Operation Status" type="Calculation"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="15" y="120" w="90" h="30" /><onsuccess>4f69bbec-43dd-47ca-aa7d-5675b3ac69e3</onsuccess><calculation expression="[Response Collection.status]" stage="Operation status" /></stage><stage stageid="05a846d6-c2a1-402a-aaa8-05b0c103b310" name="Set keyValuePairs" type="Calculation"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit onsuccess="true" /><display x="15" y="630" w="90" h="30" /><onsuccess>36d9de52-4f10-4580-8291-9a7efd58a18d</onsuccess><calculation expression="[Response Collection.analyzeResult.keyValuePairs]" stage="keyValuePairs" /></stage><stage stageid="2552339b-679e-403a-8cfe-5db9e80b8901" name="keyValuePairs" type="Block"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-45" y="600" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="4b554907-9f7a-42d1-ae6f-d214b7e9e427" name="Recover1" type="Recover"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="105" y="630" /><onsuccess>60a37e65-2e62-4200-afe0-808b8b55460c</onsuccess></stage><stage stageid="60a37e65-2e62-4200-afe0-808b8b55460c" name="Resume1" type="Resume"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="195" y="630" /><onsuccess>a85a8f2b-006f-43d1-b265-8649d3f8ae6d</onsuccess></stage><stage stageid="2aa6e31d-57b7-4177-b5d9-dbc57f996f9e" name="Anchor3" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="195" y="765" w="10" h="10" /><onsuccess>23445f65-393c-4a69-8772-728e1efb053e</onsuccess></stage><stage stageid="f6882442-19d4-4c2f-a768-4a5c9113c50f" name="Anchor8" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="15" y="495" w="10" h="10" /><onsuccess>7886e238-b5ce-4502-a164-d25322cb25f5</onsuccess></stage><stage stageid="0bde0e73-8c0f-4a23-ad7d-9dcd4f4ba143" name="Set paragraphs" type="Calculation"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit onsuccess="true" /><display x="15" y="360" w="90" h="30" /><onsuccess>d17a7463-16f1-443b-8812-39314a518400</onsuccess><calculation expression="[Response Collection.analyzeResult.paragraphs]" stage="paragraphs" /></stage><stage stageid="62ee4629-ce55-41c2-b8c8-980f2c73b326" name="paragraphs" type="Block"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-45" y="330" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="7b18b17d-0380-41ca-a30b-2d6c3d509540" name="Recover1" type="Recover"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="105" y="360" /><onsuccess>1b07ba9a-e0b0-432a-b1af-50ea73b64db8</onsuccess></stage><stage stageid="1b07ba9a-e0b0-432a-b1af-50ea73b64db8" name="Resume1" type="Resume"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="195" y="360" /><onsuccess>b3f4c9c5-6d9d-4e33-a562-caa9ee461466</onsuccess></stage><stage stageid="b3f4c9c5-6d9d-4e33-a562-caa9ee461466" name="Anchor1" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="195" y="405" w="10" h="10" /><onsuccess>d17a7463-16f1-443b-8812-39314a518400</onsuccess></stage><stage stageid="d17a7463-16f1-443b-8812-39314a518400" name="Anchor2" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="15" y="405" w="10" h="10" /><onsuccess>e58d8f73-1eb1-4bd2-b2e0-f14bb32d1a4b</onsuccess></stage><stage stageid="2633583c-5951-4223-8d18-2583b88bc0e7" name="paragraphs" type="Collection"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-225" y="120" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="7886e238-b5ce-4502-a164-d25322cb25f5" name="Set styles" type="Calculation"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit onsuccess="true" /><display x="15" y="540" w="90" h="30" /><onsuccess>3f58acd0-f665-41a8-b6e3-aea92a73cc76</onsuccess><calculation expression="[Response Collection.analyzeResult.styles]" stage="styles" /></stage><stage stageid="3ea6149c-941c-4fdd-b426-113854109009" name="styles" type="Block"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-45" y="510" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="2768477a-9e9a-4e84-b4b9-ae440cf7fbf3" name="Recover1" type="Recover"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="105" y="540" /><onsuccess>71f7c396-30a2-4729-98d4-12ac60b796ef</onsuccess></stage><stage stageid="71f7c396-30a2-4729-98d4-12ac60b796ef" name="Resume1" type="Resume"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="195" y="540" /><onsuccess>3e1cc439-7086-4e3f-b8f5-2e7dca7cf5a3</onsuccess></stage><stage stageid="3e1cc439-7086-4e3f-b8f5-2e7dca7cf5a3" name="Anchor3" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="195" y="585" w="10" h="10" /><onsuccess>3f58acd0-f665-41a8-b6e3-aea92a73cc76</onsuccess></stage><stage stageid="3f58acd0-f665-41a8-b6e3-aea92a73cc76" name="Anchor8" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="15" y="585" w="10" h="10" /><onsuccess>05a846d6-c2a1-402a-aaa8-05b0c103b310</onsuccess></stage><stage stageid="c2eb709a-4739-4f0b-bc17-82a3a1317b57" name="styles" type="Collection"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-225" y="150" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="7ef1da27-d7a7-4fcf-a45a-968fc066ef9b" name="Set content" type="Calculation"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit onsuccess="true" /><display x="15" y="540" w="90" h="30" /><onsuccess>2cf3f28e-3c05-49dd-aa05-2d2490665638</onsuccess><calculation expression="[Response Collection.analyzeResult.content]" stage="content" /></stage><stage stageid="4d412262-be4a-4816-83af-bb32ea6ad90d" name="content" type="Block"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-45" y="510" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="1270a843-9976-4d20-be9d-c675ab15116c" name="Recover1" type="Recover"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="105" y="540" /><onsuccess>a8de6ecb-4db7-4a88-a63e-3531b2ea9733</onsuccess></stage><stage stageid="a8de6ecb-4db7-4a88-a63e-3531b2ea9733" name="Resume1" type="Resume"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="195" y="540" /><onsuccess>5a71458b-c613-4fe3-95d6-5de22ed8a4d2</onsuccess></stage><stage stageid="e54a0ccc-382c-4786-b5a8-22885a6ef5b4" name="Anchor4" type="Anchor"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="15" y="495" w="10" h="10" /><onsuccess>7ef1da27-d7a7-4fcf-a45a-968fc066ef9b</onsuccess></stage><stage stageid="0ff28ac4-655c-4f50-b64d-5d423edbc983" name="Anchor9" type="Anchor"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="195" y="495" w="10" h="10" /><onsuccess>e54a0ccc-382c-4786-b5a8-22885a6ef5b4</onsuccess></stage><stage stageid="e858f81c-2268-43e7-b41a-d906e5dab821" name="content" type="Data"><subsheetid>a954bb29-beee-4795-97db-d0908a1bb6e9</subsheetid><loginhibit /><display x="-225" y="120" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0ae6a183-b97d-4f3b-baec-e0b29636b2c4" name="Set content" type="Calculation"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit onsuccess="true" /><display x="15" y="540" w="90" h="30" /><onsuccess>cc1046df-d7a1-4cd2-a219-6a155b9d1be8</onsuccess><calculation expression="[Response Collection.analyzeResult.content]" stage="content" /></stage><stage stageid="af616f0e-53a0-4d9d-ace6-3f3699cdabf4" name="content" type="Block"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-45" y="510" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="13e6f682-4411-4949-a3ba-a66a1cc66714" name="Recover1" type="Recover"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="105" y="540" /><onsuccess>9703f4ed-04b8-46ef-90d0-5e444aeb6c71</onsuccess></stage><stage stageid="9703f4ed-04b8-46ef-90d0-5e444aeb6c71" name="Resume1" type="Resume"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="195" y="540" /><onsuccess>7a698768-fc78-49b1-843f-06ca9e6be273</onsuccess></stage><stage stageid="ed12dea6-0caa-44d1-9e98-7a25dd66b2e3" name="Anchor4" type="Anchor"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="15" y="495" w="10" h="10" /><onsuccess>0ae6a183-b97d-4f3b-baec-e0b29636b2c4</onsuccess></stage><stage stageid="86a20d8e-439e-47e4-9c0d-a2b1fa56929e" name="Anchor9" type="Anchor"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="195" y="495" w="10" h="10" /><onsuccess>ed12dea6-0caa-44d1-9e98-7a25dd66b2e3</onsuccess></stage><stage stageid="db4692d7-3e2a-4465-a4fa-56bd96324106" name="content" type="Data"><subsheetid>28240292-4eb5-4713-a7e0-cdd9d0941b50</subsheetid><loginhibit /><display x="-225" y="120" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b848bf09-374d-41a1-bbcd-1edad5a33851" name="Set content" type="Calculation"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="540" w="90" h="30" /><onsuccess>2efbbb11-eb0a-42de-8beb-44a79d405fca</onsuccess><calculation expression="[Response Collection.analyzeResult.content]" stage="content" /></stage><stage stageid="28033fe2-a825-45be-834a-0e74cbc84cb5" name="content" type="Block"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-45" y="510" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e8af983e-5245-4a7e-837f-efd6e8b05fa0" name="Recover1" type="Recover"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="105" y="540" /><onsuccess>46a76381-9669-4828-86c6-6adbfc51b6b0</onsuccess></stage><stage stageid="46a76381-9669-4828-86c6-6adbfc51b6b0" name="Resume1" type="Resume"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="195" y="540" /><onsuccess>d4980bfc-5346-4016-b4ea-6013b26d55c5</onsuccess></stage><stage stageid="5c901450-7ff0-409e-9fd0-09a4e9597292" name="Anchor4" type="Anchor"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="15" y="495" w="10" h="10" /><onsuccess>b848bf09-374d-41a1-bbcd-1edad5a33851</onsuccess></stage><stage stageid="3e63577f-f514-4317-90bf-80ed4e09a568" name="Anchor9" type="Anchor"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="195" y="495" w="10" h="10" /><onsuccess>5c901450-7ff0-409e-9fd0-09a4e9597292</onsuccess></stage><stage stageid="6c78d195-1fdc-4402-9441-7ca5ae0cca37" name="content" type="Data"><subsheetid>bee61c46-946f-40ee-89fc-9dfb92499f1c</subsheetid><loginhibit /><display x="-225" y="120" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="341772a7-1015-45a1-b8c3-763b215d61b6" name="Set content" type="Calculation"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit onsuccess="true" /><display x="15" y="720" w="90" h="30" /><onsuccess>23445f65-393c-4a69-8772-728e1efb053e</onsuccess><calculation expression="[Response Collection.analyzeResult.content]" stage="content" /></stage><stage stageid="1c581ba7-6e91-47ee-a833-edde15b895f5" name="content" type="Block"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="-45" y="690" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="b74141f8-a408-4ff8-b889-a414032e4800" name="Recover1" type="Recover"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="105" y="720" /><onsuccess>2de48a8c-f349-4ec2-89a1-35eb19df45dc</onsuccess></stage><stage stageid="2de48a8c-f349-4ec2-89a1-35eb19df45dc" name="Resume1" type="Resume"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="195" y="720" /><onsuccess>2aa6e31d-57b7-4177-b5d9-dbc57f996f9e</onsuccess></stage><stage stageid="36d9de52-4f10-4580-8291-9a7efd58a18d" name="Anchor4" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="15" y="675" w="10" h="10" /><onsuccess>341772a7-1015-45a1-b8c3-763b215d61b6</onsuccess></stage><stage stageid="a85a8f2b-006f-43d1-b265-8649d3f8ae6d" name="Anchor9" type="Anchor"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><loginhibit /><display x="195" y="675" w="10" h="10" /><onsuccess>36d9de52-4f10-4580-8291-9a7efd58a18d</onsuccess></stage><stage stageid="8cd28f61-3fbc-4d7e-9f2d-e3a125ae23d1" name="content" type="Data"><subsheetid>14efa442-31c1-4af3-9af8-6d7004f91701</subsheetid><display x="-345" y="150" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1a319473-29b4-484a-b452-da55e5274313" name="Anchor3" type="Anchor"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="195" y="495" w="10" h="10" /><onsuccess>6c8f2c8c-087b-42bf-a8b1-9d5db71e4ef2</onsuccess></stage><stage stageid="b698c27f-d9d6-49b1-8e31-327b3d5edb9f" name="Set styles" type="Calculation"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="540" w="90" h="30" /><onsuccess>d14a0122-baeb-41fe-be58-4bb644285a9f</onsuccess><calculation expression="[Response Collection.analyzeResult.styles]" stage="styles" /></stage><stage stageid="2df78ddd-ed33-4dcd-a375-73bd7e5a9a9e" name="styles" type="Block"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-45" y="510" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e02ba346-0a8c-4893-a15d-bc17edcd8ee4" name="Recover1" type="Recover"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="105" y="540" /><onsuccess>51c0386f-3a91-422a-8789-b9fd73ce1717</onsuccess></stage><stage stageid="51c0386f-3a91-422a-8789-b9fd73ce1717" name="Resume1" type="Resume"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="195" y="540" /><onsuccess>96422763-3742-4716-aa11-30272570e46a</onsuccess></stage><stage stageid="6c8f2c8c-087b-42bf-a8b1-9d5db71e4ef2" name="Anchor8" type="Anchor"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="15" y="495" w="10" h="10" /><onsuccess>b698c27f-d9d6-49b1-8e31-327b3d5edb9f</onsuccess></stage><stage stageid="d0843693-9650-42d9-b4fa-a60414e2e04a" name="Set content" type="Calculation"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit onsuccess="true" /><display x="15" y="630" w="90" h="30" /><onsuccess>dc06f467-9129-4adf-836c-6330e2ceb0a3</onsuccess><calculation expression="[Response Collection.analyzeResult.content]" stage="content" /></stage><stage stageid="b2339c5f-6a60-4e46-a2df-d10b29f74887" name="content" type="Block"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-45" y="600" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="c669ae64-f719-4906-8547-866b7287edd7" name="Recover1" type="Recover"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="105" y="630" /><onsuccess>49bda293-f1d0-41fa-8940-94b8cc426e39</onsuccess></stage><stage stageid="49bda293-f1d0-41fa-8940-94b8cc426e39" name="Resume1" type="Resume"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="195" y="630" /><onsuccess>972821d6-7769-4a57-8ccd-cb72d8e380b0</onsuccess></stage><stage stageid="d14a0122-baeb-41fe-be58-4bb644285a9f" name="Anchor4" type="Anchor"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="15" y="585" w="10" h="10" /><onsuccess>d0843693-9650-42d9-b4fa-a60414e2e04a</onsuccess></stage><stage stageid="96422763-3742-4716-aa11-30272570e46a" name="Anchor9" type="Anchor"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="195" y="585" w="10" h="10" /><onsuccess>d14a0122-baeb-41fe-be58-4bb644285a9f</onsuccess></stage><stage stageid="5bf3e0ed-9900-4867-92f4-aeeef57f9910" name="styles" type="Collection"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><loginhibit /><display x="-225" y="120" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="304ed971-8835-4e82-a0c1-95f337f235ef" name="content" type="Data"><subsheetid>ee057f0b-147e-4d1c-ba06-e7ba648dd78c</subsheetid><display x="-225" y="150" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage></process></object>
        <object id="6efb1579-126a-4563-b2e9-3d9e432c1a79" name="Utility - HTTP" xmlns="http://www.blueprism.co.uk/product/process"><process name="Utility - HTTP" version="6.9.0.26970" bpversion="7.1.2.3518" narrative="Communicates with web services using the HTTP protocol." byrefcollection="true" type="object" runmode="Background"><appdef><element name="Application Root"><id>2ba17e26-49eb-43ed-84dd-c40e67e990b0</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>0</camerax><cameray>-42</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="925e0261-2b2e-41ed-b555-4c5ccf8a00fc" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="d30e8f45-db72-40d2-9f17-9700006fe152" type="Normal" published="True"><name>HTTP Request</name><view><camerax>-169</camerax><cameray>132</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="74a20e65-147b-4dea-867e-fa08fbea81cb" type="Normal" published="True"><name>HTTP Request File</name><view><camerax>0</camerax><cameray>-1</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="701af150-fe0b-4f6b-a823-dc6d09569c09" type="Normal" published="True"><name>HTTP Request Multipart</name><view><camerax>-100</camerax><cameray>18</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="f3a55ad6-3bfa-4401-baa9-0e50afe42879" type="Normal" published="True"><name>Post</name><view><camerax>-3</camerax><cameray>147</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="ecff5a78-99b1-4ecb-a356-a075c487ef71" type="Normal" published="True"><name>Post JSON</name><view><camerax>-61</camerax><cameray>63</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="519a0dc7-b254-478b-b2ed-c7883124e31b" type="Normal" published="True"><name>Load Certificate</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="704436d5-f51b-4369-b763-a4fdc6e894c2" type="Normal" published="True"><name>URL Encode</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="bee831af-f964-4218-87f3-d3378e2eab10" name="Start" type="Start"><loginhibit /><display x="15" y="-105" /><onsuccess>071f13b7-de3d-4625-9498-9da634d452b4</onsuccess></stage><stage stageid="11e111be-101c-4df7-9d5c-910a10c02e2d" name="End" type="End"><loginhibit /><display x="15" y="15" /></stage><stage stageid="9c4d6f4e-1d32-4d1f-a37d-f279b42fa480" name="Stage1" type="ProcessInfo"><display x="-180" y="-90" w="180" h="120" /><references><reference>System.Data.dll</reference><reference>System.Web.dll</reference><reference>System.Xml.dll</reference><reference>System.Web.dll</reference><reference>Newtonsoft.Json.dll</reference><reference>System.Net.Http.dll</reference></references><imports><import>System</import><import>System.Net</import><import>System.Data</import><import>System.Security.Cryptography.X509Certificates</import><import>System.Collections.Generic</import><import>System.Web</import><import>System.Media</import><import>System.IO</import><import>System.Text</import><import>Newtonsoft.Json</import><import>System.Net.Http.Headers</import><import>Microsoft.VisualBasic</import></imports><language>visualbasic</language><globalcode><![CDATA[

]]></globalcode><code><![CDATA[Private m_Certificates As New Dictionary(Of String, X509Certificate2)

Private Function GetCertificate(ByVal subject As String) As X509Certificate2
	Dim store As New X509Store(StoreName.My, StoreLocation.LocalMachine)
	Try
		store.Open(OpenFlags.ReadOnly)
		Dim certs As X509Certificate2Collection = store.Certificates.Find(X509FindType.FindBySubjectName, subject, True)
		For Each cert As X509Certificate2 In certs
			Return cert
		Next
	Finally
		store.Close()
	End Try
	Return Nothing
End Function

Function ToDictionary(webResponse As HttpWebResponse ) As Dictionary(Of String, String)

	Dim dict = New Dictionary(Of String, String)()

	For index As Integer = 0 To webResponse.Headers.Count - 1

		If webResponse.Headers.Keys.Count -1 >= index Then

			dict.Add(webResponse.Headers.Keys(index), webResponse.Headers(index) )

		End if

	Next

	Return dict

End Function]]></code></stage><stage stageid="b48af877-43b3-4056-b8b4-88bac82a5c80" name="Clean Up" type="SubSheetInfo"><subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="d35cb9b6-000c-45e5-9a29-9001404a21d0" name="Start" type="Start"><subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid><loginhibit /><display x="15" y="-105" /><onsuccess>f1054fe8-46c8-42ab-b236-5b07592ec5eb</onsuccess></stage><stage stageid="f1054fe8-46c8-42ab-b236-5b07592ec5eb" name="End" type="End"><subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid><loginhibit /><display x="15" y="90" /></stage><stage stageid="ab202953-451b-4e7c-8cd5-c050e06e286a" name="Post" type="SubSheetInfo"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative>Sends a message to HTTP endpoint using the POST method. The collection data is encoded using "application/x-www-form-urlencoded"</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="e2777b38-8eba-4a04-a611-28bcd6c4add6" name="Start" type="Start"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><display x="15" y="-30" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP Post data to" stage="Address URL" /><input type="collection" name="Post Data" narrative="A collection of values to send as Post data" stage="Post Data" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" /><input type="collection" name="Headers" narrative="OPTIONAL: HTTP Headers" stage="Headers" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" stage="Accept" /><input type="flag" name="Use Bearer Token" narrative="OPTIONAL: Set this to true if you have been supplied a bearer token." stage="Use Bearer Token" /><input type="text" name="Bearer Token" narrative="OPTIONAL: The bearer token supplied for use with the destination you are working with." stage="Bearer Token" /><input type="number" name="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." stage="Request Timeout" /></inputs><onsuccess>e42b0caa-40c1-4a89-a873-f6977581053b</onsuccess></stage><stage stageid="f51a79a9-1213-484c-bedc-065f44051a02" name="End" type="End"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><display x="15" y="180" /><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Post Headers" narrative="The headers related to the Post query" stage="ResultHeadersJson" /><output type="number" name="Status Code" narrative="The HTTP status code associated with the request." stage="ResultCode" /></outputs></stage><stage stageid="14154308-012d-47e4-a707-8ca80b73651e" name="new" type="Note"><subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="4228ae7a-9bb3-4de4-9bbf-00e32d925ecf" name="new" type="Note"><narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative><display x="-180" y="90" w="180" h="230" /></stage><stage stageid="e42b0caa-40c1-4a89-a873-f6977581053b" name="Get Body" type="Code"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><display x="15" y="45" /><inputs><input type="collection" name="postData" expr="[Post Data]" /></inputs><outputs><output type="text" name="body" stage="Body" /></outputs><onsuccess>e9085eba-5f15-4b65-91ed-41abf7c6917f</onsuccess><code><![CDATA[Dim sb As New System.Text.StringBuilder
For Each r As DataRow In postData.Rows
	Dim first As Boolean = True
	For Each c As DataColumn In postData.Columns
		If first Then
			first = False
		Else
			sb.Append("&")
		End If
		Dim columnName As String = c.ColumnName
		Dim encodedCol As String = System.Web.HttpUtility.UrlEncode(columnName)
		sb.Append(encodedCol)
		sb.Append("=")
		Dim val As String = r(columnName).ToString
		Dim encodedVal As String = System.Web.HttpUtility.UrlEncode(val)
		sb.Append(encodedVal)
	Next
	Exit For 'Only one row is allowed
Next

body=sb.ToString()
]]></code></stage><stage stageid="1c58d0fb-9a9b-4d2f-861f-5c22ab835c31" name="Result" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><display x="-240" y="285" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b98abed4-9669-476c-87d9-3f485683d049" name="Address URL" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><display x="-240" y="-15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f4c2a5eb-36de-4904-a963-a8513b7e8840" name="Post Data" type="Collection"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><display x="-150" y="-15" w="90" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="071f13b7-de3d-4625-9498-9da634d452b4" name="Setup" type="Code"><loginhibit /><display x="15" y="-45" /><onsuccess>11e111be-101c-4df7-9d5c-910a10c02e2d</onsuccess><code><![CDATA[System.Net.ServicePointManager.Expect100Continue = False]]></code></stage><stage stageid="f6ed43b3-714e-4161-b44b-b60490592281" name="Proxy Password" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><display x="-150" y="45" w="90" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="bcedbed1-3ed7-42d7-8f16-7e2071c3e187" name="Proxy Username" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><display x="-240" y="45" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="66afe5b7-37e4-4ed7-a9fc-a78e1ab8890c" name="Proxy URL" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><display x="-150" y="15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="be7856fe-4027-4226-8caa-851bb6e7df21" name="Use Proxy" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><display x="-240" y="15" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="38c313e6-bc0d-49e5-a6ab-4042a0682d3d" name="Post JSON" type="SubSheetInfo"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative>Sends a message to HTTP endpoint using the POST method. The action expects a raw string and sets the content type to "application/json"</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="37166627-b66b-4a9c-a321-539933de2123" name="End" type="End"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><loginhibit /><display x="-15" y="135" /><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Result Headers" narrative="The headers related to the Post Query" stage="ResultHeadersJson" /><output type="number" name="Status Code" narrative="The HTTP status code associated with the request." stage="ResultCode" /></outputs></stage><stage stageid="878a70a1-d658-4563-b27c-245f947b74be" name="Result" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><display x="-255" y="180" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6875cda6-dbbe-47b6-ab82-b62f89c90a88" name="JSON" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><display x="-165" y="-15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4956e14f-001c-4406-a401-38c63ff06696" name="Start" type="Start"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><loginhibit /><display x="-15" y="15" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP Post data to" stage="Address URL" /><input type="text" name="JSON" narrative="The JSON to send" stage="JSON" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers Collection" stage="Headers" /><input type="flag" name="Use Bearer Token" narrative="OPTIONAL: Set to True if using a Bearer Token for Authorization" stage="Use Bearer Token" /><input type="text" name="Bearer Token" narrative="OPTIONAL: Enter bearer token value here if one has been provided." stage="Bearer Token" /><input type="number" name="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." stage="Request Timeout" /></inputs><onsuccess>6b571f09-555c-45a8-9475-957d41cafb24</onsuccess></stage><stage stageid="696696c8-af04-4075-aea0-a8024e2431fe" name="Address URL" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><display x="-255" y="-15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="582df200-7287-4dc1-a9a2-6c9e09276f77" name="Proxy Password" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><display x="-165" y="45" w="90" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="924eb1dd-b782-4f71-82b6-9923ea0093ec" name="Proxy Username" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><display x="-255" y="45" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ed09a5ed-6c7b-4dd3-9bf0-8df61da66ea3" name="Proxy URL" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><display x="-165" y="15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5e35c8d6-3f97-4ae4-8566-35fb0981e145" name="Use Proxy" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><display x="-255" y="15" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="4a9fcaf1-4310-45cb-a775-ebfadc75ac8a" name="Headers" type="Collection"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><display x="-240" y="75" w="90" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="9e64259d-1a91-444b-8620-b8cd186832d1" name="Accept" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><display x="-150" y="75" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="58e7a470-3ec3-4033-bb19-0fee1bdcaaed" name="HTTP Request" type="SubSheetInfo"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative>Sends a message to HTTP endpoint using the specified HTTP method and content-type</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="d0a11dcd-f002-46b5-aff6-1026c3be2da8" name="End" type="End"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><display x="0" y="75" /><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" narrative="The returned headers response as Json" stage="ResultHeadersJson" /><output type="number" name="Status Code" narrative="The HTTP status code associated with the request." stage="ResultCode" /></outputs></stage><stage stageid="1fa7def4-c6a8-4325-9bc8-2c6027c0b8e8" name="HTTP Request" type="Code"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><display x="0" y="0" /><inputs><input type="text" name="addressURL" expr="[Address URL]" /><input type="text" name="body" expr="[Body]" /><input type="text" name="contentType" expr="[Content Type]" /><input type="text" name="method" expr="[Method]" /><input type="text" name="proxyURL" expr="[Proxy URL]" /><input type="flag" name="useProxy" expr="[Use Proxy]" /><input type="text" name="proxyUsername" expr="[Proxy Username]" /><input type="password" name="proxyPassword" expr="[Proxy Password]" /><input type="collection" name="headers" expr="[Headers]" /><input type="text" name="accept" expr="[Accept]" /><input type="text" name="username" expr="[Username]" /><input type="password" name="password" expr="[Password]" /><input type="text" name="certID" expr="[Certificate ID]" /><input type="flag" name="forcePreAuth" expr="[Force Pre Authorization]" /><input type="flag" name="usingFile" expr="[File]" /><input type="text" name="Bearer Token" expr="[Bearer Token]" /><input type="flag" name="UseBearerToken" expr="[Use Bearer Token]" /><input type="flag" name="allowAutoRedirects" expr="[Allow Auto Redirects]" /><input type="number" name="maxRedirects" expr="[Maximum Redirects]" /><input type="number" name="requestTimeout" expr="[Request Timeout]" /></inputs><outputs><output type="text" name="resultData" stage="Result" /><output type="text" name="resultHeadersJson" stage="ResultHeadersJson" /><output type="number" name="resultCode" stage="ResultCode" /></outputs><onsuccess>d0a11dcd-f002-46b5-aff6-1026c3be2da8</onsuccess><code><![CDATA[Try
	Dim request As WebRequest = WebRequest.Create(addressURL)

	If forcePreAuth Then
	   ' Sometimes a web server will require the authorisation header in the initial request
	   ' In which case we have to add the basic authorization header manually.
	   Dim bytes() As Byte = System.Text.Encoding.UTF8.GetBytes(String.Format("{0}:{1}",username,password))
	   Dim base64 As String = Convert.ToBase64String(bytes)
	   request.Headers.Add("Authorization", "Basic " & base64)
	Else
	  If Not String.IsNullOrEmpty(username) AndAlso Not String.IsNullOrEmpty(password) Then
		request.Credentials = New NetworkCredential(username,password)
	  End If
	End If

	' Be aware that if you use forcePreAuth as well as UseBearerToken then forcePreAuth gets priority.
	If UseBearerToken And Not forcePreAuth Then
		request.Headers.Add("Authorization","Bearer " & Bearer_Token)
	End If

	If useProxy Then
		Dim proxyURI As New Uri(proxyURL)
		Dim proxy As New WebProxy(proxyURI, True)
		Dim proxyCred As New NetworkCredential(proxyUsername, proxyPassword)
		Dim credCache As New CredentialCache()
		credCache.Add(proxyURI, "Basic", proxyCred)
		proxy.UseDefaultCredentials = False
		proxy.Credentials = credCache
		request.Proxy = proxy
	End If

	' Set the request timeout. Need to see if the user specified 'Infinite' (a value of -1 according to 
	' https://docs.microsoft.com/en-us/dotnet/api/system.net.webrequest.timeout?view=net-5.0)
	If ((requestTimeout = -1) Or (requestTimeout > 0)) Then
		request.Timeout = requestTimeout
	Else 
		request.Timeout = 100000 ' Default
	End If

	request.Method = method
	request.ContentType = contentType

	Dim httpRequest As HttpWebRequest = TryCast(request, HttpWebRequest)
	If httpRequest IsNot Nothing Then
	  If Not String.IsNullOrEmpty(accept) Then
		httpRequest.Accept = accept
	  End If
	  If Not String.IsNullOrEmpty(certID) Then
		httpRequest.ClientCertificates.Add(m_Certificates(certID))
	  End If

	  ' Set the AllowAutoRedirect attribute.
	  httpRequest.AllowAutoRedirect = allowAutoRedirects
	  httpRequest.MaximumAutomaticRedirections = maxRedirects

	End If
	
    ' Copy the user-provided headers into the request headers collection.
	If Not headers Is Nothing Then
		For Each r As DataRow In headers.Rows
			For Each c As DataColumn In headers.Columns
				Dim columnName As String = c.ColumnName
				Dim val As String = r(columnName).ToString
				
				' This check ensures that we only include a single Authorization header in the request header collection.
				If Not columnName.ToUpper().Equals("AUTHORIZATION") Then
					request.Headers.Add(columnName,val)
				Else
					If Not forcePreAuth And Not UseBearerToken Then
						request.Headers.Add(columnName,val)					
					End If
				End If
			Next
			Exit For ' Only one row is allowed
		Next
	End If

	' Normal stream writer, we aren't encoding a file etc.
	If Not usingFile Then

		If Not String.IsNullOrEmpty(body) Then
		  Dim requestStream As IO.Stream = request.GetRequestStream()
		  Using sw As New IO.StreamWriter(requestStream, New Text.UTF8Encoding(False))
			sw.Write(body)
		  End Using
		End If

	Else If usingFile Then
		' Prep the request body
		Dim byteArray = File.ReadAllBytes( body )
		Dim requestStream As IO.Stream = request.GetRequestStream()
		requestStream.Write(byteArray,0, byteArray.Length)
	End If

	Using response As WebResponse = request.GetResponse()
		' Need to cast the WebResponse to an HttpWebResponse so we can get the StatusCode and check compression status.
		Dim httpResponse As HttpWebResponse = CType(response, HttpWebResponse)
		resultCode = Convert.ToInt32(httpResponse.StatusCode)

		resultHeadersJson = JsonConvert.SerializeObject(ToDictionary(response))
		Dim responseStream As IO.Stream = response.GetResponseStream()

		' Was compression used on the data?
		If (httpResponse.ContentEncoding.ToLower().Contains("gzip"))
			responseStream = New System.IO.Compression.GZipStream(responseStream, System.IO.Compression.CompressionMode.Decompress)
		ElseIf (httpResponse.ContentEncoding.ToLower().Contains("deflate"))
			responseStream = New System.IO.Compression.DeflateStream(responseStream, System.IO.Compression.CompressionMode.Decompress)            
		End If

		Dim sr As New IO.StreamReader(responseStream)
		resultData = sr.ReadToEnd()
	End Using

Catch e As WebException

	If Not e.Response Is Nothing Then

		' Cast the WebResponse to an HttpWebResponse so we can get the StatusCode
		Dim httpResponse As HttpWebResponse = CType(e.Response, HttpWebResponse)
		resultCode = Convert.ToInt32(httpResponse.StatusCode)
		
		' Get the HTTP response message.
		resultData = e.Message

	Else
		resultData = "Exception: " & e.Message
		If (e.InnerException.Message.Length > 0) Then
			resultData = resultData & vbCRLF & "Inner Exception: " + e.InnerException.Message
		End If
	End If

End Try]]></code></stage><stage stageid="96e2df5a-429a-4030-9565-b8cbbf7be6b3" name="Result" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-240" y="330" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8f28cc4e-4ae2-4b01-ad23-0b632027d627" name="Body" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-150" y="-15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e305dce1-1fd7-459b-8211-27c26350676d" name="Block1" type="Block"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><display x="-60" y="-30" w="195" h="60" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="0e0138a9-ccaa-44b1-b742-ad843c39aca1" name="Recover1" type="Recover"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><display x="75" y="0" /><onsuccess>0645751f-e202-459a-b704-5fb0e0cbebe7</onsuccess></stage><stage stageid="0645751f-e202-459a-b704-5fb0e0cbebe7" name="Exception1" type="Exception"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><display x="180" y="0" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="d8c39895-52d1-45ad-8cd0-be309896d0e5" name="Start" type="Start"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><display x="0" y="-75" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP data to" stage="Address URL" /><input type="text" name="Body" narrative="The body text of the HTTP request" stage="Body" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" /><input type="text" name="Content Type" narrative="The content type of the HTTP request." stage="Content Type" /><input type="text" name="Method" narrative="The method of the HTTP request." stage="Method" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers" stage="Headers" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" stage="Accept" /><input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" stage="Username" /><input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" stage="Password" /><input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" stage="Certificate ID" /><input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the 'Authorization' header for HTTP Basic." stage="Force Pre Authorization" /><input type="flag" name="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" stage="File" /><input type="flag" name="Use Bearer Token" stage="Use Bearer Token" /><input type="text" name="Bearer Token" narrative="OPTIONAL: If you 'Use Bearer Token' is set to True, this must be set to the value of the actual Bearer Token." stage="Bearer Token" /><input type="flag" name="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." stage="Allow Auto Redirects" /><input type="number" name="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." stage="Maximum Redirects" /><input type="number" name="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." stage="Request Timeout" /></inputs><onsuccess>1fa7def4-c6a8-4325-9bc8-2c6027c0b8e8</onsuccess></stage><stage stageid="c4e87c4e-8150-4a15-8fc5-ddc736b949ae" name="Address URL" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-240" y="-15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="038a7411-25dc-456c-8007-bb82f3d94de7" name="Proxy Password" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-150" y="135" w="90" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="8ef02e3a-8214-4163-b44d-a5081ed8b9e4" name="Proxy Username" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-240" y="135" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1c6f3a8d-428e-4a61-815c-f32a8a117ae3" name="Proxy URL" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-150" y="105" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5c4cc5f6-0531-4375-b9c1-3fcb529dde9b" name="Use Proxy" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-240" y="105" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="4a98d0d5-c3b8-42fb-933f-2168265f12d6" name="Content Type" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-240" y="15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="fc9f21c4-39ba-4135-8356-f9a516bf6b99" name="Method" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-150" y="15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6b571f09-555c-45a8-9475-957d41cafb24" name="HTTP Request" type="SubSheet"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><loginhibit /><display x="-15" y="75" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP data to" expr="[Address URL]" /><input type="text" name="Body" narrative="The body text of the HTTP request" expr="[JSON]" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" expr="[Use Proxy]" /><input type="text" name="Content Type" narrative="The content type of the HTTP request." expr="&quot;application/json&quot;" /><input type="text" name="Method" narrative="The method of the HTTP request." expr="&quot;POST&quot;" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" expr="[Proxy URL]" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" expr="[Proxy Username]" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" expr="[Proxy Password]" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers" expr="[Headers]" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="" /><input type="flag" name="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" narrative="OPTIONAL: If you need bearer token authorization set this to true." expr="[Use Bearer Token]" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you have a bearer token and need to use authorization" expr="[Bearer Token]" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="[Request Timeout]" /></inputs><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" narrative="The returned headers response as Json" stage="ResultHeadersJson" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="ResultCode" /></outputs><onsuccess>37166627-b66b-4a9c-a321-539933de2123</onsuccess><processid>d30e8f45-db72-40d2-9f17-9700006fe152</processid></stage><stage stageid="33b3447c-a55e-4af3-be35-6cb5624d6a4f" name="Headers" type="Collection"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-240" y="45" w="90" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="ac16a164-f018-4111-949f-3db9d4d873d9" name="Accept" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-150" y="45" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="23c8dd77-277a-4aac-8df7-31c951626abd" name="Body" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><display x="-195" y="210" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e9085eba-5f15-4b65-91ed-41abf7c6917f" name="HTTP Request" type="SubSheet"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><display x="15" y="120" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP data to" expr="[Address URL]" /><input type="text" name="Body" narrative="The body text of the HTTP request" expr="[Body]" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" expr="[Use Proxy]" /><input type="text" name="Content Type" narrative="The content type of the HTTP request." expr="&quot;application/x-www-form-urlencoded&quot;" /><input type="text" name="Method" narrative="The method of the HTTP request." expr="&quot;POST&quot;" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" expr="[Proxy URL]" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" expr="[Proxy Username]" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" expr="[Proxy Password]" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers" expr="[Headers]" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" expr="[Accept]" /><input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="" /><input type="flag" name="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" /><input type="flag" name="Use Bearer Token" friendlyname="Use Bearer Token" narrative="OPTIONAL: If you need bearer token authorization set this to true." expr="[Use Bearer Token]" /><input type="text" name="Bearer Token" friendlyname="Bearer Token" narrative="OPTIONAL: If you have a bearer token and need to use authorization" expr="[Bearer Token]" /><input type="flag" name="Allow Auto Redirects" friendlyname="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." expr="" /><input type="number" name="Maximum Redirects" friendlyname="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." expr="" /><input type="number" name="Request Timeout" friendlyname="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." expr="[Request Timeout]" /></inputs><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" narrative="The returned headers response as Json" stage="ResultHeadersJson" /><output type="number" name="Status Code" friendlyname="Status Code" narrative="The HTTP status code associated with the request." stage="ResultCode" /></outputs><onsuccess>f51a79a9-1213-484c-bedc-065f44051a02</onsuccess><processid>d30e8f45-db72-40d2-9f17-9700006fe152</processid></stage><stage stageid="4bd01e67-49a4-4082-be0d-df1bb9cecb13" name="Username" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-240" y="165" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="dac70b0c-83cb-4605-8f7b-d1d8d21922d3" name="Password" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-150" y="165" w="90" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="9091a189-b87b-4ed7-9747-1e1e9fe657f6" name="Load Certificate" type="SubSheetInfo"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><narrative>This action loads an X.509 certificate from a file and returns the certificate ID.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="3cff8803-c15f-4ab4-a032-d0afb9fa20ae" name="Start" type="Start"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="Filename" narrative="OPTIONAL: The full path to a file containing the certificate" stage="Filename" /><input type="text" name="Subject" narrative="OPTIONAL: The subject of the certificate if loading from the store" stage="Subject" /><input type="password" name="Password" narrative="OPTIONAL: The password to load the certificate if needed" stage="Password" /></inputs><onsuccess>8962b858-f6e2-413c-9ceb-3d80dee88de2</onsuccess></stage><stage stageid="17fddf56-07f2-4942-8515-e1b183458a7f" name="End" type="End"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><display x="15" y="15" /><outputs><output type="text" name="Certificate ID" narrative="The ID of the certificate" stage="Certificate ID" /></outputs></stage><stage stageid="e9b8de2b-8e54-4772-b186-046ca262c94c" name="Filename" type="Data"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><display x="-240" y="-15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5f0ec822-a1c0-4b6b-91ba-739b0b2762b8" name="Subject" type="Data"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><display x="-150" y="-15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8962b858-f6e2-413c-9ceb-3d80dee88de2" name="Load" type="Code"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><display x="15" y="-45" /><inputs><input type="text" name="filename" expr="[Filename]" /><input type="password" name="password" expr="[Password]" /><input type="text" name="subject" expr="[Subject]" /></inputs><outputs><output type="text" name="thumbprint" stage="Certificate ID" /></outputs><onsuccess>17fddf56-07f2-4942-8515-e1b183458a7f</onsuccess><code><![CDATA[Dim cert As X509Certificate2 = Nothing
If Not String.IsNullOrEmpty(filename) Then
  cert = New X509Certificate2(filename,password)
End If

If Not String.IsNullOrEmpty(subject) Then
  cert=GetCertificate(subject)
End If

thumbprint = cert.Thumbprint
m_Certificates.Add(thumbprint,cert)
]]></code></stage><stage stageid="745e7557-7761-4078-8ff7-334b6873f126" name="Certificate ID" type="Data"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><display x="-195" y="105" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="471ae54f-286f-4472-b48c-114fc7d04bf9" name="Password" type="Data"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><display x="-240" y="30" w="90" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="452476e7-b29f-4e5f-999a-c67789bbb0db" name="Certificate ID" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-240" y="195" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5de144f5-aa91-46e0-8f9c-ac8495d2ab0c" name="Force Pre Authorization" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-240" y="75" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="c83483da-e145-4802-8407-a40cf74fc86a" name="URL Encode" type="SubSheetInfo"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><narrative>This action provides the ability to encode a URL. URL encoding converts characters that are not allowed in a URL into character-entity equivalents. For example, when the characters &lt; and &gt; are embedded in a URL, they are encoded as %3c and %3e.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="f640efd4-cb34-48ee-b07d-de356b07b09b" name="Start" type="Start"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><loginhibit /><display x="15" y="-120" /><inputs><input type="text" name="URL" narrative="The URL to encode" stage="URL" /></inputs><onsuccess>d0c241bd-a746-44fc-9fdd-5f73a4c55bf9</onsuccess></stage><stage stageid="0d4cffb2-879f-49d1-b815-43da8446a39c" name="End" type="End"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><loginhibit /><display x="15" y="30" /><outputs><output type="text" name="URL" narrative="The encoded URL" stage="URL" /></outputs></stage><stage stageid="d0c241bd-a746-44fc-9fdd-5f73a4c55bf9" name="Encode URL" type="Code"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><loginhibit /><display x="15" y="-45" /><inputs><input type="text" name="URL" expr="[URL]" /></inputs><outputs><output type="text" name="Encoded URL" stage="URL" /></outputs><onsuccess>0d4cffb2-879f-49d1-b815-43da8446a39c</onsuccess><code><![CDATA[
Encoded_URL = HttpUtility.UrlEncode( URL )]]></code></stage><stage stageid="7a1cd30a-feef-4786-89fd-cf1838f4dfaa" name="URL" type="Data"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><display x="-195" y="-15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e627cc07-7d3a-40bd-a02a-0a2952f079d0" name="Headers" type="Collection"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><display x="-255" y="75" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="FF6600" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="495a88d6-260c-4b89-a04c-64a12af7b759" name="File" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-150" y="75" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="765d4221-5509-4c70-97c4-a946b7d3d186" name="ResultHeadersJson" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-150" y="330" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ea993d2e-35df-484b-9c46-a2d69a172ceb" name="ResultHeadersJson" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><display x="-165" y="180" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="031e4c4f-fa80-4e54-b2ab-847483e49414" name="ResultHeadersJson" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><display x="-150" y="285" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="caabb2b2-6772-4932-8ad6-0695d1a170d9" name="Inputs" type="Block"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><display x="-300" y="-45" w="210" h="210" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="ae023e33-e349-4bf0-80e0-7e3794a1dbc2" name="Protected Variables" type="Block"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><display x="-300" y="180" w="210" h="60" /><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="76b976d1-2b36-4ea6-8c01-04fa5ea31f20" name="Outputs" type="Block"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><display x="-300" y="255" w="210" h="90" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="4b809006-50ee-41b3-b1db-2bc0165f895f" name="Inputs" type="Block"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><loginhibit /><display x="-315" y="-45" w="210" h="180" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="2e4c34da-85e1-4b3d-86a2-de7a6b10fcf6" name="Outputs" type="Block"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><loginhibit /><display x="-315" y="150" w="210" h="105" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="cad4106c-2c71-48d0-960d-4d2c78a91eff" name="Inputs" type="Block"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><display x="-300" y="-45" w="210" h="330" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="a42642fa-1d93-42e4-942a-cb7a7087efef" name="Outputs" type="Block"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><display x="-300" y="300" w="210" h="90" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="4a325f2f-9650-490c-b4bb-61928ef10e68" name="Inputs" type="Block"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><display x="-300" y="-45" w="210" h="105" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="67c03883-48e2-4ef1-8e3a-98ca0652e901" name="Outputs" type="Block"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><display x="-300" y="75" w="210" h="60" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="1d4b7d60-b4f9-48d1-8e90-6759e1bfc573" name="Input / Output" type="Block"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><loginhibit /><display x="-270" y="-45" w="150" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="161716ff-18e8-4dd0-8005-b4955791a4de" name="HTTP Request File" type="SubSheetInfo"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><narrative>Sends a message to HTTP endpoint using the specified HTTP method and content-type and receives the binary response.</narrative><display x="-195" y="-150" w="150" h="90" /></stage><stage stageid="18d7e0ce-f7cc-47fd-8172-4bca401593ae" name="End" type="End"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><loginhibit /><display x="15" y="45" /><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" narrative="The returned headers response as Json" stage="ResultHeadersJson" /><output type="number" name="Status Code" narrative="The HTTP status code associated with the request." stage="ResultCode" /></outputs></stage><stage stageid="00fb6208-ae39-4f9d-92d7-a336172eff1e" name="HTTP Request File" type="Code"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><loginhibit /><narrative>Use this action to request binary files (ex. PDF) over HTTP.</narrative><display x="15" y="-30" /><inputs><input type="text" name="addressURL" expr="[Address URL]" /><input type="text" name="body" expr="[Body]" /><input type="text" name="contentType" expr="[Content Type]" /><input type="text" name="method" expr="[Method]" /><input type="text" name="proxyURL" expr="[Proxy URL]" /><input type="flag" name="useProxy" expr="[Use Proxy]" /><input type="text" name="proxyUsername" expr="[Proxy Username]" /><input type="password" name="proxyPassword" expr="[Proxy Password]" /><input type="collection" name="headers" expr="[Headers]" /><input type="text" name="accept" expr="[Accept]" /><input type="text" name="username" expr="[Username]" /><input type="password" name="password" expr="[Password]" /><input type="text" name="certID" expr="[Certificate ID]" /><input type="flag" name="forcePreAuth" expr="[Force Pre Authorization]" /><input type="flag" name="usingFile" expr="[File]" /><input type="text" name="FilePath" expr="[FilePath]" /><input type="flag" name="Use Bearer Token" expr="[Use Bearer Token]" /><input type="text" name="Bearer Token" expr="[Bearer Token]" /><input type="flag" name="allowAutoRedirects" expr="[Allow Auto Redirects]" /><input type="number" name="maxRedirects" expr="[Maximum Redirects]" /><input type="number" name="requestTimeout" expr="[Request Timeout]" /></inputs><outputs><output type="text" name="resultData" stage="Result" /><output type="text" name="resultHeadersJson" stage="ResultHeadersJson" /><output type="number" name="resultCode" stage="ResultCode" /></outputs><onsuccess>18d7e0ce-f7cc-47fd-8172-4bca401593ae</onsuccess><code><![CDATA[Try
	Dim request As WebRequest = WebRequest.Create(addressURL)

	If forcePreAuth Then
	   ' Sometimes a web server will require the authorisation header in the initial request
	   ' In which case we have to add the basic authorization header manually.
	   Dim bytes() As Byte = System.Text.Encoding.UTF8.GetBytes(String.Format("{0}:{1}",username,password))
	   Dim base64 As String = Convert.ToBase64String(bytes)
	   request.Headers.Add("Authorization", "Basic " & base64)
	Else
	  If Not String.IsNullOrEmpty(username) AndAlso Not String.IsNullOrEmpty(password) Then
		request.Credentials = New NetworkCredential(username,password)
	  End If
	End If

    ' Be aware that if you use forcePreAuth as well as UseBearerToken then forcePreAuth gets priority.
	If Use_Bearer_Token And Not forcePreAuth Then
		request.Headers.Add("Authorization","Bearer " & Bearer_Token)
	End If

	If useProxy Then
		Dim proxyURI As New Uri(proxyURL)
		Dim proxy As New WebProxy(proxyURI, True)
		Dim proxyCred As New NetworkCredential(proxyUsername, proxyPassword)
		Dim credCache As New CredentialCache()
		credCache.Add(proxyURI, "Basic", proxyCred)
		proxy.UseDefaultCredentials = False
		proxy.Credentials = credCache
		request.Proxy = proxy
	End If

	' Set the request timeout. Need to see if the user specified 'Infinite' (a value of -1 according to 
	' https://docs.microsoft.com/en-us/dotnet/api/system.net.webrequest.timeout?view=net-5.0)
	If ((requestTimeout = -1) Or (requestTimeout > 0)) Then
		request.Timeout = requestTimeout
	Else 
		request.Timeout = 100000 ' Default
	End If

	request.Method = method
	request.ContentType = contentType

	Dim httpRequest As HttpWebRequest = TryCast(request, HttpWebRequest)
	If httpRequest IsNot Nothing Then
	  If Not String.IsNullOrEmpty(accept) Then
		httpRequest.Accept = accept
	  End If
	  If Not String.IsNullOrEmpty(certID) Then
		httpRequest.ClientCertificates.Add(m_Certificates(certID))
	  End If

	  ' Set the AllowAutoRedirect attribute.
	  httpRequest.AllowAutoRedirect = allowAutoRedirects
	  httpRequest.MaximumAutomaticRedirections = maxRedirects

	End If

	For Each r As DataRow In headers.Rows
		For Each c As DataColumn In headers.Columns
			Dim columnName As String = c.ColumnName
			Dim val As String = r(columnName).ToString

			' This check ensures that we only include a single Authorization header in the request header collection.
			If Not columnName.ToUpper().Equals("AUTHORIZATION") Then
				request.Headers.Add(columnName,val)
			Else
				If Not forcePreAuth And Not Use_Bearer_Token Then
					request.Headers.Add(columnName,val)					
				End If
			End If
		Next
		Exit For ' Only one row is allowed
	Next

	' Normal stream writer, we aren't encoding a file etc.
	If Not usingFile Then

		If Not String.IsNullOrEmpty(body) Then
		  Dim requestStream As IO.Stream = request.GetRequestStream()
		  Using sw As New IO.StreamWriter(requestStream, New Text.UTF8Encoding(False))
			sw.Write(body)
		  End Using
		End If

	Else If usingFile Then
		' Prep the request body
		Dim byteArray = File.ReadAllBytes( body )
		Dim requestStream As IO.Stream = request.GetRequestStream()
		requestStream.Write(byteArray,0, byteArray.Length)
	End If

	Using response As WebResponse = request.GetResponse()
		' Need to cast the WebResponse to an HttpWebResponse so we can get the StatusCode and check to see if compression was used.
		Dim httpResponse As HttpWebResponse = CType(response, HttpWebResponse)
		resultCode = Convert.ToInt32(httpResponse.StatusCode)

		resultHeadersJson = JsonConvert.SerializeObject(ToDictionary(response))
		Dim responseStream As IO.Stream = response.GetResponseStream()
        Dim lWriter As New IO.FileStream(FilePath, IO.FileMode.Create)

		' Was compression used on the data?
		If (httpResponse.ContentEncoding.ToLower().Contains("gzip"))
			responseStream = New System.IO.Compression.GZipStream(responseStream, System.IO.Compression.CompressionMode.Decompress)
		ElseIf (httpResponse.ContentEncoding.ToLower().Contains("deflate"))
			responseStream = New System.IO.Compression.DeflateStream(responseStream, System.IO.Compression.CompressionMode.Decompress)            
		End If

		Dim lLength As Long
		Dim lBytes(256) As Byte

		Do
			lLength = responseStream.Read(lBytes, 0, lBytes.Length)
			lWriter.Write(lBytes, 0, lLength)
		Loop While lLength > 0

		lWriter.Close()
		responseStream.Close()

		resultData = "done"

	End Using

Catch e As WebException

	If Not e.Response Is Nothing Then

		' Cast the WebResponse to an HttpWebResponse so we can get the StatusCode
		Dim httpResponse As HttpWebResponse = CType(e.Response, HttpWebResponse)
		resultCode = Convert.ToInt32(httpResponse.StatusCode)
		
		' Get the HTTP response message.
		resultData = e.Message

	Else
		resultData = "Exception: " & e.Message
		If (e.InnerException.Message.Length > 0) Then
			resultData = resultData & vbCRLF & "Inner Exception: " & e.InnerException.Message
		End If
	End If

End Try]]></code></stage><stage stageid="170b9d76-a47e-4df2-97a6-9ddfbc95078b" name="Result" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-210" y="330" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bb727f57-eba7-4393-a5c0-5be33be37d80" name="Body" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-135" y="-45" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="995fdfcf-58d1-4097-8f13-7d6badc2f4a3" name="Block1" type="Block"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><loginhibit /><display x="-30" y="-60" w="180" h="60" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="34f43df2-1204-4bc2-b250-f2840e842d0f" name="Recover1" type="Recover"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><loginhibit /><display x="105" y="-30" /><onsuccess>910ea143-a909-4eca-a5e6-4c2142b95720</onsuccess></stage><stage stageid="910ea143-a909-4eca-a5e6-4c2142b95720" name="Exception1" type="Exception"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><loginhibit /><display x="210" y="-30" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="bc43a2e3-432a-467a-812d-4ccb88a62b02" name="Start" type="Start"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP data to" stage="Address URL" /><input type="text" name="Body" narrative="The body text of the HTTP request" stage="Body" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" /><input type="text" name="Content Type" narrative="The content type of the HTTP request." stage="Content Type" /><input type="text" name="Method" narrative="The method of the HTTP request." stage="Method" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers" stage="Headers" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" stage="Accept" /><input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" stage="Username" /><input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" stage="Password" /><input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" stage="Certificate ID" /><input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" stage="Force Pre Authorization" /><input type="flag" name="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" stage="File" /><input type="text" name="FilePath" narrative="OPTIONAL: If requesting a binary file (ex. PDF) set this to the path and file name where the file should be saved. NOTE: File name should include the file extension." stage="FilePath" /><input type="flag" name="Use Bearer Token" stage="Use Bearer Token" /><input type="text" name="Bearer Token" narrative="OPTIONAL: Enter bearer token value here if one has been provided. " stage="Bearer Token" /><input type="flag" name="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." stage="Allow Auto Redirects" /><input type="number" name="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." stage="Maximum Redirects" /><input type="number" name="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." stage="Request Timeout" /></inputs><onsuccess>00fb6208-ae39-4f9d-92d7-a336172eff1e</onsuccess></stage><stage stageid="e8540bec-f19c-4797-b6cb-aba944384ca1" name="Address URL" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-225" y="-45" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9f90b8e6-1112-4012-bbc5-92805ffd869d" name="Proxy Password" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-135" y="105" w="90" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="dcfc84d2-6734-4a0d-98f7-c911c33335a3" name="Proxy Username" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-225" y="105" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="05c0b4f2-a550-41da-bad4-1f5ba7f34716" name="Proxy URL" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-135" y="75" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d510d39e-2e3f-4737-8e0c-2783c2bd7e08" name="Use Proxy" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-225" y="75" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="5ad50174-fbe1-4847-8f57-6e02ffe66bcb" name="Content Type" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-225" y="-15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="26446a3f-6b6d-4cbe-b594-acc849fbc4d6" name="Method" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-135" y="-15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e9e08346-5eda-4e77-9567-f5c5c7a3a093" name="Headers" type="Collection"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-225" y="15" w="90" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="70903a73-74d7-4d6a-9228-9cf2bdc8e28c" name="Accept" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-135" y="15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="45f3c763-f7cb-406e-a52f-c07238826e1f" name="Username" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-225" y="135" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="62706f83-ea14-4c02-a49f-85ae54dd685f" name="Password" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-135" y="135" w="90" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="e4445dd3-ea80-4a41-bd03-7b7254fbf6db" name="Certificate ID" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-225" y="165" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a0ed3881-bfbe-4dab-aab1-207853314195" name="Force Pre Authorization" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-225" y="45" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="13306d41-fcb6-4cc2-8efc-09e808bd5b60" name="File" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-135" y="45" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="94762f9b-44d9-4432-a791-36066057437e" name="ResultHeadersJson" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-135" y="330" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1aefb8da-ea0d-4243-9682-014d7ebbdad9" name="Inputs" type="Block"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><loginhibit /><display x="-285" y="-75" w="210" h="360" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="dd3bc439-ff26-4457-876e-06b3b8139364" name="Outputs" type="Block"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><loginhibit /><display x="-285" y="300" w="210" h="105" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="722458e4-71be-48d2-a1f2-6f6f5d1f01e1" name="FilePath" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><loginhibit /><display x="-135" y="165" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="627ac30e-2106-4780-aa1b-013fa8cd671d" name="Note2" type="Note"><narrative>© 2022 Blue Prism Limited
Licensed under the Blue Prism Asset License and Support Terms
https://digitalexchange.blueprism.com/fileMedia/download/a9111324-3192-43ff-9166-566620ca1182</narrative><display x="240" y="-15" w="300" h="90" /><font family="Segoe UI" size="12" style="Regular" color="0000FF" /></stage><stage stageid="fd79fc43-be32-4457-abf6-08993c1bc0ec" name="Block1" type="Block"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><display x="-45" y="15" w="195" h="60" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="d30b7a5b-599a-4875-a432-762079b25e61" name="Recover1" type="Recover"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><display x="90" y="45" /><onsuccess>5d022479-efd0-49fa-8743-5b3b1c53fac1</onsuccess></stage><stage stageid="5d022479-efd0-49fa-8743-5b3b1c53fac1" name="Exception1" type="Exception"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><display x="195" y="45" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="e13740fe-13bd-41cd-9d8e-7a1bfcc9739f" name="Block1" type="Block"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><display x="-30" y="-75" w="180" h="60" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="a938783d-2fd8-441f-ae6c-689921e1d1f6" name="Recover1" type="Recover"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><display x="105" y="-45" /><onsuccess>7a1733ba-d4c4-4d6f-a601-8be80f4f9491</onsuccess></stage><stage stageid="7a1733ba-d4c4-4d6f-a601-8be80f4f9491" name="Exception1" type="Exception"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><display x="210" y="-45" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="91934b81-a8b6-4f29-8aa9-3b738e9d53da" name="Block1" type="Block"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><loginhibit /><display x="-45" y="-75" w="180" h="60" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e8388e84-a3ff-407e-8997-1c708c4e18c9" name="Recover1" type="Recover"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><loginhibit /><display x="90" y="-45" /><onsuccess>06948128-c0df-4c96-84ac-2fa362ff3e4d</onsuccess></stage><stage stageid="06948128-c0df-4c96-84ac-2fa362ff3e4d" name="Exception1" type="Exception"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><loginhibit /><display x="195" y="-45" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="3509042f-2bb3-41c4-9b2e-0c3e3dba0b41" name="ResultCode" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-240" y="360" w="90" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a2685e68-661c-4e2e-a9c2-4fb8eed23bf2" name="ResultCode" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><display x="-240" y="315" w="90" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d59c1284-70d5-46c0-ae05-77e776b685b9" name="ResultCode" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><display x="-255" y="225" w="90" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="89150ecf-1822-47a1-905e-e7d1b49b9ed8" name="ResultCode" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-210" y="375" w="90" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4cc1b3b6-1b93-49d1-b5e1-a5dc0e638c79" name="Bearer Token" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><display x="-150" y="225" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a66aa3f4-5be4-4b29-89e7-0d6d6290a959" name="Use Bearer Token" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-240" y="225" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="d5dbfc7e-9901-49fd-b89b-add521619228" name="Note1" type="Note"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><narrative>Force Pre Authorization - Make sure that this isn't used with Use Bearer Token. Only one Authorization header is needed.

Headers Collection - If you use Use Bearer Token, make sure that this collection doesn't contain an Authorization header.

Use Bearer Token is not configured to work using a Proxy.</narrative><display x="-495" y="60" w="330" h="210" /><font family="Segoe UI" size="14" style="Regular" color="FF0000" /></stage><stage stageid="83c65d81-f13a-4c5c-bfcb-4b96df052746" name="Bearer Token" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><display x="-150" y="105" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d31ae653-1789-4539-9ddb-15301d438d16" name="Use Bearer Token" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><display x="-240" y="105" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="efaa6f7c-43f9-4c18-aa5c-5cd3f3506386" name="Use Bearer Token" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><display x="-255" y="105" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="e39cecbe-6abc-430a-b5c2-7281e57af9af" name="Bearer Token" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><display x="-165" y="105" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="28f476b7-37b6-4e88-93ad-d4a1b1e289f0" name="Use Bearer Token" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-225" y="195" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="a1f6da3d-53c9-44b3-8489-e6db32ace249" name="Bearer Token" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-135" y="195" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="db3476b1-7e22-44fa-94ea-22a3292b2866" name="Note3" type="Note"><loginhibit /><narrative>Version: 10.0</narrative><display x="15" y="-195" w="120" h="30" /><font family="Segoe UI" size="14" style="Bold" color="FF0000" /></stage><stage stageid="585a3401-d73c-4b6c-a098-15337afed881" name="HTTP Request Multipart" type="SubSheetInfo"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><narrative>Sends a message to HTTP endpoint using the POST HTTP method with multipart as the content-type.</narrative><display x="-180" y="-135" w="150" h="90" /></stage><stage stageid="3adec6c2-46c0-4bd4-ab34-03908e5a7d5c" name="End" type="End"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><loginhibit /><display x="15" y="45" /><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" narrative="The returned headers response as Json" stage="ResultHeadersJson" /><output type="number" name="Status Code" narrative="The HTTP status code associated with the request." stage="ResultCode" /></outputs></stage><stage stageid="32a4e0a5-1366-40aa-9519-e62142789499" name="HTTP Request Multipart" type="Code"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><loginhibit /><narrative>Sends a multipart HTTP request</narrative><display x="15" y="-30" /><inputs><input type="text" name="addressURL" expr="[Address URL]" /><input type="text" name="proxyURL" expr="[Proxy URL]" /><input type="flag" name="useProxy" expr="[Use Proxy]" /><input type="text" name="proxyUsername" expr="[Proxy Username]" /><input type="password" name="proxyPassword" expr="[Proxy Password]" /><input type="collection" name="headers" expr="[Headers]" /><input type="text" name="accept" expr="[Accept]" /><input type="text" name="username" expr="[Username]" /><input type="password" name="password" expr="[Password]" /><input type="text" name="certID" expr="[Certificate ID]" /><input type="flag" name="forcePreAuth" expr="[Force Pre Authorization]" /><input type="text" name="Bearer Token" expr="[Bearer Token]" /><input type="flag" name="UseBearerToken" expr="[Use Bearer Token]" /><input type="collection" name="FileMetadata" expr="[FileMetadata]" /><input type="collection" name="FieldMetadata" expr="[FieldMetadata]" /><input type="flag" name="allowAutoRedirects" expr="[Allow Auto Redirects]" /><input type="number" name="maxRedirects" expr="[Maximum Redirects]" /><input type="number" name="requestTimeout" expr="[Request Timeout]" /></inputs><outputs><output type="text" name="resultData" stage="Result" /><output type="text" name="resultHeadersJson" stage="ResultHeadersJson" /><output type="number" name="resultCode" stage="ResultCode" /></outputs><onsuccess>3adec6c2-46c0-4bd4-ab34-03908e5a7d5c</onsuccess><code><![CDATA[Try
	Dim request As WebRequest = WebRequest.Create(addressURL)
	Dim boundary As String = "boundaryboundary"
    Dim boundaryBytes As Byte() = System.Text.Encoding.ASCII.GetBytes(vbCrLf & "--" & boundary & vbCrLf)

	' Set the request timeout. Need to see if the user specified 'Infinite' (a value of -1 according to 
	' https://docs.microsoft.com/en-us/dotnet/api/system.net.webrequest.timeout?view=net-5.0)
	If ((requestTimeout = -1) Or (requestTimeout > 0)) Then
		request.Timeout = requestTimeout
	Else 
		request.Timeout = 100000 ' Default
	End If

	If forcePreAuth Then
	   ' Sometimes a web server will require the authorisation header in the initial request
	   ' In which case we have to add the basic authorization header manually.
	   Dim bytes() As Byte = System.Text.Encoding.UTF8.GetBytes(String.Format("{0}:{1}",username,password))
	   Dim base64 As String = Convert.ToBase64String(bytes)
	   request.Headers.Add("Authorization", "Basic " & base64)
	Else
	  If Not String.IsNullOrEmpty(username) AndAlso Not String.IsNullOrEmpty(password) Then
		request.Credentials = New NetworkCredential(username,password)
	  End If
	End If

	' Be aware that if you use forcePreAuth as well as UseBearerToken then forcePreAuth gets priority.
	If UseBearerToken And Not forcePreAuth Then
		request.Headers.Add("Authorization","Bearer " & Bearer_Token)
	End If

	If useProxy Then
		Dim proxyURI As New Uri(proxyURL)
		Dim proxy As New WebProxy(proxyURI, True)
		Dim proxyCred As New NetworkCredential(proxyUsername, proxyPassword)
		Dim credCache As New CredentialCache()
		credCache.Add(proxyURI, "Basic", proxyCred)
		proxy.UseDefaultCredentials = False
		proxy.Credentials = credCache
		request.Proxy = proxy
	End If

	request.Method = "POST"
	request.ContentType = "multipart/form-data; boundary=" + boundary

	Dim httpRequest As HttpWebRequest = TryCast(request, HttpWebRequest)
	If httpRequest IsNot Nothing Then
	  If Not String.IsNullOrEmpty(accept) Then
		httpRequest.Accept = accept
	  End If
	  If Not String.IsNullOrEmpty(certID) Then
		httpRequest.ClientCertificates.Add(m_Certificates(certID))
	  End If
	End If

	' Set the AllowAutoRedirect attribute.
	httpRequest.AllowAutoRedirect = allowAutoRedirects
	httpRequest.MaximumAutomaticRedirections = maxRedirects

    ' Make sure that if you use UseBearerToken check that the Headers parameter doesn't have an Authorization entry.
	If Not headers Is Nothing Then
		For Each r As DataRow In headers.Rows
			For Each c As DataColumn In headers.Columns
				Dim columnName As String = c.ColumnName
				Dim val As String = r(columnName).ToString
				
				' This check ensures that we only include a single Authorization header in the request header collection.
				If Not columnName.ToUpper().Equals("AUTHORIZATION") Then
					request.Headers.Add(columnName,val)
				Else
					If Not forcePreAuth And Not UseBearerToken Then
						request.Headers.Add(columnName,val)					
					End If
				End If
			Next
			Exit For ' Only one row is allowed
		Next
	End If

	Dim requestStream As IO.Stream = request.GetRequestStream()

	Dim FileName As String
	Dim FieldName As String
	Dim ContentType As String

	' Add the Field Metadata to the request body first.
	For Each fieldData As DataRow In FieldMetadata.Rows
	
		requestStream.Write(boundaryBytes, 0, boundaryBytes.Length)

		Dim Data As String = "Content-Disposition: form-data; name=""" & fieldData.Item("Name") & """" & vbCrLf & vbCrLf & fieldData.Item("Value")
		Dim DataBytes As Byte() = System.Text.Encoding.UTF8.GetBytes(Data)
		requestStream.Write(DataBytes, 0, DataBytes.Length)

	Next

	' Now add the various files to the body.
    For Each fileData As DataRow In FileMetadata.Rows
		
		'Start of multipart boundary
		requestStream.Write(boundaryBytes, 0, boundaryBytes.Length)

		If fileData.Item("FieldName")="" Then 
		FieldName="file" 
		Else FieldName=fileData.Item("FieldName") 
		End If

		If fileData.Item("FileName")="" Then 
		FileName=Path.GetFileName(fileData.Item("filepath"))
		Else FileName=fileData.Item("FileName") 
		End If

		If fileData.Item("ContentType")="" Then 
		ContentType=MimeMapping.GetMimeMapping(Path.GetFileName(fileData.Item("filepath")))
		Else ContentType=fileData.Item("ContentType") 
		End If

		Dim header As String = "Content-Disposition: form-data; name=""" & FieldName & """; filename=""" & FileName & """" & vbCrLf & "Content-Type: " + ContentType & vbCrLf & vbCrLf
		Dim bytes As Byte() = System.Text.Encoding.UTF8.GetBytes(header)
		requestStream.Write(bytes, 0, bytes.Length)
    	
		Dim bytesRead = File.ReadAllBytes(fileData.Item("FilePath"))
        	requestStream.Write(bytesRead, 0, bytesRead.Length)

	Next

	'End of multipart boundary
	Dim trailer As Byte() = System.Text.Encoding.ASCII.GetBytes(vbCrLf & "--" & boundary & "--" & vbCrLf)
    requestStream.Write(trailer, 0, trailer.Length)
    requestStream.Close()

	Using response As WebResponse = request.GetResponse()
		' Need to cast the WebResponse to an HttpWebResponse so we can get the StatusCode and check to see if compression was used.
		Dim httpResponse As HttpWebResponse = CType(response, HttpWebResponse)
		resultCode = Convert.ToInt32(httpResponse.StatusCode)

		resultHeadersJson = JsonConvert.SerializeObject(ToDictionary(response))
		Dim responseStream As IO.Stream = response.GetResponseStream()

		' Was compression used on the data?
		If (httpResponse.ContentEncoding.ToLower().Contains("gzip"))
			responseStream = New System.IO.Compression.GZipStream(responseStream, System.IO.Compression.CompressionMode.Decompress)
		ElseIf (httpResponse.ContentEncoding.ToLower().Contains("deflate"))
			responseStream = New System.IO.Compression.DeflateStream(responseStream, System.IO.Compression.CompressionMode.Decompress)            
		End If

		Dim sr As New IO.StreamReader(responseStream)
		resultData = sr.ReadToEnd()
	End Using

Catch e As WebException

	If Not e.Response Is Nothing Then

		' Cast the WebResponse to an HttpWebResponse so we can get the StatusCode
		Dim httpResponse As HttpWebResponse = CType(e.Response, HttpWebResponse)
		resultCode = Convert.ToInt32(httpResponse.StatusCode)
		
		' Get the HTTP response message.
		resultData = e.Message

	Else
		resultData = "Exception: " & e.Message
		If (e.InnerException.Message.Length > 0) Then
			resultData = resultData & vbCRLF & "Inner Exception: " + e.InnerException.Message
		End If
	End If

End Try]]></code></stage><stage stageid="963972a4-a007-4341-af9f-c6ef75f14920" name="Result" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-225" y="270" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="903cac1f-30ca-40dc-98b8-42f2d11cb6a4" name="Block1" type="Block"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><loginhibit /><display x="-45" y="-60" w="195" h="60" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="10d2bb33-8542-4bda-8b8d-0c8cd4290385" name="Recover1" type="Recover"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><loginhibit /><display x="90" y="-30" /><onsuccess>d7bacdf2-b0bf-4934-943d-d226e9a09264</onsuccess></stage><stage stageid="d7bacdf2-b0bf-4934-943d-d226e9a09264" name="Exception1" type="Exception"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><loginhibit /><display x="195" y="-30" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="063dce59-4ddf-4e2e-8de5-88f7ffe33530" name="Start" type="Start"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP data to" stage="Address URL" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" /><input type="collection" name="FileMetadata" narrative="Files to be sent in the multipart HTTP  request" stage="FileMetadata" /><input type="collection" name="FieldMetadata" narrative="Text data to be sent in the multipart HTTP  request" stage="FieldMetadata" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers" stage="Headers" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" stage="Accept" /><input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" stage="Username" /><input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" stage="Password" /><input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" stage="Certificate ID" /><input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" stage="Force Pre Authorization" /><input type="flag" name="Use Bearer Token" narrative="OPTIONAL: If you need bearer token authorization set this to true." stage="Use Bearer Token" /><input type="text" name="Bearer Token" narrative="OPTIONAL: If you have a bearer token and need to use authorization" stage="Bearer Token" /><input type="flag" name="Allow Auto Redirects" narrative="OPTIONAL: If you prefer to manually handle redirects (ie. HTTP 302) set this flag to False. Default value is True." stage="Allow Auto Redirects" /><input type="number" name="Maximum Redirects" narrative="OPTIONAL: If 'Allow Auto Redirect' is True, this controls the maximum number of redirects to allow. Default value is 50." stage="Maximum Redirects" /><input type="number" name="Request Timeout" narrative="OPTIONAL: This  property controls the length of time, in milliseconds, until the request times out and throws a WebException. Default value is 100000 milliseconds (i.e. 100 seconds)." stage="Request Timeout" /></inputs><onsuccess>32a4e0a5-1366-40aa-9519-e62142789499</onsuccess></stage><stage stageid="bad6d1f4-bdbf-4eaf-bbba-cae87e0adc5b" name="Address URL" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-225" y="-45" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="80dba3fd-4152-45bb-bcf8-a96c3c05828d" name="Proxy Password" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-135" y="45" w="90" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="6d18a12b-6f9d-47e9-ba19-7729733d51b3" name="Proxy Username" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-225" y="45" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0ebe6750-8f30-4797-9cce-cc945a880403" name="Proxy URL" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-135" y="15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="30a7630d-d5db-422c-80e6-97b45f287851" name="Use Proxy" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-225" y="15" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="2545caff-1d1d-47c0-b752-1d1dd073b912" name="Headers" type="Collection"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-135" y="-45" w="90" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="11ff9930-c087-4c05-ad52-07130ab67b42" name="Accept" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-135" y="-15" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b72acba7-f345-40f3-b349-d159af3d71ee" name="Username" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-225" y="75" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="960d9197-e030-4efd-b3c2-7843e15ec1fe" name="Password" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-135" y="75" w="90" h="30" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="e9590c7c-8515-4c91-9e18-f503b20a4a23" name="Certificate ID" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-225" y="105" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c27d4469-a0a9-4e5d-9e4e-4486bf3cb9ea" name="Force Pre Authorization" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-225" y="-15" w="90" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5084587f-09a9-4613-b6de-ae9a47782c43" name="ResultHeadersJson" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-135" y="270" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e7d807d6-0eb8-49b1-8d03-3e661ef44996" name="Inputs" type="Block"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><loginhibit /><display x="-285" y="-75" w="210" h="300" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="9d4a3881-f78f-4556-8d00-46b27f2a1239" name="Outputs" type="Block"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><loginhibit /><display x="-285" y="240" w="210" h="105" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="26c19eae-b220-41e2-83d8-ac3293103537" name="ResultCode" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-225" y="315" w="90" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e1442ce0-f887-4b3f-9afc-17e6be7d7285" name="Bearer Token" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><loginhibit /><display x="-135" y="105" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="cd8093ae-9f60-4e6b-bfbc-f31f8ee98538" name="Use Bearer Token" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-225" y="135" w="90" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="0a47da72-c6f3-4e80-a710-f934d1c630f3" name="Note1" type="Note"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><loginhibit /><narrative>Force Pre Authorization - Make sure that this isn't used with Use Bearer Token. Only one Authorization header is needed.

Headers Collection - If you use Use Bearer Token, make sure that this collection doesn't contain an Authorization header.

Use Bearer Token is not configured to work using a Proxy.</narrative><display x="-480" y="30" w="330" h="210" /><font family="Segoe UI" size="14" style="Regular" color="FF0000" /></stage><stage stageid="f001adc6-fb62-4adc-b1f7-65b719ad6ea6" name="FileMetadata" type="Collection"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><loginhibit /><narrative>Files to be sent in the multipart HTTP  request</narrative><display x="-135" y="135" w="90" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="FileName" type="text" description="Optional. Used to populate the filename header for this file's section in the multi-part form body. If a value is not specified, the filename is used from the provided filepath" /><field name="FieldName" type="text" description="Optional. Used to populate the name header for this file's section in the multi-part form body. If a value is not specified, the filename is set to 'file'" /><field name="ContentType" type="text" description="Optional. Used to populate the Content-Type header for this file's section in the multi-part form body. If a value is not specified, the mimetype of the document is used." /><field name="FilePath" type="text" description="The path of the file" /></collectioninfo></stage><stage stageid="62b83467-979b-4a52-a90e-a856a953fd3f" name="FieldMetadata" type="Collection"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><loginhibit /><narrative>Text data to be sent in the multipart HTTP  request</narrative><display x="-225" y="165" w="90" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Name" type="text" description="Name of the field" /><field name="Value" type="text" description="Value to be set for the field" /></collectioninfo></stage><stage stageid="569bdaa6-7e4b-4d05-b5bc-ff806a445071" name="Allow Auto Redirects" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-150" y="195" w="90" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="95efd336-3d93-4cfd-9efe-0fae5d6ae81b" name="Maximum Redirects" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-240" y="255" w="90" h="30" /><datatype>number</datatype><initialvalue>50</initialvalue><private /><alwaysinit /></stage><stage stageid="de90ac26-44e7-4ad3-8b91-55a9582febf6" name="Allow Auto Redirects" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-225" y="225" w="90" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="c5081f57-562b-429d-abde-1c154baa6826" name="Maximum Redirects" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-135" y="225" w="90" h="30" /><datatype>number</datatype><initialvalue>50</initialvalue><private /><alwaysinit /></stage><stage stageid="26021f76-0f40-42f2-83be-4623616b4060" name="Allow Auto Redirects" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-135" y="195" w="90" h="30" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="298f7a26-0ac5-4d44-b31c-f06ed8fa7458" name="Maximum Redirects" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-225" y="195" w="90" h="30" /><datatype>number</datatype><initialvalue>50</initialvalue><private /><alwaysinit /></stage><stage stageid="6475dcb8-adb9-4c9d-b082-6cc53cb732f6" name="Request Timeout" type="Data"><subsheetid>701af150-fe0b-4f6b-a823-dc6d09569c09</subsheetid><display x="-135" y="165" w="90" h="30" /><datatype>number</datatype><initialvalue>100000</initialvalue><private /><alwaysinit /></stage><stage stageid="5a02b6c1-39e7-4ef4-ab0d-b1a1f128c86a" name="Request Timeout" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><display x="-240" y="135" w="90" h="30" /><datatype>number</datatype><initialvalue>100000</initialvalue><private /><alwaysinit /></stage><stage stageid="1effbf75-66b8-4089-a7b9-56d7f5644c97" name="Request Timeout" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><display x="-150" y="255" w="90" h="30" /><datatype>number</datatype><initialvalue>100000</initialvalue><private /><alwaysinit /></stage><stage stageid="2b2e57e2-cc82-46bd-9c9f-780c3261ca07" name="Request Timeout" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><display x="-165" y="75" w="90" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="86ecfacb-ce2d-4af3-9691-42c245cec896" name="Request Timeout" type="Data"><subsheetid>74a20e65-147b-4dea-867e-fa08fbea81cb</subsheetid><display x="-225" y="255" w="90" h="30" /><datatype>number</datatype><initialvalue>100000</initialvalue><private /><alwaysinit /></stage></process></object>
        <object id="d39ef435-da5c-4e38-a846-b903b2cf3d8e" name="Utility - JSON" xmlns="http://www.blueprism.co.uk/product/process"><process name="Utility - JSON" version="6.9.0.26970" bpversion="7.1.2.3518" narrative="An object for parsing JSON into a collection and turning a collection into JSON." byrefcollection="true" type="object" runmode="Background"><appdef><element name="Application Root"><id>8f20ac0c-296f-43c3-b0d9-59b5b2b7da1c</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="6a9ccb5a-8cc3-44ac-b343-39680558062f" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="560472b9-cea4-41d5-bc36-c49d6c1b26e6" type="Normal" published="True"><name>Collection to JSON</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="e5aeb4cb-cd25-4535-b3be-b46681b4e6b6" type="Normal" published="True"><name>JSON to Collection</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="e53062c7-68de-4763-b37a-456688d0d607" type="Normal" published="True"><name>JSON to Collection (skipping JArray)</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="1c04dc1d-81e9-47e9-a8c4-b46dd19b2624" type="Normal" published="True"><name>JsonPath</name><view><camerax>0</camerax><cameray>-9</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="cbbe7eb7-53d6-49a6-9f88-cb3a26c334df" type="Normal" published="True"><name>JsonPath - Return Collection</name><view><camerax>0</camerax><cameray>42</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="222ee4c2-914e-4b2b-8e13-443c1c76b3dd" name="Start" type="Start"><loginhibit /><display x="15" y="-105" /><onsuccess>ff6524a3-da73-439c-a4ba-2aabb994009c</onsuccess></stage><stage stageid="ff6524a3-da73-439c-a4ba-2aabb994009c" name="End" type="End"><loginhibit /><display x="15" y="90" /></stage><stage stageid="7fd071f3-6769-4dd5-95cf-a911c73c42ff" name="Stage1" type="ProcessInfo"><display x="-180" y="-105" w="180" h="90" /><references><reference>System.Data.dll</reference><reference>System.Xml.dll</reference><reference>System.Drawing.dll</reference><reference>Newtonsoft.Json.dll</reference><reference>System.Core.dll</reference><reference>System.dll</reference></references><imports><import>System.Data</import><import>System.Drawing</import><import>Newtonsoft.Json</import><import>System.Collections.Generic</import><import>System.Text</import><import>System.IO</import><import>System</import><import>Newtonsoft.Json.Linq</import><import>System.Collections</import><import>System.Linq</import><import>System.Collections</import></imports><language>csharp</language><globalcode><![CDATA[]]></globalcode><code><![CDATA[//**********************************************************************************************
// NEW CODE
// This code is used by the 'JSON To Collection (Skipping Array)' action. It is based on 
// opensource code developed by Tobias Arnold and released under MIT License. The original 
// source code can be found at the following GitHub link: 
// 
// 		https://github.com/toarnold/Coremoran.BluePrism.Json. 
//
// To contact Tobias, please refer to his LinkedIn profile: 
// 
// 		https://www.linkedin.com/in/tobias-arnold-492368155/  
//**********************************************************************************************
static bool IsSingleRowNew(DataTable table)
{
	return Convert.ToBoolean(table.ExtendedProperties[SpecialValues.SingleRowPropertyName] ?? false);
}

static void SetSingleRow(DataTable table, bool singleRow)
{
	table.ExtendedProperties[SpecialValues.SingleRowPropertyName] = singleRow;
}

public static class BluePrismConverter
{
	public static DataTable ObjectToCollection(object o)
	{
		return JsonToCollection(JsonConvert.SerializeObject(o,
				new DataTableConverter(),
				new GroupingConverter(),
				new DataRowConverter()
		));
	}

	public static DataTable JsonToCollection(string json)
	{
		return (DataTable)JsonConvert.DeserializeObject(json, typeof(DataTable), new JsonSerializerSettings
		{
			Converters = new JsonConverter[]
			{
				new DataTableConverter(),
				new DataRowConverter()
			},
			DateTimeZoneHandling = DateTimeZoneHandling.Unspecified
		});
	}

	public static string CollectionToJson(DataTable table)
	{
		return JsonConvert.SerializeObject(table,
				new DataTableConverter(),
				new DataRowConverter());
	}

	public static JArray CollectionToJArray(DataTable table)
	{
		var serializer = JsonSerializer.Create(new JsonSerializerSettings()
		{
			Converters = new JsonConverter[] {
				new DataTableConverter(),
				new DataRowConverter() }
		});
		return JArray.FromObject(table, serializer);
	}
}

internal class DataRowConverter : JsonConverter
{
	public override bool CanConvert(Type objectType) => objectType == typeof(DataRow);

	public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)
	{
		if (reader.TokenType != JsonToken.StartObject)
		{
			throw new Exception("Unsupported JsonToken " + reader.TokenType.ToString());
		}

		var dt = new DataTable();
		SetSingleRow(dt, true);
		dt.Rows.Add();
		string currentColumnName = null;
		while (reader.Read() && reader.TokenType != JsonToken.EndObject)
		{
			switch (reader.TokenType)
			{
				case JsonToken.PropertyName:
					currentColumnName = reader.Value.ToString();
					break;
				default:
					DataTableRowHandler.HandleJsonData(dt, currentColumnName, serializer, reader);
					break;
			}
		}
		return dt.Rows[0];
	}

	public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)
	{
		var dataRow = (DataRow)value;
		var dataTable = dataRow.Table;
		if (dataTable.Columns.Count == 1
			&& dataTable.Columns[0].ColumnName == SpecialValues.JsonUnnamedValue 
			&& (!IsSingleRowNew(dataTable) || writer.Path == string.Empty))
		{
			// First (and single!) element
			serializer.Serialize(writer, dataRow[0]); 
		}
		else
		{
			serializer.Serialize(writer, dataTable.Columns.Cast<DataColumn>().ToDictionary(k => k.ColumnName, v => dataRow[v]));
		}
	}
}

internal class DataTableConverter : JsonConverter
{
	public override bool CanConvert(Type objectType) => objectType == typeof(DataTable);

	public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)
	{
		var dt = (DataTable)value;
		if (IsSingleRowNew(dt))
		{
			serializer.Serialize(writer, dt.Rows[0]);
		}
		else
		{
			serializer.Serialize(writer, dt.Select());
		}
	}

	public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)
	{
		var dt = new DataTable();
		switch (reader.TokenType)
		{
			case JsonToken.StartObject:
				dt = serializer.Deserialize<DataRow>(reader).Table;
				break;
			case JsonToken.StartArray:
				SetSingleRow(dt, false);
				var nullColumns = new HashSet<string>();
				while (reader.Read() && reader.TokenType != JsonToken.EndArray)
				{
					switch (reader.TokenType)
					{
						case JsonToken.Null:
							dt.Rows.Add();
							break;
						case JsonToken.StartObject:
							var tempTable = serializer.Deserialize<DataRow>(reader).Table;
							var nulls = tempTable.Columns.Cast<DataColumn>().Where(w => tempTable.Rows[0].IsNull(w.ColumnName)).Select(s => s.ColumnName).ToList();
							nulls.ForEach(n => tempTable.Columns.Remove(n));
							nullColumns.UnionWith(nulls);
							dt.Merge(tempTable, true, MissingSchemaAction.Add);
							break;
						default:
							DataTableRowHandler.HandleJsonData(dt, null, serializer, reader);
							break;
					}
				}
				// Add not set Null-Columns
				dt.Columns.AddRange(nullColumns.Where(w => !dt.Columns.Contains(w)).Select(s => new DataColumn(s)).ToArray());
				break;
			default: /* Try to append a single value */
				if (reader.TokenType != JsonToken.Null)
				{
					SetSingleRow(dt, true);
					dt.Rows.Add();
					DataTableRowHandler.HandleJsonData(dt, null, serializer, reader);
				}
				break;
		}
		return dt;
	}
}

internal static class DataTableRowHandler
{
	private static void AppendArrayItem(DataTable table, Type colType, string colName, object value)
	{
		if (!table.Columns.Contains(colName))
		{
			var newcolumn = new DataColumn(colName, colType); 
			if (colType == typeof(DateTime))
			{
				newcolumn.DateTimeMode = DataSetDateTime.Utc;
			}
			table.Columns.Add(newcolumn);
		}
		if (IsSingleRowNew(table))
		{
			table.Rows[0][colName] = value;
		}
		else
		{
			var newRow = table.NewRow();
			newRow[colName] = value;
			table.Rows.Add(newRow);
		}
	}

	internal static void HandleJsonData(DataTable table, string currentColumnName, JsonSerializer serializer, JsonReader reader)
	{
		switch (reader.TokenType)
		{
			case JsonToken.String:
			case JsonToken.Null:
				AppendArrayItem(table, typeof(string), currentColumnName ?? SpecialValues.JsonUnnamedValue, reader.Value);
				break;
			case JsonToken.Integer:
			case JsonToken.Float:
				AppendArrayItem(table, typeof(decimal), currentColumnName ?? SpecialValues.JsonUnnamedValue, reader.Value);
				break;
			case JsonToken.Boolean:
				AppendArrayItem(table, typeof(bool), currentColumnName ?? SpecialValues.JsonUnnamedValue, reader.Value);
				break;
			case JsonToken.Date:
				AppendArrayItem(table, typeof(DateTime), currentColumnName ?? SpecialValues.JsonUnnamedValue, reader.Value);
				break;
			case JsonToken.StartObject:
				AppendArrayItem(table, typeof(DataTable), currentColumnName ?? SpecialValues.JsonUnnamedValue, serializer.Deserialize<DataTable>(reader));
				break;
			case JsonToken.StartArray:
				AppendArrayItem(table, typeof(DataTable), currentColumnName ?? SpecialValues.JsonUnnamedValue, serializer.Deserialize<DataTable>(reader));
				break;
			default:
				throw new Exception("Unsupported JsonToken " + reader.TokenType.ToString());
		}
	}
}

internal class GroupingConverter : JsonConverter
{
	public override bool CanRead => false;

	public override bool CanConvert(Type objectType) => objectType.GetInterfaces().Any(a => a.IsGenericType && a.GetGenericTypeDefinition() == typeof(IGrouping<,>));

	public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer) => throw new NotImplementedException();

	public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)
	{
		// Get key object with reflection
		var keyInfo = value.GetType().GetProperty("Key");
		var key = JToken.FromObject(keyInfo.GetValue(value));

		var data = key is JObject obj ? obj : new JObject { { SpecialValues.GroupingSingleKeyColumnName, key } };
		data.Add(SpecialValues.GroupingGroupColumnName, JArray.FromObject(((IEnumerable<object>)value).Select(x => x), serializer));

		serializer.Serialize(writer, data);
	}
}

public class SpecialValues
{
	public const string JsonUnnamedValue = "JSON_Unnamed_Value";
	public const string SingleRowPropertyName = "SingleRow";
	public const string GroupingSingleKeyColumnName = "Key";
	public const string GroupingGroupColumnName = "Group";
}

//**********************************************************************************************
// LEGACY CODE
// This is the original code of the Utility - JSON VBO. This code is used by the 
// 'JSON To Collection' and 'Collection To JSON' actions.
//**********************************************************************************************
private bool mUseNewParseMethod = false;

private class JSON
{
	public const string Array = "JSON:Array";
	public const string Null = "JSON:Null";
}

public string ConvertToJSON(DataTable dt)
{
	object o = SerialiseGeneric(dt, true);
	return JsonConvert.SerializeObject(o);
}

public object SerialiseGeneric(object o, bool removeArray)
{
	DataTable dt = o as DataTable;
	if (dt != null)
		return SerialiseDataTable(dt);

	DataRow dr = o as DataRow;
	if (dr != null)
		return SerialiseDataRow(dr, removeArray);

	string s = o as string;
	if (s != null && s == JSON.Null)
		return null;

	if (o != null)
		return o;

	return null;
}

public object SerialiseDataTable(DataTable dt)
{
	if (IsSingleRow(dt))
		return SerialiseGeneric(dt.Rows[0], false);
	else
	{
		JArray ja = new JArray();
		foreach (DataRow r in dt.Rows)
			ja.Add(SerialiseGeneric(r, true));
		return ja;
	}
}

public bool IsSingleRow(DataTable dt)
{
	if (dt.ExtendedProperties.Contains("SingleRow"))
		return System.Convert.ToBoolean(dt.ExtendedProperties["SingleRow"]);
	// Fallback for older versions of blueprism
	return dt.Rows.Count == 1;
}

public object SerialiseDataRow(DataRow dr, bool removeArray)
{
	JObject jo = new JObject();
	foreach (DataColumn c in dr.Table.Columns)
	{
		string s = c.ColumnName;
		if (removeArray && s == JSON.Array)
			return SerialiseGeneric(dr[s], true);
		jo[s] = JToken.FromObject(SerialiseGeneric(dr[s], false));
	}
	return jo;
}

public DataTable ConvertToDataTable(string json)
{
	object o = JsonConvert.DeserializeObject(json);
	return (DataTable)DeserialiseGeneric(o, true);
}

private object DeserialiseGeneric(object o, bool populate)
{
	JArray a = o as JArray;
	if (a != null)
		return mUseNewParseMethod ? DeserialiseArrayWithoutJArray(a, populate) : DeserialiseArray(a, populate);

	JObject jo = o as JObject;
	if (jo != null)
		return DeserialiseObject(jo, populate);

	JValue jv = o as JValue;
	if (jv != null)
		return jv.Value;

	return JSON.Null;
}

private string GetKey(KeyValuePair<string, JToken> kv)
{
	if (kv.Key != null)
		return kv.Key.ToString();
	return "";
}


private DataTable DeserialiseObject(JObject o, bool populate)
{
	DataTable dt = new DataTable();

	foreach (KeyValuePair<string, JToken> kv in o)
	{
		Type type = GetTypeOf(DeserialiseGeneric(kv.Value, false));
		dt.Columns.Add(GetKey(kv), type);
	}

	if (populate)
	{
		DataRow dr = dt.NewRow();
		foreach (KeyValuePair<string, JToken> kv in o)
			dr[GetKey(kv)] = DeserialiseGeneric(kv.Value, true);
		dt.Rows.Add(dr);
	}

	return dt;
}

private DataTable DeserialiseArrayWithoutJArray(JArray jarr, bool populate)
{
	DataTable dt = new DataTable();

	Type first = null;
	foreach (object e in jarr)
	{
		if (first == null)
			first = GetTypeOf(DeserialiseGeneric(e, false));
		if (GetTypeOf(DeserialiseGeneric(e, false)) != first)
			throw new Exception("Data Type mismatch in array");
	}

	System.Collections.Specialized.OrderedDictionary columns = new System.Collections.Specialized.OrderedDictionary();
	var allTypesInColumnsMatch = jarr.All(e =>
	{
		if (!(e is JObject))
			return false;
		foreach (KeyValuePair<string, JToken> pair in (JObject)e)
		{
			object val = pair.Value;
			if (val is JValue)
				val = (JValue)(pair.Value);
			var tp = val ?? (object)"".GetType();

			if (columns.Contains(pair.Key))
			{
				if (tp != columns[pair.Key])
					return false;
			}
			else
				columns[pair.Key] = tp;
		}
		return true;
	});

	if (allTypesInColumnsMatch)
	{
		foreach (DictionaryEntry pair in columns)
		{
			string key = System.Convert.ToString(pair.Key);
			Type tp = (Type)pair.Value;
			if (tp == typeof(JObject) || tp == typeof(JArray))
				dt.Columns.Add(key, typeof(DataTable));
			else
				dt.Columns.Add(key, tp);
		}
	}
	else if (first != null)
		dt.Columns.Add(JSON.Array, first);

	if (populate)
	{
		foreach (object e in jarr)
		{
			DataRow dr = dt.NewRow();
			if (allTypesInColumnsMatch)
			{
				foreach (KeyValuePair<string, JToken> pair in (JObject)e)
					dr[pair.Key] = DeserialiseGeneric(pair.Value, true);
			}
			else
				dr[JSON.Array] = DeserialiseGeneric(e, true);

			dt.Rows.Add(dr);
		}
	}

	return dt;
}

private DataTable DeserialiseArray(JArray o, bool populate)
{
	DataTable dt = new DataTable();

	Type first = null;
	foreach (object e in o)
	{
		if (first == null)
			first = GetTypeOf(DeserialiseGeneric(e, false));
		if (GetTypeOf(DeserialiseGeneric(e, false)) != first)
			throw new Exception("Data Type mismatch in array");
	}
	if (first != null)
		dt.Columns.Add(JSON.Array, first);

	if (populate)
	{
		foreach (object e in o)
		{
			DataRow dr = dt.NewRow();
			dr[JSON.Array] = DeserialiseGeneric(e, true);
			dt.Rows.Add(dr);
		}
	}

	return dt;
}

private Type GetTypeOf(object o)
{
	if (o == null)
		return typeof(string);
	return o.GetType();
}

public bool IsNumeric(string value)
{
    return value.All(char.IsNumber);
}]]></code></stage><stage stageid="c290e7f4-b01b-4012-9422-044432a3cc82" name="Clean Up" type="SubSheetInfo"><subsheetid>6a9ccb5a-8cc3-44ac-b343-39680558062f</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="662f70f7-7036-462d-b9bf-f35265dd971a" name="Start" type="Start"><subsheetid>6a9ccb5a-8cc3-44ac-b343-39680558062f</subsheetid><loginhibit /><display x="15" y="-105" /><onsuccess>153f4275-2acd-48a5-b6e6-409fcb2441a8</onsuccess></stage><stage stageid="153f4275-2acd-48a5-b6e6-409fcb2441a8" name="End" type="End"><subsheetid>6a9ccb5a-8cc3-44ac-b343-39680558062f</subsheetid><loginhibit /><display x="15" y="90" /></stage><stage stageid="885aaf30-a216-44c5-975b-ca58ce02f815" name="JSON to Collection" type="SubSheetInfo"><subsheetid>e5aeb4cb-cd25-4535-b3be-b46681b4e6b6</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="e5625896-d966-4a10-aa39-2e85611f490f" name="Start" type="Start"><subsheetid>e5aeb4cb-cd25-4535-b3be-b46681b4e6b6</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="json" stage="json" /></inputs><onsuccess>779de445-0658-4a45-a1ef-a38d6de24429</onsuccess></stage><stage stageid="66526e3e-8b9e-4452-9ca8-f70baa9aec4a" name="End" type="End"><subsheetid>e5aeb4cb-cd25-4535-b3be-b46681b4e6b6</subsheetid><loginhibit /><display x="15" y="45" /><outputs><output type="collection" name="Result" stage="Result" /></outputs></stage><stage stageid="007e04e2-4ed0-4afd-87d3-c06d79f48d86" name="new" type="Note"><subsheetid>6a9ccb5a-8cc3-44ac-b343-39680558062f</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="d92fd7fc-b028-457a-a14a-17d66c4b5513" name="new" type="Note"><narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="779de445-0658-4a45-a1ef-a38d6de24429" name="JSON To Collection" type="Code"><subsheetid>e5aeb4cb-cd25-4535-b3be-b46681b4e6b6</subsheetid><loginhibit /><display x="15" y="-30" /><inputs><input type="text" name="json" expr="[json]" /></inputs><outputs><output type="collection" name="result" stage="Result" /></outputs><onsuccess>66526e3e-8b9e-4452-9ca8-f70baa9aec4a</onsuccess><code><![CDATA[result = ConvertToDataTable(json);]]></code></stage><stage stageid="da3984e5-ce52-4649-81c5-a71d452a5ba0" name="json" type="Data"><subsheetid>e5aeb4cb-cd25-4535-b3be-b46681b4e6b6</subsheetid><display x="-195" y="0" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0e93e91c-85e1-4c75-b74c-52d08c0724e6" name="Collection to JSON" type="SubSheetInfo"><subsheetid>560472b9-cea4-41d5-bc36-c49d6c1b26e6</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="c10fccbd-439b-447d-908a-58f20a540146" name="Start" type="Start"><subsheetid>560472b9-cea4-41d5-bc36-c49d6c1b26e6</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="collection" name="Data" stage="Data" /></inputs><onsuccess>7923115c-5283-4694-b2c1-142afb4d3788</onsuccess></stage><stage stageid="ede1f653-07f1-42eb-8616-8d2d3dfb5244" name="End" type="End"><subsheetid>560472b9-cea4-41d5-bc36-c49d6c1b26e6</subsheetid><loginhibit /><display x="15" y="60" /><outputs><output type="text" name="JSON" stage="JSON" /></outputs></stage><stage stageid="8f488472-d2dd-4bbc-a98e-07d6a494ab3f" name="Result" type="Collection"><subsheetid>e5aeb4cb-cd25-4535-b3be-b46681b4e6b6</subsheetid><display x="-195" y="75" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="7923115c-5283-4694-b2c1-142afb4d3788" name="Collection To JSON" type="Code"><subsheetid>560472b9-cea4-41d5-bc36-c49d6c1b26e6</subsheetid><loginhibit /><display x="15" y="-30" /><inputs><input type="collection" name="data" expr="[Data]" /></inputs><outputs><output type="text" name="json" stage="JSON" /></outputs><onsuccess>ede1f653-07f1-42eb-8616-8d2d3dfb5244</onsuccess><code><![CDATA[json = ConvertToJSON(data);]]></code></stage><stage stageid="dbeac687-55ba-4b1a-9e9b-1a5f1e763886" name="Data" type="Collection"><subsheetid>560472b9-cea4-41d5-bc36-c49d6c1b26e6</subsheetid><loginhibit /><display x="-195" y="-15" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="60425486-0e54-4004-afef-6ccb7e96828d" name="JSON" type="Data"><subsheetid>560472b9-cea4-41d5-bc36-c49d6c1b26e6</subsheetid><display x="-195" y="60" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="68820997-9906-40ef-b5f3-325f6f0a25b9" name="JSON to Collection (skipping JArray)" type="SubSheetInfo"><subsheetid>e53062c7-68de-4763-b37a-456688d0d607</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="14799289-a9b9-4b93-aeb6-f0240547be63" name="Start" type="Start"><subsheetid>e53062c7-68de-4763-b37a-456688d0d607</subsheetid><loginhibit /><display x="-30" y="-120" /><inputs><input type="text" name="json" stage="json" /></inputs><onsuccess>8cb729e4-705c-400b-8d1d-0b54dd51fb94</onsuccess></stage><stage stageid="21187841-67f3-4ed1-a3b0-de763bb1e801" name="End" type="End"><subsheetid>e53062c7-68de-4763-b37a-456688d0d607</subsheetid><loginhibit /><display x="-30" y="30" /><outputs><output type="collection" name="Result" stage="Result" /></outputs></stage><stage stageid="8cb729e4-705c-400b-8d1d-0b54dd51fb94" name="JSON To Collection Without JArray" type="Code"><subsheetid>e53062c7-68de-4763-b37a-456688d0d607</subsheetid><loginhibit /><display x="-30" y="-45" /><inputs><input type="text" name="json" expr="[json]" /></inputs><outputs><output type="collection" name="result" stage="Result" /></outputs><onsuccess>21187841-67f3-4ed1-a3b0-de763bb1e801</onsuccess><code><![CDATA[result = BluePrismConverter.JsonToCollection(json);
]]></code></stage><stage stageid="b3a37b86-f505-4522-80d4-2c9e45ab723c" name="json" type="Data"><subsheetid>e53062c7-68de-4763-b37a-456688d0d607</subsheetid><display x="-195" y="0" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="98ca8a8f-1ce6-4cb7-85e6-9fff8b1b06f9" name="Result" type="Collection"><subsheetid>e53062c7-68de-4763-b37a-456688d0d607</subsheetid><display x="-195" y="75" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="f95350a7-9c25-487f-ad74-c7ce70ea37a5" name="Note2" type="Note"><narrative>© 2023 Blue Prism Limited
Licensed under the Blue Prism Asset License and Support Terms
https://digitalexchange.blueprism.com/fileMedia/download/a9111324-3192-43ff-9166-566620ca1182</narrative><display x="240" y="-15" w="300" h="90" /><font family="Segoe UI" size="12" style="Regular" color="0000FF" /></stage><stage stageid="dfa7d330-e791-49c6-b4fb-6011b4d8d6cc" name="Note1" type="Note"><loginhibit /><narrative>Version 10.0.1</narrative><display x="15" y="-165" w="150" h="30" /><font family="Segoe UI" size="14" style="Bold" color="FF0000" /></stage><stage stageid="c07d13ef-4200-4377-8cfd-bd38c06ea923" name="JsonPath" type="SubSheetInfo"><subsheetid>1c04dc1d-81e9-47e9-a8c4-b46dd19b2624</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="ee1a9752-11e4-4a3f-aae8-3e910b966e9c" name="Start" type="Start"><subsheetid>1c04dc1d-81e9-47e9-a8c4-b46dd19b2624</subsheetid><loginhibit /><display x="-30" y="-60" /><inputs><input type="text" name="Json" stage="Json" /><input type="text" name="JsonPath" stage="JsonPath" /></inputs><onsuccess>d0ff9ba9-4bf0-4ba4-a9d6-85a5a0935c7e</onsuccess></stage><stage stageid="4b590fe3-4e65-4b28-baa0-8852d218894a" name="End" type="End"><subsheetid>1c04dc1d-81e9-47e9-a8c4-b46dd19b2624</subsheetid><loginhibit /><display x="-30" y="60" /><outputs><output type="number" name="NumericResult" stage="NumericResult" /><output type="text" name="TextResult" stage="TextResult" /><output type="text" name="ErrorMessage" stage="ErrorMessage" /></outputs></stage><stage stageid="7ae65c44-8e32-406c-ad5b-fa0f802cdabd" name="Json" type="Data"><subsheetid>1c04dc1d-81e9-47e9-a8c4-b46dd19b2624</subsheetid><display x="-195" y="0" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b6118f7f-6c60-4e0b-9683-f749ae300a06" name="JsonPath" type="Data"><subsheetid>1c04dc1d-81e9-47e9-a8c4-b46dd19b2624</subsheetid><display x="-195" y="45" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d0ff9ba9-4bf0-4ba4-a9d6-85a5a0935c7e" name="Process Json - Single Output" type="Code"><subsheetid>1c04dc1d-81e9-47e9-a8c4-b46dd19b2624</subsheetid><loginhibit /><display x="-30" y="0" w="120" h="30" /><inputs><input type="text" name="Json" expr="[Json]" /><input type="text" name="JsonPath" expr="[JsonPath]" /></inputs><outputs><output type="text" name="TextResult" stage="TextResult" /><output type="number" name="NumericResult" stage="NumericResult" /><output type="text" name="ErrorMessage" stage="ErrorMessage" /></outputs><onsuccess>4b590fe3-4e65-4b28-baa0-8852d218894a</onsuccess><code><![CDATA[// Initialize the output vars as only one will be used.
NumericResult = 0;
TextResult = String.Empty;
ErrorMessage = String.Empty;

String tempResult = string.Empty;

JObject jo;

jo = JObject.Parse(Json);

try
{
	tempResult = (string)jo.SelectToken(JsonPath,true);

	if (IsNumeric(tempResult))
	{
		NumericResult = Decimal.Parse(tempResult);
	}
	else
	{
		TextResult = tempResult;
	}
}
catch (JsonException)
{
	ErrorMessage = "Unable to find value in supplied JSON.";
}






]]></code></stage><stage stageid="8a2694eb-d12b-4cad-87cb-d43651aeb0f2" name="NumericResult" type="Data"><subsheetid>1c04dc1d-81e9-47e9-a8c4-b46dd19b2624</subsheetid><display x="-165" y="165" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6bb1f845-c916-472b-852a-ab9c873bf569" name="TextResult" type="Data"><subsheetid>1c04dc1d-81e9-47e9-a8c4-b46dd19b2624</subsheetid><display x="-225" y="165" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b1351cf4-399a-4e58-b568-321f0d3196e5" name="ErrorMessage" type="Data"><subsheetid>1c04dc1d-81e9-47e9-a8c4-b46dd19b2624</subsheetid><loginhibit /><display x="-195" y="210" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="94ab4d76-1378-44d7-bfd9-c4a6eaa1e710" name="JsonPath - Return Collection" type="SubSheetInfo"><subsheetid>cbbe7eb7-53d6-49a6-9f88-cb3a26c334df</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="f48025fa-9b5d-4675-8147-3478db7860c6" name="Start" type="Start"><subsheetid>cbbe7eb7-53d6-49a6-9f88-cb3a26c334df</subsheetid><loginhibit /><display x="-15" y="-45" /><inputs><input type="text" name="Json" stage="Json" /><input type="text" name="JsonPath" stage="JsonPath" /></inputs><onsuccess>a0419bd6-afbf-4de4-98ec-5471c207786c</onsuccess></stage><stage stageid="09dc30b8-a6f6-4594-9044-3e15b51f75ef" name="End" type="End"><subsheetid>cbbe7eb7-53d6-49a6-9f88-cb3a26c334df</subsheetid><loginhibit /><display x="-15" y="135" /><outputs><output type="collection" name="Result" stage="Result" /><output type="text" name="ErrorMessage" stage="ErrorMessage" /></outputs></stage><stage stageid="be0e5e0e-6e93-4633-8c64-c02b0875b278" name="Json" type="Data"><subsheetid>cbbe7eb7-53d6-49a6-9f88-cb3a26c334df</subsheetid><display x="-195" y="0" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ba7a4062-02e0-4458-8755-f7a521119277" name="JsonPath" type="Data"><subsheetid>cbbe7eb7-53d6-49a6-9f88-cb3a26c334df</subsheetid><display x="-195" y="45" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a0419bd6-afbf-4de4-98ec-5471c207786c" name="JsonPath - Return Object" type="Code"><subsheetid>cbbe7eb7-53d6-49a6-9f88-cb3a26c334df</subsheetid><loginhibit /><narrative>This allows multiple objects to be returned as a Json string.</narrative><display x="-15" y="15" /><inputs><input type="text" name="Json" expr="[Json]" /><input type="text" name="JsonPath" expr="[JsonPath]" /></inputs><outputs><output type="text" name="TextResult" stage="TextResult" /><output type="number" name="NumericResult" stage="NumericResult" /><output type="text" name="ErrorMessage" stage="ErrorMessage" /></outputs><onsuccess>03bbb947-bcd3-4602-802b-f0444d868a92</onsuccess><code><![CDATA[//Initialize the output vars as only one will be used.
NumericResult = 0;
TextResult = String.Empty;
ErrorMessage=String.Empty;

string tempResult = string.Empty;
JToken token;

JObject jo;

jo = JObject.Parse(Json);

try
{
	token = jo.SelectToken(JsonPath, true);
	tempResult = token.ToString();

	TextResult = tempResult;
}
catch (JsonException)
{
	ErrorMessage = "Unable to find value in supplied JSON.";
}





]]></code></stage><stage stageid="b58dff70-5256-4b01-8e97-ed2efcbcbfcd" name="NumericResult" type="Data"><subsheetid>cbbe7eb7-53d6-49a6-9f88-cb3a26c334df</subsheetid><display x="-225" y="120" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b226d9b3-eff1-427f-8b2e-eb5da2cefb05" name="TextResult" type="Data"><subsheetid>cbbe7eb7-53d6-49a6-9f88-cb3a26c334df</subsheetid><display x="-165" y="120" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="60b9ffe8-dee6-4b41-b324-21aeca4ac438" name="ErrorMessage" type="Data"><subsheetid>cbbe7eb7-53d6-49a6-9f88-cb3a26c334df</subsheetid><loginhibit /><display x="-195" y="210" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="03bbb947-bcd3-4602-802b-f0444d868a92" name="JSON to Collection" type="SubSheet"><subsheetid>cbbe7eb7-53d6-49a6-9f88-cb3a26c334df</subsheetid><loginhibit /><display x="-15" y="75" /><inputs><input type="text" name="json" friendlyname="json" expr="[TextResult]" /></inputs><outputs><output type="collection" name="Result" friendlyname="Result" stage="Result" /></outputs><onsuccess>09dc30b8-a6f6-4594-9044-3e15b51f75ef</onsuccess><processid>e5aeb4cb-cd25-4535-b3be-b46681b4e6b6</processid></stage><stage stageid="66ec6cbe-f703-4076-bcf5-5b0e22e41ba3" name="Result" type="Collection"><subsheetid>cbbe7eb7-53d6-49a6-9f88-cb3a26c334df</subsheetid><display x="-195" y="255" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="87cac279-7118-48cc-b1d7-3658fc032d77" name="Inputs" type="Block"><subsheetid>560472b9-cea4-41d5-bc36-c49d6c1b26e6</subsheetid><loginhibit /><display x="-270" y="-45" w="150" h="60" /><font family="Segoe UI" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="01799449-c645-49c1-8c4f-8986f1b1d742" name="Outputs" type="Block"><subsheetid>560472b9-cea4-41d5-bc36-c49d6c1b26e6</subsheetid><loginhibit /><display x="-270" y="30" w="150" h="60" /><font family="Segoe UI" size="10" style="Regular" color="00FF00" /></stage><stage stageid="a6c9d22a-d9ca-4915-bc8e-d670af070403" name="Inputs" type="Block"><subsheetid>e5aeb4cb-cd25-4535-b3be-b46681b4e6b6</subsheetid><loginhibit /><display x="-270" y="-30" w="150" h="60" /><font family="Segoe UI" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="382cc03e-2ac0-4ec6-adb9-c3cc75a7ca5e" name="Outputs" type="Block"><subsheetid>e5aeb4cb-cd25-4535-b3be-b46681b4e6b6</subsheetid><loginhibit /><display x="-270" y="45" w="150" h="60" /><font family="Segoe UI" size="10" style="Regular" color="00FF00" /></stage><stage stageid="7f989a6d-ca7f-4b8e-a295-13d0e8290cf2" name="Inputs" type="Block"><subsheetid>e53062c7-68de-4763-b37a-456688d0d607</subsheetid><loginhibit /><display x="-270" y="-30" w="150" h="60" /><font family="Segoe UI" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="f366aecb-e6eb-48a8-abe6-7c5815ca65f3" name="Outputs" type="Block"><subsheetid>e53062c7-68de-4763-b37a-456688d0d607</subsheetid><loginhibit /><display x="-270" y="45" w="150" h="60" /><font family="Segoe UI" size="10" style="Regular" color="00FF00" /></stage><stage stageid="8af65c59-f2d4-4d02-a30a-63b08b35cc7f" name="Inputs" type="Block"><subsheetid>1c04dc1d-81e9-47e9-a8c4-b46dd19b2624</subsheetid><loginhibit /><display x="-270" y="-30" w="150" h="105" /><font family="Segoe UI" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="5d7a75fc-0689-4c1b-b7a8-bcb95fc46ffb" name="Outputs" type="Block"><subsheetid>1c04dc1d-81e9-47e9-a8c4-b46dd19b2624</subsheetid><loginhibit /><display x="-270" y="120" w="150" h="120" /><font family="Segoe UI" size="10" style="Regular" color="00FF00" /></stage><stage stageid="52bedb01-d26a-4421-b30a-af904dfd5f10" name="Inputs" type="Block"><subsheetid>cbbe7eb7-53d6-49a6-9f88-cb3a26c334df</subsheetid><loginhibit /><display x="-270" y="-30" w="150" h="105" /><font family="Segoe UI" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="5e1ed7e6-95cc-4409-9c77-3b4c79d24ac6" name="Outputs" type="Block"><subsheetid>cbbe7eb7-53d6-49a6-9f88-cb3a26c334df</subsheetid><loginhibit /><display x="-270" y="165" w="150" h="120" /><font family="Segoe UI" size="10" style="Regular" color="00FF00" /></stage><stage stageid="921b8f62-3650-4490-a8f4-c38efa72e580" name="Intermediary Values" type="Block"><subsheetid>cbbe7eb7-53d6-49a6-9f88-cb3a26c334df</subsheetid><loginhibit /><display x="-270" y="90" w="150" h="60" /><font family="Segoe UI" size="10" style="Regular" color="00FFFF" /></stage></process></object>
        <object-group id="961d4e23-fba8-4023-97ca-16729a162907" name="Default" isDefaultGroup="True" xmlns="http://www.blueprism.co.uk/product/object-group">
            <members>
                <object id="c539f5ff-58d5-465a-b5c4-5064856a0d27" />
                <object id="6efb1579-126a-4563-b2e9-3d9e432c1a79" />
                <object id="d39ef435-da5c-4e38-a846-b903b2cf3d8e" />
            </members>
        </object-group>
    </bpr:contents>
</bpr:release>